{
  "hash": "7239207b0987dd231a35482833a2029b",
  "result": {
    "markdown": "---\ntitle: \"Some Data Aanalysis and Maps with R\"\nformat: html \neditor: visual\nimage: map.png\nexecute: \n  freeze: true\n---\n\n\nWhat follows is a data analysis that I made for one of my master's courses on applied methods with R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrm(list = ls())\nlibrary(tidyverse)\nlibrary(knitr)\nlibrary(ggmosaic)\nlibrary(knitr)\nsetwd(\"F:/myblog/posts/Some data analysis and how to do a map with r\")\ndata_qog <- read_csv(\"2022-10-31-T412006-assignment2-data.csv\")\n```\n:::\n\n\n\n## Description of some variables of the dataset\n| Variable name \t| Short description \t| Information \t|\n|---\t|---\t|---\t|\n| ccode \t| Country code \t| Country code with the ISO-3166-1 standard \t|\n| cname \t| Country name \t| Country name  \t|\n| year \t| Year \t|  \t|\n| ht_region \t| Region of the Country \t| Tenfold politico-geographic classification of world region from 1 to 10 \t|\n| wdi_area \t| Land area (sq.km) \t| Country's total area excluding area under inland water bodies, exclusive economic zones and claims to continental shelf \t|\n| wdi_pop \t| Total population  \t| All residents regardless of legal status or citizenship (midyear estimates) \t|\n| wdi_popden \t| Population density \t| People per sq. km of land area. Midyear population divided by land area in square kilometers \t|\n| br_dem \t| Is the country a democracy \t| Dummy variable indicator of democracy based on minimalist definition (if there is free and fair election, peaceful turnover of officers) \t|\n| br_elect \t| Typology of political institutions \t| Alternative democracy indicator capturing degree of multi-party competition. \t|\n| chga_hinst \t| Regime Institutions \t| Six-fold classification of political regimes \t|\n| ht_regtype \t| Regime Type \t| Qualitative variable representing the political regime of each country based on 26 levels \t|\n| p_polity2 \t| Revised Combined Polity Score \t| Ordinal variable: range from -10 (strongly autocratic) to +10 (strongly democratic) \t|\n| wdi_gnicon2010 \t| GNI (constant 2010 US dollar) \t| Gross national income: sum of value added by all resident producers plus any product taxes less subsidies \t|\n| wdi_gnicapcon2010 \t| GNI per capital (constant 2010 US dollar) \t| GNI divided by midyear population \t|\n| wdi_gdpcapcon2010 \t| GDP per capita (constant 2010 US dollar) \t| Gross domestic product divided by midyear population. GDP is the sum of gross value added by residents producers plus product taxes minus subsidies \t|\n| wdi_lifexp \t| Life expectancy at birth, total (years) \t| Number of years a newborn infant would live if prevailing patterns of mortality at the time of its birth were to stay the same throughout its life \t|\n| wdi_litrad \t| Literacy rate, adult total (% of people ages 15 and above) \t| Percentage of the population above 15 who can understand, read and write a short simple statement \t|\n| undp_hdi \t| Human Development Index \t| Summary measure of average achievement in health, knowledge and decent standards of living \t|\n| wdi_expmil \t| Military expenditure (% of GDP) \t| All current and capital expenditures on the armed forces  \t|\n| wdi_internet \t| Individuals using the Internet (% of population) \t| Internet users who have used Internet in the last 3 months \t|\n\n\n\n\n# Data transformations\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntypeof(data_qog$ht_region)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"double\"\n```\n:::\n\n```{.r .cell-code}\nis.numeric(data_qog$ht_region)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n:::\n\nVariable ht_region is stored as a numerical variable. This does not make sense, because the variable is a geographical classification of world region from 1 to 10 each number representing a region, it should hence be stored as a nominal/factor variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_qog$ht_region <-  factor(data_qog$ht_region, levels = c(1:10))\nunique(data_qog$ht_region)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 8    1    <NA> 3    5    4    10   2    9    7    6   \nLevels: 1 2 3 4 5 6 7 8 9 10\n```\n:::\n\n```{.r .cell-code}\nhead(data_qog)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 20\n  ccode cname        year ht_region wdi_area wdi_pop wdi_popden br_dem br_elect\n  <dbl> <chr>       <dbl> <fct>        <dbl>   <dbl>      <dbl>  <dbl>    <dbl>\n1     4 Afghanistan  1960 8               NA 8996967       NA        0        2\n2     4 Afghanistan  1961 8           652860 9169406       14.0      0        2\n3     4 Afghanistan  1962 8           652860 9351442       14.3      0        2\n4     4 Afghanistan  1963 8           652860 9543200       14.6      0        2\n5     4 Afghanistan  1964 8           652860 9744772       14.9      0        2\n6     4 Afghanistan  1965 8           652860 9956318       15.3      0        2\n# ℹ 11 more variables: chga_hinst <dbl>, ht_regtype <dbl>, p_polity2 <dbl>,\n#   wdi_gnicon2010 <dbl>, wdi_gnicapcon2010 <dbl>, wdi_gdpcapcon2010 <dbl>,\n#   wdi_lifexp <dbl>, wdi_litrad <dbl>, undp_hdi <dbl>, wdi_expmil <dbl>,\n#   wdi_internet <dbl>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_cntr_reg <- data_qog %>% \n  filter(year == 2015) %>% \n  select(cname, ht_region)\nhead(data_cntr_reg)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 2\n  cname               ht_region\n  <chr>               <fct>    \n1 Afghanistan         8        \n2 Albania             1        \n3 Algeria             3        \n4 Andorra             5        \n5 Angola              4        \n6 Antigua and Barbuda 10       \n```\n:::\n:::\n\n\n\n## Recoding the regions\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_cntr_reg %>% \n  mutate(\n    my_region = ifelse(ht_region %in% c(2, 10), \"Americas\",\n                        ifelse(cname %in% c(\"Canada\", \"United States of America (the)\"), \"Americas\",\n                          ifelse(ht_region %in% c(6, 7, 8) | cname %in% c(\"Tajikistan\", \"Turkmenistan\", \"Uzbekistan\", \"Kazakhstan\", \"Kyrgyzstan\"), \"Asia\",\n                              ifelse(ht_region %in% c(1, 5), \"Europe\",\n                                     ifelse(ht_region == 3 | cname %in% c(\"Turkey\", \"Israel\", \"Cyprus\"), \"North Africa & Middle East (including Israel, Turkey & Cyprus)\",\n                                            ifelse(ht_region == 4, \"Sub-Saharan Africa\",\n                                                   ifelse(ht_region == 9 | cname %in% c(\"Australia\", \"New-Zealand\"), \"The Pacific (including Australia & New-Zealand\", 0)))))))\n  ) -> data_cntr_reg\n\ndata_cntr_reg %>% \n  arrange(ht_region, cname) %>% \n  kable(caption = \"Countries and their region\")\n```\n\n::: {.cell-output-display}\nTable: Countries and their region\n\n|cname                                                      |ht_region |my_region                                                      |\n|:----------------------------------------------------------|:---------|:--------------------------------------------------------------|\n|Albania                                                    |1         |Europe                                                         |\n|Armenia                                                    |1         |Europe                                                         |\n|Azerbaijan                                                 |1         |Europe                                                         |\n|Belarus                                                    |1         |Europe                                                         |\n|Bosnia and Herzegovina                                     |1         |Europe                                                         |\n|Bulgaria                                                   |1         |Europe                                                         |\n|Croatia                                                    |1         |Europe                                                         |\n|Czechia                                                    |1         |Europe                                                         |\n|Czechoslovakia                                             |1         |Europe                                                         |\n|Estonia                                                    |1         |Europe                                                         |\n|Georgia                                                    |1         |Europe                                                         |\n|Hungary                                                    |1         |Europe                                                         |\n|Kazakhstan                                                 |1         |Asia                                                           |\n|Kyrgyzstan                                                 |1         |Asia                                                           |\n|Latvia                                                     |1         |Europe                                                         |\n|Lithuania                                                  |1         |Europe                                                         |\n|Moldova (the Republic of)                                  |1         |Europe                                                         |\n|Montenegro                                                 |1         |Europe                                                         |\n|North Macedonia                                            |1         |Europe                                                         |\n|Poland                                                     |1         |Europe                                                         |\n|Romania                                                    |1         |Europe                                                         |\n|Russian Federation (the)                                   |1         |Europe                                                         |\n|Serbia                                                     |1         |Europe                                                         |\n|Serbia and Montenegro                                      |1         |Europe                                                         |\n|Slovakia                                                   |1         |Europe                                                         |\n|Slovenia                                                   |1         |Europe                                                         |\n|Tajikistan                                                 |1         |Asia                                                           |\n|Turkmenistan                                               |1         |Asia                                                           |\n|USSR                                                       |1         |Europe                                                         |\n|Ukraine                                                    |1         |Europe                                                         |\n|Uzbekistan                                                 |1         |Asia                                                           |\n|Argentina                                                  |2         |Americas                                                       |\n|Bolivia (Plurinational State of)                           |2         |Americas                                                       |\n|Brazil                                                     |2         |Americas                                                       |\n|Chile                                                      |2         |Americas                                                       |\n|Colombia                                                   |2         |Americas                                                       |\n|Costa Rica                                                 |2         |Americas                                                       |\n|Cuba                                                       |2         |Americas                                                       |\n|Dominican Republic (the)                                   |2         |Americas                                                       |\n|Ecuador                                                    |2         |Americas                                                       |\n|El Salvador                                                |2         |Americas                                                       |\n|Guatemala                                                  |2         |Americas                                                       |\n|Haiti                                                      |2         |Americas                                                       |\n|Honduras                                                   |2         |Americas                                                       |\n|Mexico                                                     |2         |Americas                                                       |\n|Nicaragua                                                  |2         |Americas                                                       |\n|Panama                                                     |2         |Americas                                                       |\n|Paraguay                                                   |2         |Americas                                                       |\n|Peru                                                       |2         |Americas                                                       |\n|Uruguay                                                    |2         |Americas                                                       |\n|Venezuela (Bolivarian Republic of)                         |2         |Americas                                                       |\n|Algeria                                                    |3         |North Africa & Middle East (including Israel, Turkey & Cyprus) |\n|Bahrain                                                    |3         |North Africa & Middle East (including Israel, Turkey & Cyprus) |\n|Cyprus                                                     |3         |North Africa & Middle East (including Israel, Turkey & Cyprus) |\n|Egypt                                                      |3         |North Africa & Middle East (including Israel, Turkey & Cyprus) |\n|Iran (Islamic Republic of)                                 |3         |North Africa & Middle East (including Israel, Turkey & Cyprus) |\n|Iraq                                                       |3         |North Africa & Middle East (including Israel, Turkey & Cyprus) |\n|Israel                                                     |3         |North Africa & Middle East (including Israel, Turkey & Cyprus) |\n|Jordan                                                     |3         |North Africa & Middle East (including Israel, Turkey & Cyprus) |\n|Kuwait                                                     |3         |North Africa & Middle East (including Israel, Turkey & Cyprus) |\n|Lebanon                                                    |3         |North Africa & Middle East (including Israel, Turkey & Cyprus) |\n|Libya                                                      |3         |North Africa & Middle East (including Israel, Turkey & Cyprus) |\n|Morocco                                                    |3         |North Africa & Middle East (including Israel, Turkey & Cyprus) |\n|Oman                                                       |3         |North Africa & Middle East (including Israel, Turkey & Cyprus) |\n|Qatar                                                      |3         |North Africa & Middle East (including Israel, Turkey & Cyprus) |\n|Saudi Arabia                                               |3         |North Africa & Middle East (including Israel, Turkey & Cyprus) |\n|Syrian Arab Republic (the)                                 |3         |North Africa & Middle East (including Israel, Turkey & Cyprus) |\n|Tunisia                                                    |3         |North Africa & Middle East (including Israel, Turkey & Cyprus) |\n|Turkey                                                     |3         |North Africa & Middle East (including Israel, Turkey & Cyprus) |\n|United Arab Emirates (the)                                 |3         |North Africa & Middle East (including Israel, Turkey & Cyprus) |\n|Yemen                                                      |3         |North Africa & Middle East (including Israel, Turkey & Cyprus) |\n|Angola                                                     |4         |Sub-Saharan Africa                                             |\n|Benin                                                      |4         |Sub-Saharan Africa                                             |\n|Botswana                                                   |4         |Sub-Saharan Africa                                             |\n|Burkina Faso                                               |4         |Sub-Saharan Africa                                             |\n|Burundi                                                    |4         |Sub-Saharan Africa                                             |\n|Cabo Verde                                                 |4         |Sub-Saharan Africa                                             |\n|Cameroon                                                   |4         |Sub-Saharan Africa                                             |\n|Central African Republic (the)                             |4         |Sub-Saharan Africa                                             |\n|Chad                                                       |4         |Sub-Saharan Africa                                             |\n|Comoros (the)                                              |4         |Sub-Saharan Africa                                             |\n|Congo (the Democratic Republic of the)                     |4         |Sub-Saharan Africa                                             |\n|Congo (the)                                                |4         |Sub-Saharan Africa                                             |\n|Côte d'Ivoire                                              |4         |Sub-Saharan Africa                                             |\n|Djibouti                                                   |4         |Sub-Saharan Africa                                             |\n|Equatorial Guinea                                          |4         |Sub-Saharan Africa                                             |\n|Eritrea                                                    |4         |Sub-Saharan Africa                                             |\n|Eswatini                                                   |4         |Sub-Saharan Africa                                             |\n|Ethiopia                                                   |4         |Sub-Saharan Africa                                             |\n|Gabon                                                      |4         |Sub-Saharan Africa                                             |\n|Gambia (the)                                               |4         |Sub-Saharan Africa                                             |\n|Ghana                                                      |4         |Sub-Saharan Africa                                             |\n|Guinea                                                     |4         |Sub-Saharan Africa                                             |\n|Guinea-Bissau                                              |4         |Sub-Saharan Africa                                             |\n|Kenya                                                      |4         |Sub-Saharan Africa                                             |\n|Lesotho                                                    |4         |Sub-Saharan Africa                                             |\n|Liberia                                                    |4         |Sub-Saharan Africa                                             |\n|Madagascar                                                 |4         |Sub-Saharan Africa                                             |\n|Malawi                                                     |4         |Sub-Saharan Africa                                             |\n|Mali                                                       |4         |Sub-Saharan Africa                                             |\n|Mauritania                                                 |4         |Sub-Saharan Africa                                             |\n|Mauritius                                                  |4         |Sub-Saharan Africa                                             |\n|Mozambique                                                 |4         |Sub-Saharan Africa                                             |\n|Namibia                                                    |4         |Sub-Saharan Africa                                             |\n|Niger (the)                                                |4         |Sub-Saharan Africa                                             |\n|Nigeria                                                    |4         |Sub-Saharan Africa                                             |\n|Rwanda                                                     |4         |Sub-Saharan Africa                                             |\n|Sao Tome and Principe                                      |4         |Sub-Saharan Africa                                             |\n|Senegal                                                    |4         |Sub-Saharan Africa                                             |\n|Seychelles                                                 |4         |Sub-Saharan Africa                                             |\n|Sierra Leone                                               |4         |Sub-Saharan Africa                                             |\n|Somalia                                                    |4         |Sub-Saharan Africa                                             |\n|South Africa                                               |4         |Sub-Saharan Africa                                             |\n|South Sudan                                                |4         |Sub-Saharan Africa                                             |\n|Sudan (the)                                                |4         |Sub-Saharan Africa                                             |\n|Tanzania, the United Republic of                           |4         |Sub-Saharan Africa                                             |\n|Togo                                                       |4         |Sub-Saharan Africa                                             |\n|Uganda                                                     |4         |Sub-Saharan Africa                                             |\n|Zambia                                                     |4         |Sub-Saharan Africa                                             |\n|Zimbabwe                                                   |4         |Sub-Saharan Africa                                             |\n|Andorra                                                    |5         |Europe                                                         |\n|Australia                                                  |5         |Europe                                                         |\n|Austria                                                    |5         |Europe                                                         |\n|Belgium                                                    |5         |Europe                                                         |\n|Canada                                                     |5         |Americas                                                       |\n|Denmark                                                    |5         |Europe                                                         |\n|Finland                                                    |5         |Europe                                                         |\n|France                                                     |5         |Europe                                                         |\n|Germany                                                    |5         |Europe                                                         |\n|Greece                                                     |5         |Europe                                                         |\n|Iceland                                                    |5         |Europe                                                         |\n|Ireland                                                    |5         |Europe                                                         |\n|Italy                                                      |5         |Europe                                                         |\n|Liechtenstein                                              |5         |Europe                                                         |\n|Luxembourg                                                 |5         |Europe                                                         |\n|Malta                                                      |5         |Europe                                                         |\n|Monaco                                                     |5         |Europe                                                         |\n|Netherlands (the)                                          |5         |Europe                                                         |\n|New Zealand                                                |5         |Europe                                                         |\n|Norway                                                     |5         |Europe                                                         |\n|Portugal                                                   |5         |Europe                                                         |\n|San Marino                                                 |5         |Europe                                                         |\n|Spain                                                      |5         |Europe                                                         |\n|Sweden                                                     |5         |Europe                                                         |\n|Switzerland                                                |5         |Europe                                                         |\n|United Kingdom of Great Britain and Northern Ireland (the) |5         |Europe                                                         |\n|United States of America (the)                             |5         |Americas                                                       |\n|China                                                      |6         |Asia                                                           |\n|Japan                                                      |6         |Asia                                                           |\n|Korea (the Democratic People's Republic of)                |6         |Asia                                                           |\n|Korea (the Republic of)                                    |6         |Asia                                                           |\n|Mongolia                                                   |6         |Asia                                                           |\n|Taiwan (Province of China)                                 |6         |Asia                                                           |\n|Brunei Darussalam                                          |7         |Asia                                                           |\n|Cambodia                                                   |7         |Asia                                                           |\n|Indonesia                                                  |7         |Asia                                                           |\n|Lao People's Democratic Republic (the)                     |7         |Asia                                                           |\n|Malaysia                                                   |7         |Asia                                                           |\n|Myanmar                                                    |7         |Asia                                                           |\n|Philippines (the)                                          |7         |Asia                                                           |\n|Singapore                                                  |7         |Asia                                                           |\n|Thailand                                                   |7         |Asia                                                           |\n|Timor-Leste                                                |7         |Asia                                                           |\n|Viet Nam                                                   |7         |Asia                                                           |\n|Afghanistan                                                |8         |Asia                                                           |\n|Bangladesh                                                 |8         |Asia                                                           |\n|Bhutan                                                     |8         |Asia                                                           |\n|India                                                      |8         |Asia                                                           |\n|Maldives                                                   |8         |Asia                                                           |\n|Nepal                                                      |8         |Asia                                                           |\n|Pakistan                                                   |8         |Asia                                                           |\n|Sri Lanka                                                  |8         |Asia                                                           |\n|Tibet                                                      |8         |Asia                                                           |\n|Fiji                                                       |9         |The Pacific (including Australia & New-Zealand                 |\n|Kiribati                                                   |9         |The Pacific (including Australia & New-Zealand                 |\n|Marshall Islands                                           |9         |The Pacific (including Australia & New-Zealand                 |\n|Micronesia (Federated States of)                           |9         |The Pacific (including Australia & New-Zealand                 |\n|Nauru                                                      |9         |The Pacific (including Australia & New-Zealand                 |\n|Palau                                                      |9         |The Pacific (including Australia & New-Zealand                 |\n|Papua New Guinea                                           |9         |The Pacific (including Australia & New-Zealand                 |\n|Samoa                                                      |9         |The Pacific (including Australia & New-Zealand                 |\n|Solomon Islands                                            |9         |The Pacific (including Australia & New-Zealand                 |\n|Tonga                                                      |9         |The Pacific (including Australia & New-Zealand                 |\n|Tuvalu                                                     |9         |The Pacific (including Australia & New-Zealand                 |\n|Vanuatu                                                    |9         |The Pacific (including Australia & New-Zealand                 |\n|Antigua and Barbuda                                        |10        |Americas                                                       |\n|Bahamas (the)                                              |10        |Americas                                                       |\n|Barbados                                                   |10        |Americas                                                       |\n|Belize                                                     |10        |Americas                                                       |\n|Dominica                                                   |10        |Americas                                                       |\n|Grenada                                                    |10        |Americas                                                       |\n|Guyana                                                     |10        |Americas                                                       |\n|Jamaica                                                    |10        |Americas                                                       |\n|Saint Kitts and Nevis                                      |10        |Americas                                                       |\n|Saint Lucia                                                |10        |Americas                                                       |\n|Saint Vincent and the Grenadines                           |10        |Americas                                                       |\n|Suriname                                                   |10        |Americas                                                       |\n|Trinidad and Tobago                                        |10        |Americas                                                       |\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_qog <- data_qog %>% \n  mutate(\n    my_region = ifelse(ht_region %in% c(2, 10), \"Americas\",\n                        ifelse(cname %in% c(\"Canada\", \"United States of America (the)\"), \"Americas\",\n                            ifelse(ht_region %in% c(6, 7, 8) | cname %in% c(\"Tajikistan\", \"Turkmenistan\", \"Uzbekistan\", \"Kazakhstan\", \"Kyrgyzstan\"), \"Asia\",\n                              ifelse(ht_region %in% c(1, 5), \"Europe\",\n                                     ifelse(ht_region == 3 | cname %in% c(\"Turkey\", \"Israel\", \"Cyprus\"), \"North Africa & Middle East (including Israel, Turkey & Cyprus)\",\n                                            ifelse(ht_region == 4, \"Sub-Saharan Africa\",\n                                                   ifelse(ht_region == 9 | cname %in% c(\"Australia\", \"New-Zealand\"), \"The Pacific (including Australia & New-Zealand\", 0)))))))\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_gnicapcon2010 <- data_qog %>% \n  select(cname, wdi_pop, wdi_gnicon2010, wdi_gnicapcon2010) %>% \n  mutate(my_gnicapcon = wdi_gnicon2010/wdi_pop)\nhead(my_gnicapcon2010)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n  cname       wdi_pop wdi_gnicon2010 wdi_gnicapcon2010 my_gnicapcon\n  <chr>         <dbl>          <dbl>             <dbl>        <dbl>\n1 Afghanistan 8996967             NA                NA           NA\n2 Afghanistan 9169406             NA                NA           NA\n3 Afghanistan 9351442             NA                NA           NA\n4 Afghanistan 9543200             NA                NA           NA\n5 Afghanistan 9744772             NA                NA           NA\n6 Afghanistan 9956318             NA                NA           NA\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_gnipc <- my_gnicapcon2010 %>% \n    mutate(check = ifelse(my_gnicapcon == wdi_gnicapcon2010, 0, 1))\nhead(data_gnipc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 6\n  cname       wdi_pop wdi_gnicon2010 wdi_gnicapcon2010 my_gnicapcon check\n  <chr>         <dbl>          <dbl>             <dbl>        <dbl> <dbl>\n1 Afghanistan 8996967             NA                NA           NA    NA\n2 Afghanistan 9169406             NA                NA           NA    NA\n3 Afghanistan 9351442             NA                NA           NA    NA\n4 Afghanistan 9543200             NA                NA           NA    NA\n5 Afghanistan 9744772             NA                NA           NA    NA\n6 Afghanistan 9956318             NA                NA           NA    NA\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_gnipc %>% \n  count(check) %>% \n  mutate(percentage = n/sum(n)) %>% \n  kable(caption = \"check = 0: observations with same values\")\n```\n\n::: {.cell-output-display}\nTable: check = 0: observations with same values\n\n| check|    n| percentage|\n|-----:|----:|----------:|\n|     0|  219|  0.0180158|\n|     1| 5117|  0.4209444|\n|    NA| 6820|  0.5610398|\n:::\n:::\n\n\n\nIt does not look like, when check is equal to one, that the values are different. The reason is perhaps because of how the values are rounded: observations with check = 0 have the same rounding and observations with check = 1 are rounded differently.\n\nLet's adjust the check by rounding all observations to the third decimal:\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_gnipc <- data_gnipc %>% \n  mutate(check2 = ifelse(round(my_gnicapcon, digits = 3) == round(wdi_gnicapcon2010, digits = 3), 0, 1))\n```\n:::\n\n\nI now check doing a table:\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_gnipc %>% \n  count(check2) %>% \n  kable(caption = \"check2 = 0: observations with same values\")\n```\n\n::: {.cell-output-display}\nTable: check2 = 0: observations with same values\n\n| check2|    n|\n|------:|----:|\n|      0| 5155|\n|      1|  181|\n|     NA| 6820|\n:::\n:::\n\n\n\n\n# Describing variation\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_qog %>% \n  summarize(mean = mean(wdi_internet, na.rm = TRUE),\n            median = median(wdi_internet, na.rm = TRUE),\n            max = max(wdi_internet, na.rm = TRUE),\n            min = min(wdi_internet, na.rm = TRUE),\n            sd = sd(wdi_internet, na.rm = TRUE),\n            IQR = IQR(wdi_internet, na.rm = TRUE)) %>% \n  kable(caption = \"descriptive statistics for wdi_internet\")\n```\n\n::: {.cell-output-display}\nTable: descriptive statistics for wdi_internet\n\n|     mean|   median| max| min|       sd|      IQR|\n|--------:|--------:|---:|---:|--------:|--------:|\n| 21.75882| 5.793264| 100|   0| 28.65702| 37.86554|\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# the plot for wdi_internet NAs \ndata_qog %>% \n  group_by(year) %>% \n  count(Na = (is.na(wdi_internet))) %>% \n  mutate(Percentage_NA = n/sum(n)) %>% \n  ungroup() %>% \n  filter(Na == TRUE) %>% \n  ggplot(aes(x = year, y = Percentage_NA))+\n  geom_line()+\n  geom_area(fill = \"red\", alpha = 0.5)+\n  theme_minimal()+\n  labs(title = \"Percentage of NAs of WDI_internet by years\")\n```\n\n::: {.cell-output-display}\n![](Some-data-analysis-and-maps-with-R_files/figure-html/question 17-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Best coverage for the wdi_internet variable\ndata_qog %>% \n  group_by(year) %>% \n  count(Na = (is.na(wdi_internet))) %>% \n  mutate(Percentage_NA = n/sum(n)) %>% \n  ungroup() -> na_analysis_internet\n\nna_analysis_internet %>% \n  filter(Na == TRUE) %>% \n  summarize(best_coverage = min(Percentage_NA),\n            best_coverage_year = year[which(Percentage_NA == min(Percentage_NA))]) %>% \n  kable()\n```\n\n::: {.cell-output-display}\n| best_coverage| best_coverage_year|\n|-------------:|------------------:|\n|      0.040404|               2007|\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndata_qog %>% \n  filter(year == 2007) %>% \n  ggplot()+\n  aes(y = wdi_internet)+\n  geom_boxplot(fill = \"lightblue\", alpha = 0.9)+\n  theme_minimal()+\n  labs(title = \"Boxplot of individuals using the Internet (% of population) - wdi_internet\")\n```\n\n::: {.cell-output-display}\n![](Some-data-analysis-and-maps-with-R_files/figure-html/question 18-1.png){fig-align='center' width=672}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndata_qog %>% \n  filter(year == 2007) %>% \n  ggplot()+\n  aes(y = my_region, x = wdi_internet)+\n  geom_boxplot(fill = \"lightblue\", alpha = 0.9)+\n  theme_minimal()+\n  theme(axis.text.x = element_text(size = 12))+\n  labs(title = \"Boxplots of Individuals using the Internet (% of population) by regions in 2007\")+\n  xlab(\"wdi internet\")+\n  ylab(\"\")\n```\n\n::: {.cell-output-display}\n![](Some-data-analysis-and-maps-with-R_files/figure-html/question 18.1-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n## Analysis of variable life expectancy across countries and time (wdi_lifexp)\nWe want: mean, median, range, variance, sd, IQR and percentage of NA for all dataset\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_qog %>% \n  summarize(\n    mean_life_exp = mean(wdi_lifexp, na.rm = TRUE),\n    median_life_exp = median(wdi_lifexp, na.rm = TRUE),\n    variance_life_exp = sd(wdi_lifexp, na.rm = TRUE)^2,\n    standard_deviation_life_exp = sd(wdi_lifexp, na.rm = TRUE),\n    IQR_life_exp = IQR(wdi_lifexp, na.rm = TRUE),\n    min_life_exp = min(wdi_lifexp, na.rm = TRUE),\n    max_life_exp = max(wdi_lifexp, na.rm = TRUE)\n  ) %>% \n  kable(caption = \"Descriptive statistics of wdi_lifexp\")\n```\n\n::: {.cell-output-display}\nTable: Descriptive statistics of wdi_lifexp\n\n| mean_life_exp| median_life_exp| variance_life_exp| standard_deviation_life_exp| IQR_life_exp| min_life_exp| max_life_exp|\n|-------------:|---------------:|-----------------:|---------------------------:|------------:|------------:|------------:|\n|      64.31728|         67.4765|          130.9105|                    11.44161|     17.30323|       18.907|     85.41707|\n:::\n:::\n\n\n### Percentage of NAs\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_qog %>% \n  select(wdi_lifexp) %>% \n  count(is.na(wdi_lifexp)) %>% \n  mutate(percentage_NAs = n/sum(n)) %>% \n  kable(caption = \"NAs of wdi_lifexp\")\n```\n\n::: {.cell-output-display}\nTable: NAs of wdi_lifexp\n\n|is.na(wdi_lifexp) |    n| percentage_NAs|\n|:-----------------|----:|--------------:|\n|FALSE             | 9460|      0.7782165|\n|TRUE              | 2696|      0.2217835|\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_qog %>% \n  group_by(year) %>% \n  summarize(average_wdi_lifexp = mean(wdi_lifexp, na.rm = TRUE)) %>% \n  ungroup() -> Q20_tibble\nhead(Q20_tibble)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 2\n   year average_wdi_lifexp\n  <dbl>              <dbl>\n1  1960               55.4\n2  1961               53.7\n3  1962               54.1\n4  1963               54.3\n5  1964               54.6\n6  1965               54.8\n```\n:::\n:::\n\n\n### Plotting average wdi_lifexp with year\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndata_qog %>% \n  group_by(year) %>% \n  summarize(average_wdi_lifexp = mean(wdi_lifexp, na.rm = TRUE)) %>% \n  ungroup() %>% \n  ggplot()+\n  aes(x = year, y = average_wdi_lifexp)+\n  geom_point()+\n  geom_line()+\n  theme_minimal()+\n  labs(title = \"Average life expectancy at birth\",\n       caption = \"Average number of years a newborn infant would live if prevailing patterns of mortality at the time of its birth were to stay the same throughout its life\")\n```\n\n::: {.cell-output-display}\n![](Some-data-analysis-and-maps-with-R_files/figure-html/question 20.2-1.png){fig-align='center' width=672}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndata_qog %>% \n  group_by(my_region, year) %>% \n  summarize(average_lifexp = mean(wdi_lifexp, na.rm = TRUE)) %>% \n  ungroup() -> Q21_tibble\n\n\ndata_qog %>% \n  group_by(my_region, year) %>% \n  summarize(average_lifexp = mean(wdi_lifexp, na.rm = TRUE)) %>% \n  ungroup() %>% \n  ggplot()+\n  aes(x = year, y = average_lifexp, color = my_region, shape = my_region)+\n  geom_line()+\n  geom_point(size = 1)+\n  theme_minimal()+\n  theme(legend.position = \"bottom\")+\n  labs(title = \"Average life expectancy at birth\",\n       caption = \"Average number of years a newborn infant would live if prevailing patterns of mortality at the time of its birth were to stay the same throughout its life\")\n```\n\n::: {.cell-output-display}\n![](Some-data-analysis-and-maps-with-R_files/figure-html/question 21-1.png){fig-align='center' width=960}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndata_qog %>% \n  ggplot()+\n  aes(x = wdi_gdpcapcon2010, y = wdi_lifexp)+\n  geom_point(alpha = 0.5)+\n  theme_minimal()+\n  labs(title = \"Life expectancy and GDP per capita across countries and time\")+\n  xlab(\"GDP per capita\")+\n  ylab(\"Life expectancy\")\n```\n\n::: {.cell-output-display}\n![](Some-data-analysis-and-maps-with-R_files/figure-html/question 22-1.png){fig-align='center' width=672}\n:::\n:::\n\nThere seems to be a positive correlation between GDP per cap and life expectancy.\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndata_qog %>% \n  ggplot()+\n  aes(x = wdi_gdpcapcon2010, y = wdi_lifexp, color = my_region)+\n  geom_point(alpha = 1)+\n  theme_minimal()+\n  theme(legend.position = \"bottom\")+\n  scale_color_brewer(palette = \"Set1\")+\n  labs(title = \"Life expectancy and GDP per capital across countries and time\")+\n   xlab(\"GDP per capita\")+\n  ylab(\"Life expectancy\")\n```\n\n::: {.cell-output-display}\n![](Some-data-analysis-and-maps-with-R_files/figure-html/question 23.1-1.png){fig-align='center' width=1152}\n:::\n:::\n\n- Region with low GDP per cap and low life expectancy tends to be Sub-Saharan Africa\n- Regions with high GDP per cap and high life expectancy tend to be Europe and America\n- Regions for which life expectancy tend to be relatively lower than their GDP per cap is North Africa & Middle East and some countries of Sub-Saharan Africa\n\nNorth Africa and Middle East is an interesting case whose observations stand out in the graph above. Around 50000 gdp per cap, life expectancy seems to even decrease with gdp per cap. Thus, I am going to include several variable to see any pattern.\n\n\nI reproduce the graph by adding two variables: br_dem and wdi_expmil, my guess is that countries which are democratic and with few military expenditures are expected to have high GDP PC and high life expectancy (for example because less money in invested in the military and more in health care) and conversely. I expect the countries which had a declining trend in the previous graph to have relatively high military expenditure. I also add lines aesthetics to distinguish countries within the regions.\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndata_qog %>%  \n  ggplot()+\n  aes(x = wdi_gdpcapcon2010, y = wdi_lifexp, color = my_region, shape = factor(br_dem), size = wdi_expmil)+\n  geom_line(aes(x = wdi_gdpcapcon2010, y = wdi_lifexp, fill = cname, color = my_region), inherit.aes = FALSE)+\n  geom_point(alpha = 0.9)+\n  theme_minimal()+\n  theme(legend.position = \"bottom\")+\n  scale_color_brewer(palette = \"Set1\")+\n  scale_size_continuous(name = \"Military expenditure % of GDP\",\n                        range = c(0, 15))+\n  scale_shape_discrete(name = \"Is country democratic\")+\n  labs(title = \"Life expectancy and GDP per capital across countries and time\")+\n  xlab(\"GDP per capita\")+\n  ylab(\"Life expectancy\")\n```\n\n::: {.cell-output-display}\n![](Some-data-analysis-and-maps-with-R_files/figure-html/question 23.2-1.png){fig-align='center' width=1728}\n:::\n:::\n\nI can see now that European countries tend to have relatively low military expenditure, have a posititve correlation between life expectancy and GDP per capita and tend to be democratic. Sub-Saharan Africa countries tend to have increasing life expectancy over the years, but no important GDP per capita growth. For Asia, There is also a positive correlation between life expectancy and gdp per cap, except for one country. The difference with Europe is that some Asian countries are not democratic (circle = non democratic). North Africa and Middle East is the most intriguing case, with a non democratic country with very high military expenditure and high fluctuation of life expectancy and another non democratic country with negative correlation between life expectancy and GDP per cap. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntypeof(data_qog$br_dem)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"double\"\n```\n:::\n\n```{.r .cell-code}\ntypeof(data_qog$p_polity2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"double\"\n```\n:::\n\n```{.r .cell-code}\nrange(data_qog$p_polity2, na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -10  10\n```\n:::\n:::\n\nbr_dem (is the country a democracy) is stored as a double, it is however a dummy variable (nominal variable) taking value 0 is country is not democratic and 1 if country is a democracy. Thus, it does not make sense to compute its mean, I should make a table with the frequencies or relative frequencies or do a barplot.\n\np_polity2 is also stored as a double. It also does not make sense because p_polity2 (revised combined polity score) is an ordinal variable ranging from -10 (strongly autocratic) to +10 (strongly democratic). To give information about this variable, I would do a table and a barplot (sorted according to the range).\n\n\nI first transform those two variables into factors\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_qog$br_dem <- factor(data_qog$br_dem, levels = c(0,1), labels = c(\"Not democratic\", \"democratic\"))\n\ndata_qog$p_polity2 <- factor(data_qog$p_polity2, levels = (-10:10))\n```\n:::\n\n\n\nI then do some univariate and bivariate analysis of the variables through tables and a cross table\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_qog %>%\n  count(p_polity2) %>% \n  kable(caption = \"Is the country democratic\", align = \"c\")\n```\n\n::: {.cell-output-display}\nTable: Is the country democratic\n\n| p_polity2 |  n   |\n|:---------:|:----:|\n|    -10    | 287  |\n|    -9     | 606  |\n|    -8     | 328  |\n|    -7     | 1311 |\n|    -6     | 419  |\n|    -5     | 190  |\n|    -4     | 231  |\n|    -3     | 240  |\n|    -2     | 148  |\n|    -1     | 177  |\n|     0     | 224  |\n|     1     | 114  |\n|     2     |  95  |\n|     3     | 123  |\n|     4     | 252  |\n|     5     | 334  |\n|     6     | 469  |\n|     7     | 386  |\n|     8     | 593  |\n|     9     | 516  |\n|    10     | 1577 |\n|    NA     | 3536 |\n:::\n\n```{.r .cell-code}\ndata_qog %>% \n  count(br_dem) %>%\n  kable(caption = \"Is the country democratic\", align = \"c\")\n```\n\n::: {.cell-output-display}\nTable: Is the country democratic\n\n|     br_dem     |  n   |\n|:--------------:|:----:|\n| Not democratic | 5140 |\n|   democratic   | 4915 |\n|       NA       | 2101 |\n:::\n\n```{.r .cell-code}\nkable(table(data_qog$p_polity2, data_qog$br_dem), caption = \"Revised combined polity score according to democracy or not\")\n```\n\n::: {.cell-output-display}\nTable: Revised combined polity score according to democracy or not\n\n|    | Not democratic| democratic|\n|:---|--------------:|----------:|\n|-10 |            287|          0|\n|-9  |            577|          0|\n|-8  |            311|          0|\n|-7  |           1206|          9|\n|-6  |            406|          5|\n|-5  |            155|         20|\n|-4  |            229|          1|\n|-3  |            209|         26|\n|-2  |            145|          2|\n|-1  |            164|         13|\n|0   |            208|         11|\n|1   |             91|         23|\n|2   |             74|         21|\n|3   |             77|         46|\n|4   |            127|        125|\n|5   |            101|        233|\n|6   |            139|        327|\n|7   |             41|        339|\n|8   |             48|        545|\n|9   |             43|        473|\n|10  |              8|       1569|\n:::\n:::\n\n\nI choose then to do a mosaic plot of p_polity according to br_dem to represent the association of the two variable visually \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndata_qog %>%\n  ggplot()+\n  geom_mosaic(aes(x = product(br_dem, p_polity2), fill = br_dem), na.rm = TRUE)+\n  theme_minimal()+\n  scale_fill_brewer(palette = \"Set1\", name = \"\")+\n  ylab(\"\")+\n  xlab(\"Revised Combined Polity Score: from -10 (strongly authocratic) to 10 (strongly democratic)\")+\n  ggtitle(\"Revised Combined Polity Score and democracy\")\n```\n\n::: {.cell-output-display}\n![](Some-data-analysis-and-maps-with-R_files/figure-html/question 25-1.png){fig-align='center' width=672}\n:::\n:::\n\nI can see that as the Revised Combined Polity Score index on the x axis increases, countries tend to be democratic. The value 4 of Revised Combined Polity Score index seems to be the turning point: before this value, there are more non democratic countries, after the value (4), most of the countries are democratic. However, there still are not democratic countries that have high revised combined polity score, which implies that there is some \"disagreement\" between the two variable and their definition of what a democracy is (at least for some countries).\n\n\n\n\nAnother possiblity is to do a stacked or dodge barplot of p_polity and br_dem\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndata_qog %>% \n  drop_na() %>% \n  ggplot()+\n  aes(x = p_polity2, y = (..count..)/sum(..count..), fill = br_dem)+\n  geom_bar(position = \"dodge\")+\n  scale_fill_brewer(palette = \"Set1\", name = \"\")+\n  ylab(\"\")+\n  xlab(\"Revised Combined Polity Score from -10 (strongly authocratic) to 10 (strongly democratic)\")+\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Some-data-analysis-and-maps-with-R_files/figure-html/question 25.2-1.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\ndata_qog %>% \n  drop_na() %>% \n  ggplot()+\n  aes(x = p_polity2, y = (..count..)/sum(..count..), fill = br_dem)+\n  geom_bar()+\n  scale_fill_brewer(palette = \"Set1\", name = \"\")+\n  ylab(\"\")+\n  xlab(\"Revised Combined Polity Score from -10 (strongly authocratic) to 10 (strongly democratic)\")+\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Some-data-analysis-and-maps-with-R_files/figure-html/question 25.2-2.png){fig-align='center' width=672}\n:::\n:::\n\nMy analysis is here the same as the previous graph.\n\n\n# Chloropleth maps\n\nLet's try to do some maps to visualize some of the dataset variables\n\nI first load the packages required to do maps on r\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rgdal)\nlibrary(countrycode)\nlibrary(gganimate)\nlibrary(lubridate)\nlibrary(sf)\nlibrary(viridis)\nlibrary(rnaturalearth)\nlibrary(rnaturalearthdata)\nlibrary(maps)\nlibrary(maptools)\nlibrary(rgeos)\nlibrary(biscale)\nlibrary(cowplot)\n\nmap <- readOGR(\"F:/myblog/posts/Some data analysis and how to do a map with r/world map\")#Note: the shapefile for the world map was downloaded in the naturalearth website: https://www.naturalearthdata.com/downloads/\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOGR data source with driver: ESRI Shapefile \nSource: \"F:\\myblog\\posts\\Some data analysis and how to do a map with r\\world map\", layer: \"ne_50m_admin_0_countries\"\nwith 242 features\nIt has 168 fields\nInteger64 fields read as strings:  NE_ID \n```\n:::\n:::\n\n\nI then have to \"fortify\" the map data to make it tidyverse compatible\n\n::: {.cell}\n\n```{.r .cell-code}\nmap_fortify <- fortify(map, region = \"SOVEREIGNT\")\nunique(map_fortify$id)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  [1] \"Afghanistan\"                      \"Albania\"                         \n  [3] \"Algeria\"                          \"Andorra\"                         \n  [5] \"Angola\"                           \"Antarctica\"                      \n  [7] \"Antigua and Barbuda\"              \"Argentina\"                       \n  [9] \"Armenia\"                          \"Australia\"                       \n [11] \"Austria\"                          \"Azerbaijan\"                      \n [13] \"Bahrain\"                          \"Bangladesh\"                      \n [15] \"Barbados\"                         \"Belarus\"                         \n [17] \"Belgium\"                          \"Belize\"                          \n [19] \"Benin\"                            \"Bhutan\"                          \n [21] \"Bolivia\"                          \"Bosnia and Herzegovina\"          \n [23] \"Botswana\"                         \"Brazil\"                          \n [25] \"Brunei\"                           \"Bulgaria\"                        \n [27] \"Burkina Faso\"                     \"Burundi\"                         \n [29] \"Cabo Verde\"                       \"Cambodia\"                        \n [31] \"Cameroon\"                         \"Canada\"                          \n [33] \"Central African Republic\"         \"Chad\"                            \n [35] \"Chile\"                            \"China\"                           \n [37] \"Colombia\"                         \"Comoros\"                         \n [39] \"Costa Rica\"                       \"Croatia\"                         \n [41] \"Cuba\"                             \"Cyprus\"                          \n [43] \"Czechia\"                          \"Democratic Republic of the Congo\"\n [45] \"Denmark\"                          \"Djibouti\"                        \n [47] \"Dominica\"                         \"Dominican Republic\"              \n [49] \"East Timor\"                       \"Ecuador\"                         \n [51] \"Egypt\"                            \"El Salvador\"                     \n [53] \"Equatorial Guinea\"                \"Eritrea\"                         \n [55] \"Estonia\"                          \"eSwatini\"                        \n [57] \"Ethiopia\"                         \"Federated States of Micronesia\"  \n [59] \"Fiji\"                             \"Finland\"                         \n [61] \"France\"                           \"Gabon\"                           \n [63] \"Gambia\"                           \"Georgia\"                         \n [65] \"Germany\"                          \"Ghana\"                           \n [67] \"Greece\"                           \"Grenada\"                         \n [69] \"Guatemala\"                        \"Guinea\"                          \n [71] \"Guinea-Bissau\"                    \"Guyana\"                          \n [73] \"Haiti\"                            \"Honduras\"                        \n [75] \"Hungary\"                          \"Iceland\"                         \n [77] \"India\"                            \"Indonesia\"                       \n [79] \"Iran\"                             \"Iraq\"                            \n [81] \"Ireland\"                          \"Israel\"                          \n [83] \"Italy\"                            \"Ivory Coast\"                     \n [85] \"Jamaica\"                          \"Japan\"                           \n [87] \"Jordan\"                           \"Kashmir\"                         \n [89] \"Kazakhstan\"                       \"Kenya\"                           \n [91] \"Kiribati\"                         \"Kosovo\"                          \n [93] \"Kuwait\"                           \"Kyrgyzstan\"                      \n [95] \"Laos\"                             \"Latvia\"                          \n [97] \"Lebanon\"                          \"Lesotho\"                         \n [99] \"Liberia\"                          \"Libya\"                           \n[101] \"Liechtenstein\"                    \"Lithuania\"                       \n[103] \"Luxembourg\"                       \"Madagascar\"                      \n[105] \"Malawi\"                           \"Malaysia\"                        \n[107] \"Maldives\"                         \"Mali\"                            \n[109] \"Malta\"                            \"Marshall Islands\"                \n[111] \"Mauritania\"                       \"Mauritius\"                       \n[113] \"Mexico\"                           \"Moldova\"                         \n[115] \"Monaco\"                           \"Mongolia\"                        \n[117] \"Montenegro\"                       \"Morocco\"                         \n[119] \"Mozambique\"                       \"Myanmar\"                         \n[121] \"Namibia\"                          \"Nauru\"                           \n[123] \"Nepal\"                            \"Netherlands\"                     \n[125] \"New Zealand\"                      \"Nicaragua\"                       \n[127] \"Niger\"                            \"Nigeria\"                         \n[129] \"North Korea\"                      \"North Macedonia\"                 \n[131] \"Northern Cyprus\"                  \"Norway\"                          \n[133] \"Oman\"                             \"Pakistan\"                        \n[135] \"Palau\"                            \"Panama\"                          \n[137] \"Papua New Guinea\"                 \"Paraguay\"                        \n[139] \"Peru\"                             \"Philippines\"                     \n[141] \"Poland\"                           \"Portugal\"                        \n[143] \"Qatar\"                            \"Republic of Serbia\"              \n[145] \"Republic of the Congo\"            \"Romania\"                         \n[147] \"Russia\"                           \"Rwanda\"                          \n[149] \"Saint Kitts and Nevis\"            \"Saint Lucia\"                     \n[151] \"Saint Vincent and the Grenadines\" \"Samoa\"                           \n[153] \"San Marino\"                       \"São Tomé and Principe\"           \n[155] \"Saudi Arabia\"                     \"Senegal\"                         \n[157] \"Seychelles\"                       \"Sierra Leone\"                    \n[159] \"Singapore\"                        \"Slovakia\"                        \n[161] \"Slovenia\"                         \"Solomon Islands\"                 \n[163] \"Somalia\"                          \"Somaliland\"                      \n[165] \"South Africa\"                     \"South Korea\"                     \n[167] \"South Sudan\"                      \"Spain\"                           \n[169] \"Sri Lanka\"                        \"Sudan\"                           \n[171] \"Suriname\"                         \"Sweden\"                          \n[173] \"Switzerland\"                      \"Syria\"                           \n[175] \"Taiwan\"                           \"Tajikistan\"                      \n[177] \"Thailand\"                         \"The Bahamas\"                     \n[179] \"Togo\"                             \"Tonga\"                           \n[181] \"Trinidad and Tobago\"              \"Tunisia\"                         \n[183] \"Turkey\"                           \"Turkmenistan\"                    \n[185] \"Tuvalu\"                           \"Uganda\"                          \n[187] \"Ukraine\"                          \"United Arab Emirates\"            \n[189] \"United Kingdom\"                   \"United Republic of Tanzania\"     \n[191] \"United States of America\"         \"Uruguay\"                         \n[193] \"Uzbekistan\"                       \"Vanuatu\"                         \n[195] \"Vatican\"                          \"Venezuela\"                       \n[197] \"Vietnam\"                          \"Western Sahara\"                  \n[199] \"Yemen\"                            \"Zambia\"                          \n[201] \"Zimbabwe\"                        \n```\n:::\n:::\n\n\nThe biggest problem to plot a map will be the names of all the countries in the two datasets because I have to successfully join the dataset to the map-dataset, I have to recode the name in one dataset. The package countrycode will do most of the work, but some countries still need to be recoded.\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_qog$cname <- countryname(data_qog$cname, destination = \"cldr.short.en\")\ndata_qog$cname[data_qog$cname == \"US\"] <- \"United States of America\"\ndata_qog$cname[data_qog$cname == \"UK\"] <- \"United Kingdom\"\ndata_qog$cname[data_qog$cname == \"Congo - Kinshasa\"] <- \"Democratic Republic of the Congo\"\ndata_qog$cname[data_qog$cname == \"Côte d’Ivoire\"] <- \"Ivory Coast\"\ndata_qog$cname[data_qog$cname ==  \"Tanzania\"] <- \"United Republic of Tanzania\"\n```\n:::\n\n\nI join the datasets by the country names:\n\n::: {.cell}\n\n```{.r .cell-code}\nmap_join <- map_fortify %>%\n  left_join(data_qog, by = c(\"id\" = \"cname\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in left_join(., data_qog, by = c(id = \"cname\")): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 1 of `x` matches multiple rows in `y`.\nℹ Row 1 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n```\n:::\n:::\n\n\nAre military expenditure geographically related to the probability of a country to be autocratic? I will explore with two maps the relation between p_polity and wdi_expmil. I expect countries with high military expenditure to be more autocratic.\n\nI then plot the first map with the variable p_polity2:\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmap_join %>% \n  filter(year == 2015) %>% \n  ggplot()+\n  aes(x = long, y = lat, group = group, fill = factor(p_polity2), color = I(\"black\"))+\n  geom_polygon()+\n  theme_minimal()+\n  scale_fill_ordinal(\n          guide = guide_legend(\n            direction = \"horizontal\",\n            title.position = 'top',\n            title.hjust = 0.5,\n            label.hjust = 1,\n            nrow = 1,\n            byrow = TRUE,\n            reverse = TRUE,\n            label.position = \"bottom\"\n          ),\n          option = \"magma\",\n          name = \"p_polity2 index\"\n      )+\n  theme(legend.position = \"bottom\",\n        axis.text.x = element_blank(),\n        axis.text.y = element_blank()\n        )+\n  labs(title = \"Revised combined polity score across countries (2015)\")+\n  ylab(\"\")+\n  xlab(\"\") -> map_plot\n\nmap_plot\n```\n\n::: {.cell-output-display}\n![](Some-data-analysis-and-maps-with-R_files/figure-html/BT 5-1.png){fig-align='center' width=672}\n:::\n:::\n\nThe more democratic countries in 2015 are concentrated in western Europe, America, East and East/South East Asia (Indonesia, Japan, South Korea), South Pacific and India and Mongolia. The autocratic countries tend to be in Africa, Middle East, some in east Europe and South Asia.\n\n\n\nI now plot the second map military expenditure wdi_expmil:\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmap_join %>% \n  filter(year == 2015) %>% \n  ggplot()+\n  aes(x = long, y = lat, group = group, fill = wdi_expmil, color = I(\"black\"))+\n  geom_polygon()+\n  theme_minimal()+\n  ylab(\"\")+\n  xlab(\"\")+\n  scale_fill_viridis(\n          option = \"magma\",\n          direction = -1,\n          name = \"Military expenditure (% of GDP)\"\n      )+\n  theme(legend.position = \"bottom\",\n        axis.text.x = element_blank(),\n        axis.text.y = element_blank()\n        )+\n  labs(title = \"Military expenditure in 2015\",\n       caption = \"All current and capital expenditures on the armed forces\")\n```\n\n::: {.cell-output-display}\n![](Some-data-analysis-and-maps-with-R_files/figure-html/BT 6-1.png){fig-align='center' width=672}\n:::\n:::\n\nSeeing the latter map on military expenditure, I would conclude that there is no clear inverse correlation between degree of democracy and military expenditure: there are countries which are strongly democratic which have relatively high military expenditure such as the US. A lot of African countries are autocratic, but do not have a really high military expenditure except for Algeria and South Sudan. The only region for which there is a correlation between autocracy and military expenditure seems to be Middle East, with Saudi Arabia being the best illustration.\n\n\n\n\n\n\n\n\n\n\n",
    "supporting": [
      "Some-data-analysis-and-maps-with-R_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}