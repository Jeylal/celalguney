{
  "hash": "d8e1074ef1d8a2beff5eb39593a6a3e3",
  "result": {
    "markdown": "---\ntitle: \"From income brackets to income decile\"\nformat: html\neditor: visual\nimage: graph1.png\nexecute: \n  freeze: true\n---\n\n::: {.cell}\n\n:::\n\n\n## How far can we go with income brackets? (in progress)\n\nTo build their database on [World political cleavages and inequality](https://wpid.world/), Piketty and his team had to use electoral survey data. One problem with these sources is that they collect income data through brackets, without reporting the overall income average of the sample or the average per bracket. This Thus poses the question of how far one can go in terms of statistical analysis with only income brackets as a source of information for income. I will here explore what can be done with such a variable as well as the [technical note](https://wid.world/document/building-the-world-political-cleavages-and-inequality-database-a-new-dataset-on-electoral-behaviors-in-50-democracies-1948-2020-world-inequality-lab-technical-note-2021-01/) that Piketty et al. (2021) provides to explain how they computed the vote share for income and education decile, which they claim is one of their main contributions on political cleavages and inequality.\n\n### From brackets to decile\n\nThe wpid is based on an impressive [dataset](https://wpid.world/resources/en/zip/wpid-micro.zip) compiling electoral survey data of 500 elections since 1948. Since the technical note takes Canada's 2015 election as an example, I will use the latter here.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrm(list = ls())\nca <- read_dta(\"ca.dta\")\nca2015 <- ca %>% \n  filter(year == 2015)\nrm(ca)\n\nsort(unique(ca2015$inc))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1]  1  2  3  4  5  6  7  8 10 11 12 13 14 15 16 17 18 19 20\n```\n:::\n:::\n\n\nNote that there is already something going on here: in the dataset, the variable income has 19 brackets/categories here whereas it has 18 in the technical note. Furthermore, income brackets \"jump\" from 8 to 10. I will ignore these issues and still work with this dataset, we just won't have the same results as in Piketty & al's example.\n\nA first step in analyzing such a variable is to compute the frequency, relative frequency and the cumulative frequencies. More precisely, I will construct two tables. On the one hand, I compute the descriptive statistics for the NDP's voters within each income brackets. On the other hand, I construct a table for the overall distribution of income brackets for the NPD's voters only. Note that I directly add the proportion of NDP's voters from the first table to the second one to simplify further calculations:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nca2015 %>%\n  group_by(inc) %>% \n  count(votendp) %>% \n  drop_na() %>% \n  mutate(\n    cum.n = cumsum(n),\n    prop = n/sum(n)) %>% ungroup() -> table.income.pervote\n\nca2015 %>% filter(votendp == 1) %>% \n  group_by(inc) %>% \n  count(votendp) %>% \n  drop_na() %>% \n  ungroup() %>% \n  mutate(\n    prop_vote = table.income.pervote$prop[table.income.pervote$votendp == 1],\n    cum.n = cumsum(n),\n    prop = n/sum(n),\n    rangeleft = lag(cumsum(prop), default = 0),\n    cumrelfreqN = cumsum(prop),\n    cumrelfreqInc = cumsum(inc/sum(inc))) -> table.income\n\ntable.income.pervote %>% \n  gt(caption = \"Distribution of the vote for the NDP by income group\")\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"syaenwnzic\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#syaenwnzic .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#syaenwnzic .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#syaenwnzic .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#syaenwnzic .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#syaenwnzic .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#syaenwnzic .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#syaenwnzic .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#syaenwnzic .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#syaenwnzic .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#syaenwnzic .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#syaenwnzic .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#syaenwnzic .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#syaenwnzic .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#syaenwnzic .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#syaenwnzic .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#syaenwnzic .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#syaenwnzic .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#syaenwnzic .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#syaenwnzic .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#syaenwnzic .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#syaenwnzic .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#syaenwnzic .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#syaenwnzic .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#syaenwnzic .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#syaenwnzic .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#syaenwnzic .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#syaenwnzic .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#syaenwnzic .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#syaenwnzic .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#syaenwnzic .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#syaenwnzic .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#syaenwnzic .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#syaenwnzic .gt_left {\n  text-align: left;\n}\n\n#syaenwnzic .gt_center {\n  text-align: center;\n}\n\n#syaenwnzic .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#syaenwnzic .gt_font_normal {\n  font-weight: normal;\n}\n\n#syaenwnzic .gt_font_bold {\n  font-weight: bold;\n}\n\n#syaenwnzic .gt_font_italic {\n  font-style: italic;\n}\n\n#syaenwnzic .gt_super {\n  font-size: 65%;\n}\n\n#syaenwnzic .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#syaenwnzic .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#syaenwnzic .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#syaenwnzic .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#syaenwnzic .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#syaenwnzic .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#syaenwnzic .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  <caption>Distribution of the vote for the NDP by income group</caption>\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"inc\">inc</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"votendp\">votendp</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cum.n\">cum.n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"prop\">prop</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">1</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">0</td>\n<td headers=\"n\" class=\"gt_row gt_right\">114</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">114</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.6826347</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">1</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">53</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">167</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.3173653</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">2</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">0</td>\n<td headers=\"n\" class=\"gt_row gt_right\">161</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">161</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.7419355</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">2</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">56</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">217</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.2580645</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">3</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">0</td>\n<td headers=\"n\" class=\"gt_row gt_right\">49</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">49</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.7656250</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">3</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">15</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">64</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.2343750</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">4</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">0</td>\n<td headers=\"n\" class=\"gt_row gt_right\">129</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">129</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.7865854</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">4</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">35</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">164</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.2134146</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">5</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">0</td>\n<td headers=\"n\" class=\"gt_row gt_right\">108</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">108</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.6708075</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">5</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">53</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">161</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.3291925</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">6</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">0</td>\n<td headers=\"n\" class=\"gt_row gt_right\">112</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">112</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.7044025</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">6</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">47</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">159</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.2955975</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">7</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">0</td>\n<td headers=\"n\" class=\"gt_row gt_right\">114</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">114</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.7215190</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">7</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">44</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">158</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.2784810</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">8</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">0</td>\n<td headers=\"n\" class=\"gt_row gt_right\">244</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">244</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.7746032</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">8</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">71</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">315</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.2253968</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">10</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">0</td>\n<td headers=\"n\" class=\"gt_row gt_right\">140</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">140</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.8045977</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">10</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">34</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">174</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.1954023</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">11</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">0</td>\n<td headers=\"n\" class=\"gt_row gt_right\">114</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">114</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.7651007</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">11</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">35</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">149</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.2348993</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">12</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">0</td>\n<td headers=\"n\" class=\"gt_row gt_right\">154</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">154</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.7549020</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">12</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">50</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">204</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.2450980</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">13</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">0</td>\n<td headers=\"n\" class=\"gt_row gt_right\">105</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">105</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.7894737</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">13</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">28</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">133</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.2105263</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">14</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">0</td>\n<td headers=\"n\" class=\"gt_row gt_right\">208</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">208</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.7878788</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">14</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">56</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">264</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.2121212</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">15</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">0</td>\n<td headers=\"n\" class=\"gt_row gt_right\">95</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">95</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.8333333</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">15</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">19</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">114</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.1666667</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">16</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">0</td>\n<td headers=\"n\" class=\"gt_row gt_right\">113</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">113</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.8129496</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">16</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">26</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">139</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.1870504</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">17</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">0</td>\n<td headers=\"n\" class=\"gt_row gt_right\">171</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">171</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.8300971</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">17</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">35</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">206</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.1699029</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">18</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">0</td>\n<td headers=\"n\" class=\"gt_row gt_right\">83</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">83</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.7830189</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">18</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">23</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">106</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.2169811</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">19</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">0</td>\n<td headers=\"n\" class=\"gt_row gt_right\">143</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">143</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.8171429</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">19</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">32</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">175</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.1828571</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">20</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">0</td>\n<td headers=\"n\" class=\"gt_row gt_right\">145</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">145</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.8734940</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">20</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">21</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">166</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.1265060</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n\n```{.r .cell-code}\ntable.income %>% \n  gt(caption =  \"Distribution of income group among NDP's voters\")\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"bvbksuvjla\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#bvbksuvjla .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#bvbksuvjla .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bvbksuvjla .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#bvbksuvjla .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#bvbksuvjla .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#bvbksuvjla .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bvbksuvjla .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bvbksuvjla .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#bvbksuvjla .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#bvbksuvjla .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#bvbksuvjla .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#bvbksuvjla .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#bvbksuvjla .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#bvbksuvjla .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#bvbksuvjla .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#bvbksuvjla .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#bvbksuvjla .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#bvbksuvjla .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bvbksuvjla .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#bvbksuvjla .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#bvbksuvjla .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bvbksuvjla .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#bvbksuvjla .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#bvbksuvjla .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bvbksuvjla .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bvbksuvjla .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#bvbksuvjla .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#bvbksuvjla .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bvbksuvjla .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bvbksuvjla .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bvbksuvjla .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bvbksuvjla .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bvbksuvjla .gt_left {\n  text-align: left;\n}\n\n#bvbksuvjla .gt_center {\n  text-align: center;\n}\n\n#bvbksuvjla .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#bvbksuvjla .gt_font_normal {\n  font-weight: normal;\n}\n\n#bvbksuvjla .gt_font_bold {\n  font-weight: bold;\n}\n\n#bvbksuvjla .gt_font_italic {\n  font-style: italic;\n}\n\n#bvbksuvjla .gt_super {\n  font-size: 65%;\n}\n\n#bvbksuvjla .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#bvbksuvjla .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#bvbksuvjla .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#bvbksuvjla .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#bvbksuvjla .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#bvbksuvjla .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#bvbksuvjla .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  <caption>Distribution of income group among NDP's voters</caption>\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"inc\">inc</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"votendp\">votendp</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"prop_vote\">prop_vote</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cum.n\">cum.n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"prop\">prop</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rangeleft\">rangeleft</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cumrelfreqN\">cumrelfreqN</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cumrelfreqInc\">cumrelfreqInc</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">1</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">53</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.3173653</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">53</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07230559</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.07230559</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.004975124</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">2</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">56</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2580645</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">109</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07639836</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.07230559</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.14870396</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.014925373</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">3</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">15</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2343750</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">124</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.02046385</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.14870396</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.16916780</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.029850746</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">4</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">35</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2134146</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">159</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04774898</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.16916780</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.21691678</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.049751244</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">5</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">53</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.3291925</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">212</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07230559</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.21691678</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.28922237</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.074626866</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">6</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">47</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2955975</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">259</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.06412005</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.28922237</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.35334243</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.104477612</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">7</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">44</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2784810</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">303</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.06002729</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.35334243</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.41336971</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.139303483</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">8</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">71</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2253968</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">374</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.09686221</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.41336971</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.51023192</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.179104478</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">10</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">34</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1954023</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">408</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04638472</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.51023192</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.55661664</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.228855721</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">11</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">35</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2348993</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">443</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04774898</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.55661664</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.60436562</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.283582090</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">12</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">50</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2450980</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">493</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.06821282</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.60436562</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.67257844</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.343283582</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">13</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">28</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2105263</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">521</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.03819918</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.67257844</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.71077763</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.407960199</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">14</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">56</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2121212</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">577</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07639836</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.71077763</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.78717599</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.477611940</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">15</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">19</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1666667</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">596</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.02592087</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.78717599</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.81309686</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.552238806</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">16</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">26</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1870504</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">622</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.03547067</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.81309686</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.84856753</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.631840796</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">17</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">35</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1699029</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">657</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04774898</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.84856753</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.89631651</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.716417910</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">18</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">23</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2169811</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">680</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.03137790</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.89631651</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.92769441</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.805970149</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">19</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">32</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1828571</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">712</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04365621</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.92769441</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.97135061</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.900497512</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">20</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">21</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1265060</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">733</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.02864939</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.97135061</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">1.00000000</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">1.000000000</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nWe can then plot income groups against their proportion\n\n\n::: {.cell .fig-cap-location-top}\n\n```{.r .cell-code}\ntable.income.pervote %>% filter(votendp == 1) %>% \n  ggplot()+\n  aes(x = factor(inc), y = prop)+\n  geom_col()+\n  theme_bw()+\n  xlab(\"Income group\") -> income.group.plot\n\ntable.income %>% \n  ggplot()+\n  aes(x = factor(inc), y = prop) %>% \n  geom_col()+\n  theme_bw()+\n  ylab(\"\")+\n  xlab(\"\") -> income.group.plot2\n  \n\ncowplot::plot_grid(income.group.plot, income.group.plot2)\n```\n\n::: {.cell-output-display}\n![Distribution of Income groups: Canadian 2015 election survey](technical-note-piketty-2021_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nOn the left, we have a graph very similar to the one of the technical note. The right-sided graph is different, because the proportion are for the overall NPD's voters whereas the left-sided graph represents the proportion within the income group. For example, 30% of income bracket 1 voted for the NDP, but they represent about 7.4% of total NDP's voters.\n\n\n\n\n\n\n\nWhat makes Piketty's team approach special and interesting is their systematic analysis in terms of quantile groups. This is, according to them, their main contribution and this approach has the advantage to allow for systematic comparison accross space and time. We will try to reproduce here their conversion of income group into quantiles.\n\nIn R, the decile for each observation can be added to the dataset with the function ntile():\n\n\n::: {.cell}\n\n```{.r .cell-code}\nca2015 <- ca2015 %>% \n  mutate(\n  decile = ntile(inc, 10)\n)\n```\n:::\n\n\nNow, the last column of ca2015 is the decile for each observation in the dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nca2015 %>% filter(votendp == 1) %>% \n  group_by(inc) %>% \n  count(decile) %>% \n  drop_na() %>% \n  ungroup() %>% \n  mutate(prop = n/sum(n),\n         cumsumprop = cumsum(prop)) -> table.income.vote\n\ntable.income.vote %>% gt(caption = \"Decile and income bracket\")\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"azesphjacw\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#azesphjacw .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#azesphjacw .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#azesphjacw .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#azesphjacw .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#azesphjacw .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#azesphjacw .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#azesphjacw .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#azesphjacw .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#azesphjacw .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#azesphjacw .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#azesphjacw .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#azesphjacw .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#azesphjacw .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#azesphjacw .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#azesphjacw .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#azesphjacw .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#azesphjacw .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#azesphjacw .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#azesphjacw .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#azesphjacw .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#azesphjacw .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#azesphjacw .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#azesphjacw .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#azesphjacw .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#azesphjacw .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#azesphjacw .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#azesphjacw .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#azesphjacw .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#azesphjacw .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#azesphjacw .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#azesphjacw .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#azesphjacw .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#azesphjacw .gt_left {\n  text-align: left;\n}\n\n#azesphjacw .gt_center {\n  text-align: center;\n}\n\n#azesphjacw .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#azesphjacw .gt_font_normal {\n  font-weight: normal;\n}\n\n#azesphjacw .gt_font_bold {\n  font-weight: bold;\n}\n\n#azesphjacw .gt_font_italic {\n  font-style: italic;\n}\n\n#azesphjacw .gt_super {\n  font-size: 65%;\n}\n\n#azesphjacw .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#azesphjacw .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#azesphjacw .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#azesphjacw .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#azesphjacw .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#azesphjacw .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#azesphjacw .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  <caption>Decile and income bracket</caption>\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"inc\">inc</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"decile\">decile</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"prop\">prop</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cumsumprop\">cumsumprop</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">1</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">53</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.072305593</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.07230559</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">2</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">23</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.031377899</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.10368349</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">2</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">2</td>\n<td headers=\"n\" class=\"gt_row gt_right\">33</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.045020464</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.14870396</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">3</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">2</td>\n<td headers=\"n\" class=\"gt_row gt_right\">15</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.020463847</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.16916780</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">4</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">2</td>\n<td headers=\"n\" class=\"gt_row gt_right\">22</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.030013643</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.19918145</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">4</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">3</td>\n<td headers=\"n\" class=\"gt_row gt_right\">13</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.017735334</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.21691678</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">5</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">3</td>\n<td headers=\"n\" class=\"gt_row gt_right\">53</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.072305593</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.28922237</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">6</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">3</td>\n<td headers=\"n\" class=\"gt_row gt_right\">40</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.054570259</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.34379263</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">6</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">4</td>\n<td headers=\"n\" class=\"gt_row gt_right\">7</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.009549795</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.35334243</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">7</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">4</td>\n<td headers=\"n\" class=\"gt_row gt_right\">44</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.060027285</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.41336971</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">8</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">4</td>\n<td headers=\"n\" class=\"gt_row gt_right\">30</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.040927694</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.45429741</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">8</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">5</td>\n<td headers=\"n\" class=\"gt_row gt_right\">41</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.055934516</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.51023192</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">10</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">5</td>\n<td headers=\"n\" class=\"gt_row gt_right\">16</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.021828104</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.53206003</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">10</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">6</td>\n<td headers=\"n\" class=\"gt_row gt_right\">18</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.024556617</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.55661664</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">11</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">6</td>\n<td headers=\"n\" class=\"gt_row gt_right\">35</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.047748977</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.60436562</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">12</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">6</td>\n<td headers=\"n\" class=\"gt_row gt_right\">35</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.047748977</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.65211460</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">12</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">7</td>\n<td headers=\"n\" class=\"gt_row gt_right\">15</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.020463847</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.67257844</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">13</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">7</td>\n<td headers=\"n\" class=\"gt_row gt_right\">28</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.038199181</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.71077763</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">14</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">7</td>\n<td headers=\"n\" class=\"gt_row gt_right\">27</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.036834925</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.74761255</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">14</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">8</td>\n<td headers=\"n\" class=\"gt_row gt_right\">29</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.039563438</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.78717599</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">15</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">8</td>\n<td headers=\"n\" class=\"gt_row gt_right\">19</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.025920873</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.81309686</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">16</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">8</td>\n<td headers=\"n\" class=\"gt_row gt_right\">19</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.025920873</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.83901774</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">16</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">9</td>\n<td headers=\"n\" class=\"gt_row gt_right\">7</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.009549795</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.84856753</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">17</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">9</td>\n<td headers=\"n\" class=\"gt_row gt_right\">35</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.047748977</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.89631651</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">18</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">9</td>\n<td headers=\"n\" class=\"gt_row gt_right\">21</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.028649386</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.92496589</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">18</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">10</td>\n<td headers=\"n\" class=\"gt_row gt_right\">2</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.002728513</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.92769441</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">19</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">10</td>\n<td headers=\"n\" class=\"gt_row gt_right\">32</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.043656207</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.97135061</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">20</td>\n<td headers=\"decile\" class=\"gt_row gt_right\">10</td>\n<td headers=\"n\" class=\"gt_row gt_right\">21</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.028649386</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">1.00000000</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nHowever, it is straightforward to see that the ntile() function is not perfect in computing decile. More generally, computing income decile when the income variable is in brackets seems complicated, but the technical note proposes a re-weighting average approach to partially solve this problem.\n\nTo see how the re-weighing approach works, let's go back to the first table:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable.income %>%\n  mutate(id = 1:length(table.income$inc)) %>% \n  gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"ggqeftpyfw\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#ggqeftpyfw .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ggqeftpyfw .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ggqeftpyfw .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ggqeftpyfw .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ggqeftpyfw .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ggqeftpyfw .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ggqeftpyfw .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ggqeftpyfw .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ggqeftpyfw .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ggqeftpyfw .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ggqeftpyfw .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ggqeftpyfw .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ggqeftpyfw .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ggqeftpyfw .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ggqeftpyfw .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ggqeftpyfw .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ggqeftpyfw .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ggqeftpyfw .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ggqeftpyfw .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ggqeftpyfw .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ggqeftpyfw .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ggqeftpyfw .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ggqeftpyfw .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ggqeftpyfw .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ggqeftpyfw .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ggqeftpyfw .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ggqeftpyfw .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ggqeftpyfw .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ggqeftpyfw .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ggqeftpyfw .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ggqeftpyfw .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ggqeftpyfw .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ggqeftpyfw .gt_left {\n  text-align: left;\n}\n\n#ggqeftpyfw .gt_center {\n  text-align: center;\n}\n\n#ggqeftpyfw .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ggqeftpyfw .gt_font_normal {\n  font-weight: normal;\n}\n\n#ggqeftpyfw .gt_font_bold {\n  font-weight: bold;\n}\n\n#ggqeftpyfw .gt_font_italic {\n  font-style: italic;\n}\n\n#ggqeftpyfw .gt_super {\n  font-size: 65%;\n}\n\n#ggqeftpyfw .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#ggqeftpyfw .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ggqeftpyfw .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ggqeftpyfw .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ggqeftpyfw .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ggqeftpyfw .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ggqeftpyfw .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"inc\">inc</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"votendp\">votendp</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"prop_vote\">prop_vote</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cum.n\">cum.n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"prop\">prop</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rangeleft\">rangeleft</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cumrelfreqN\">cumrelfreqN</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cumrelfreqInc\">cumrelfreqInc</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"id\">id</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">1</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">53</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.3173653</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">53</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07230559</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.07230559</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.004975124</td>\n<td headers=\"id\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">2</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">56</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2580645</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">109</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07639836</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.07230559</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.14870396</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.014925373</td>\n<td headers=\"id\" class=\"gt_row gt_right\">2</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">3</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">15</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2343750</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">124</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.02046385</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.14870396</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.16916780</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.029850746</td>\n<td headers=\"id\" class=\"gt_row gt_right\">3</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">4</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">35</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2134146</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">159</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04774898</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.16916780</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.21691678</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.049751244</td>\n<td headers=\"id\" class=\"gt_row gt_right\">4</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">5</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">53</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.3291925</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">212</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07230559</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.21691678</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.28922237</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.074626866</td>\n<td headers=\"id\" class=\"gt_row gt_right\">5</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">6</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">47</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2955975</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">259</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.06412005</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.28922237</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.35334243</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.104477612</td>\n<td headers=\"id\" class=\"gt_row gt_right\">6</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">7</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">44</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2784810</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">303</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.06002729</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.35334243</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.41336971</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.139303483</td>\n<td headers=\"id\" class=\"gt_row gt_right\">7</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">8</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">71</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2253968</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">374</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.09686221</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.41336971</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.51023192</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.179104478</td>\n<td headers=\"id\" class=\"gt_row gt_right\">8</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">10</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">34</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1954023</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">408</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04638472</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.51023192</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.55661664</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.228855721</td>\n<td headers=\"id\" class=\"gt_row gt_right\">9</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">11</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">35</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2348993</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">443</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04774898</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.55661664</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.60436562</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.283582090</td>\n<td headers=\"id\" class=\"gt_row gt_right\">10</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">12</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">50</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2450980</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">493</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.06821282</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.60436562</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.67257844</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.343283582</td>\n<td headers=\"id\" class=\"gt_row gt_right\">11</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">13</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">28</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2105263</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">521</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.03819918</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.67257844</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.71077763</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.407960199</td>\n<td headers=\"id\" class=\"gt_row gt_right\">12</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">14</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">56</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2121212</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">577</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07639836</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.71077763</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.78717599</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.477611940</td>\n<td headers=\"id\" class=\"gt_row gt_right\">13</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">15</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">19</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1666667</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">596</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.02592087</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.78717599</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.81309686</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.552238806</td>\n<td headers=\"id\" class=\"gt_row gt_right\">14</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">16</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">26</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1870504</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">622</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.03547067</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.81309686</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.84856753</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.631840796</td>\n<td headers=\"id\" class=\"gt_row gt_right\">15</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">17</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">35</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1699029</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">657</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04774898</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.84856753</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.89631651</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.716417910</td>\n<td headers=\"id\" class=\"gt_row gt_right\">16</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">18</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">23</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2169811</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">680</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.03137790</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.89631651</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.92769441</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.805970149</td>\n<td headers=\"id\" class=\"gt_row gt_right\">17</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">19</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">32</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1828571</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">712</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04365621</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.92769441</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.97135061</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.900497512</td>\n<td headers=\"id\" class=\"gt_row gt_right\">18</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">20</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">21</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1265060</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">733</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.02864939</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.97135061</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">1.00000000</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">1.000000000</td>\n<td headers=\"id\" class=\"gt_row gt_right\">19</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nWe can directly see the problem posed by income brackets: for example, we can observe that all of income bracket one belongs to the first decile since its relative range is between 0 and 0.0723. However, the relative range of bracket two is \\[0.0723 - 0.1487\\]. Some part of it belong to the first decile (\\[0 - 0.1\\]), but some belong to the second (\\[0 - 0.2\\]). The approach to compute the proportion of observations belonging to the any given decile is to compute the share of each income bracket belonging to this decile and then compute a weighted average. For example, if I want to compute the share of observation of the first decile (D10), I already know that 100% of income bracket one belongs to D10 but I need to know the share of bracket 2 (B2) belonging to D10.\n\nTo estimate this, let's assume the distribution of B2 is uniform $x \\sim U[0.0723; 0.1487]$, with x the observation within this range. We want to know $P(x<0.1)$, that is to say, the probability that x belongs to the first decile. We use the uniform cumulative distribution function with parameters min = 0.073 and max = 0.1487: $P(x<0.1) = \\frac{0.1-0.0723}{0.1487-0.0723} = 0.3626$. This means that 36.26% of B2 belongs to D10. Then, the weighted average for the proportion of observation within D10: $\\frac{1*0.317+0.3626*0.26}{1+0.3626} = 0.3018$. 30.2% the first decile voters voted for the NDP in 2015.\n\nHere are the computations in R:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npunif(0.1, table.income$cumrelfreqN[1], table.income$cumrelfreqN[2])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.3625\n```\n:::\n\n```{.r .cell-code}\n(1*0.317+0.3626*0.26)/(1+0.3626)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.3018318\n```\n:::\n\n```{.r .cell-code}\nweighted.mean(x = c(table.income$prop_vote[1], table.income$prop_vote[2]), w = c(1, punif(0.1, table.income$cumrelfreqN[1], table.income$cumrelfreqN[2])))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.301588\n```\n:::\n:::\n\n\nUnfortunately, there is to my knowledge no function in R that will compute the weights automatically. I can nonetheless compute them through a tedious for loop:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweight <- rep(NA, length(table.income$inc))\n\nfor (i in 1:length(table.income$inc)) {\n  weight[i] <- ifelse(table.income$cumrelfreqN[i] < 0.1 | table.income$cumrelfreqN[i] == 1, 1,\n                  ifelse(table.income$cumrelfreqN[i] > 0.1 & table.income$cumrelfreqN[i] < 0.2, punif(0.1, min = table.income$cumrelfreqN[i-1], max = table.income$cumrelfreqN[i]),\n                         ifelse(table.income$cumrelfreqN[i] > 0.2 & table.income$cumrelfreqN[i] < 0.3, punif(0.2, min = table.income$cumrelfreqN[i-1], max = table.income$cumrelfreqN[i]),\n                                ifelse(table.income$cumrelfreqN[i] > 0.3 & table.income$cumrelfreqN[i] < 0.4, punif(0.3, min = table.income$cumrelfreqN[i-1], max = table.income$cumrelfreqN[i]),\n                                       ifelse(table.income$cumrelfreqN[i] > 0.4 & table.income$cumrelfreqN[i] < 0.5, punif(0.4, min = table.income$cumrelfreqN[i-1], max = table.income$cumrelfreqN[i]), \n                                              ifelse(table.income$cumrelfreqN[i] > 0.5 & table.income$cumrelfreqN[i] < 0.6, punif(0.5, min = table.income$cumrelfreqN[i-1], max = table.income$cumrelfreqN[i]), \n                                                     ifelse(table.income$cumrelfreqN[i] > 0.6 & table.income$cumrelfreqN[i] < 0.7, punif(0.6, min = table.income$cumrelfreqN[i-1], max = table.income$cumrelfreqN[i]),\n                                                            ifelse(table.income$cumrelfreqN[i] > 0.7 & table.income$cumrelfreqN[i] < 0.8, punif(0.7, min = table.income$cumrelfreqN[i-1], max = table.income$cumrelfreqN[i]),\n                                                                   ifelse(table.income$cumrelfreqN[i] > 0.8 & table.income$cumrelfreqN[i] < 0.9, punif(0.8, min = table.income$cumrelfreqN[i-1], max = table.income$cumrelfreqN[i]), 1)))))))))\n}\nweight\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 1.0000000 0.3625000 0.0000000 0.6457143 0.0000000 0.1680851 0.7772727\n [8] 0.8943662 0.0000000 0.9085714 0.0000000 0.7178571 0.0000000 0.4947368\n[15] 0.0000000 0.0000000 1.0000000 1.0000000 1.0000000\n```\n:::\n:::\n\n\nI replace the 0 with 1:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweight <- ifelse(weight == 0, 1, weight)\n\ntable.income <- table.income %>% select(-cumrelfreqInc) %>% \n  mutate(share_decile = weight)\n\ntable.income %>% \n  mutate(share_rest = 1 - weight) -> table.income\n\ntable.income %>% mutate(\n  prop_vote = table.income.pervote$prop[table.income.pervote$votendp == 1]\n) %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"bqmogaxcvi\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#bqmogaxcvi .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#bqmogaxcvi .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bqmogaxcvi .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#bqmogaxcvi .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#bqmogaxcvi .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#bqmogaxcvi .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bqmogaxcvi .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bqmogaxcvi .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#bqmogaxcvi .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#bqmogaxcvi .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#bqmogaxcvi .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#bqmogaxcvi .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#bqmogaxcvi .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#bqmogaxcvi .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#bqmogaxcvi .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#bqmogaxcvi .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#bqmogaxcvi .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#bqmogaxcvi .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bqmogaxcvi .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#bqmogaxcvi .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#bqmogaxcvi .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bqmogaxcvi .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#bqmogaxcvi .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#bqmogaxcvi .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bqmogaxcvi .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bqmogaxcvi .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#bqmogaxcvi .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#bqmogaxcvi .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bqmogaxcvi .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bqmogaxcvi .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bqmogaxcvi .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bqmogaxcvi .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bqmogaxcvi .gt_left {\n  text-align: left;\n}\n\n#bqmogaxcvi .gt_center {\n  text-align: center;\n}\n\n#bqmogaxcvi .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#bqmogaxcvi .gt_font_normal {\n  font-weight: normal;\n}\n\n#bqmogaxcvi .gt_font_bold {\n  font-weight: bold;\n}\n\n#bqmogaxcvi .gt_font_italic {\n  font-style: italic;\n}\n\n#bqmogaxcvi .gt_super {\n  font-size: 65%;\n}\n\n#bqmogaxcvi .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#bqmogaxcvi .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#bqmogaxcvi .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#bqmogaxcvi .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#bqmogaxcvi .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#bqmogaxcvi .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#bqmogaxcvi .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"inc\">inc</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"votendp\">votendp</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"prop_vote\">prop_vote</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cum.n\">cum.n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"prop\">prop</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rangeleft\">rangeleft</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cumrelfreqN\">cumrelfreqN</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"share_decile\">share_decile</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"share_rest\">share_rest</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">1</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">53</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.3173653</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">53</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07230559</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.07230559</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">2</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">56</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2580645</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">109</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07639836</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.07230559</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.14870396</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">0.3625000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.63750000</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">3</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">15</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2343750</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">124</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.02046385</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.14870396</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.16916780</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">4</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">35</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2134146</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">159</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04774898</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.16916780</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.21691678</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">0.6457143</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.35428571</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">5</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">53</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.3291925</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">212</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07230559</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.21691678</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.28922237</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">6</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">47</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2955975</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">259</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.06412005</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.28922237</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.35334243</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">0.1680851</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.83191489</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">7</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">44</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2784810</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">303</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.06002729</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.35334243</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.41336971</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">0.7772727</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.22272727</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">8</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">71</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2253968</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">374</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.09686221</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.41336971</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.51023192</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">0.8943662</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.10563380</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">10</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">34</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1954023</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">408</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04638472</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.51023192</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.55661664</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">11</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">35</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2348993</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">443</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04774898</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.55661664</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.60436562</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">0.9085714</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.09142857</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">12</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">50</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2450980</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">493</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.06821282</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.60436562</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.67257844</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">13</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">28</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2105263</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">521</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.03819918</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.67257844</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.71077763</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">0.7178571</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.28214286</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">14</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">56</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2121212</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">577</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07639836</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.71077763</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.78717599</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">15</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">19</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1666667</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">596</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.02592087</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.78717599</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.81309686</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">0.4947368</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.50526316</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">16</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">26</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1870504</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">622</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.03547067</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.81309686</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.84856753</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">17</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">35</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1699029</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">657</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04774898</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.84856753</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.89631651</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">18</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">23</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2169811</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">680</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.03137790</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.89631651</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.92769441</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">19</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">32</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1828571</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">712</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04365621</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.92769441</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.97135061</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">20</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">21</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1265060</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">733</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.02864939</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.97135061</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">1.00000000</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nThere can be mistakes, but the results seem to make sense\n\nSince I do not want to ever do this computation again (), I put all of this into a function:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweight_share <- function(x){\n  weight <- rep(NA, length(x))\n  \n  for (i in 1:length(x)) {\n   weight[i] <-  ifelse(x[i] < 0.1 | x[i] == 1, 1,\n                  ifelse(x[i] > 0.1 & x[i] < 0.2, punif(0.1, min = x[i-1], max = x[i]),\n                         ifelse(x[i] > 0.2 & x[i] < 0.3, punif(0.2, min = x[i-1], max = x[i]),\n                                ifelse(x[i] > 0.3 & x[i] < 0.4, punif(0.3, min = x[i-1], max = x[i]),\n                                       ifelse(x[i] > 0.4 & x[i] < 0.5, punif(0.4, min = x[i-1], max = x[i]), \n                                              ifelse(x[i] > 0.5 & x[i] < 0.6, punif(0.5, min = x[i-1], max = x[i]), \n                                                     ifelse(x[i] > 0.6 & x[i] < 0.7, punif(0.6, min = x[i-1], max = x[i]),\n                                                            ifelse(x[i] > 0.7 & x[i] < 0.8, punif(0.7, min = x[i-1], max = x[i]),\n                                                                   ifelse(x[i] > 0.8 & x[i] < 0.9, punif(0.8, min = x[i-1], max = x[i]), 1)))))))))\n  }\n  weight <- ifelse(weight == 0, 1, weight)\n  print(weight)\n}\n```\n:::\n\n\nLet's check if the function works\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweight_share(x = table.income$cumrelfreqN)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 1.0000000 0.3625000 1.0000000 0.6457143 1.0000000 0.1680851 0.7772727\n [8] 0.8943662 1.0000000 0.9085714 1.0000000 0.7178571 1.0000000 0.4947368\n[15] 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000\n```\n:::\n:::\n\n\nWe are almost done, there are only the weighted averages for each decile left to calculate. One further step is to compute dummy variables to show to which decile income brackets belong to. This will produce a table close to the one from the technical note.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable.income %>% \n  mutate(d1 = ifelse(table.income$rangeleft >= 0 & table.income$rangeleft < 0.1, 1, 0),\n         d2 = ifelse(table.income$rangeleft %[]% c(0.1, 0.2) | table.income$cumrelfreqN %[]% c(0.1, 0.2), 1, 0),  # the %[]% is an within bracket operator from the Desctools package. for example, x %[]% c(a, b) checks whether x belong to the interval [a, b] with a<b \n         d3 = ifelse(table.income$rangeleft %[]% c(0.2, 0.3) | table.income$cumrelfreqN %[]% c(0.2, 0.3), 1, 0),\n         d4 = ifelse(table.income$rangeleft %[]% c(0.3, 0.4) | table.income$cumrelfreqN %[]% c(0.3, 0.4), 1, 0),\n         d5 = ifelse(table.income$rangeleft %[]% c(0.4, 0.5) | table.income$cumrelfreqN %[]% c(0.4, 0.5), 1, 0),\n         d6 = ifelse(table.income$rangeleft %[]% c(0.5, 0.6) | table.income$cumrelfreqN %[]% c(0.5, 0.6), 1, 0),\n         d7 = ifelse(table.income$rangeleft %[]% c(0.6, 0.7) | table.income$cumrelfreqN %[]% c(0.6, 0.7), 1, 0),\n         d8 = ifelse(table.income$rangeleft %[]% c(0.7, 0.8) | table.income$cumrelfreqN %[]% c(0.7, 0.8), 1, 0),\n         d9 = ifelse(table.income$rangeleft %[]% c(0.8, 0.9) | table.income$cumrelfreqN %[]% c(0.8, 0.9), 1, 0),\n         d10 = ifelse(table.income$rangeleft %[]% c(0.9, 1) | table.income$cumrelfreqN %[]% c(0.9, 1), 1, 0)) -> table.income\n\ntable.income %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"ratnnczums\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#ratnnczums .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ratnnczums .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ratnnczums .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ratnnczums .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ratnnczums .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ratnnczums .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ratnnczums .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ratnnczums .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ratnnczums .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ratnnczums .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ratnnczums .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ratnnczums .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ratnnczums .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ratnnczums .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ratnnczums .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ratnnczums .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ratnnczums .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ratnnczums .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ratnnczums .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ratnnczums .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ratnnczums .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ratnnczums .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ratnnczums .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ratnnczums .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ratnnczums .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ratnnczums .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ratnnczums .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ratnnczums .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ratnnczums .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ratnnczums .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ratnnczums .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ratnnczums .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ratnnczums .gt_left {\n  text-align: left;\n}\n\n#ratnnczums .gt_center {\n  text-align: center;\n}\n\n#ratnnczums .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ratnnczums .gt_font_normal {\n  font-weight: normal;\n}\n\n#ratnnczums .gt_font_bold {\n  font-weight: bold;\n}\n\n#ratnnczums .gt_font_italic {\n  font-style: italic;\n}\n\n#ratnnczums .gt_super {\n  font-size: 65%;\n}\n\n#ratnnczums .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#ratnnczums .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ratnnczums .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ratnnczums .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ratnnczums .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ratnnczums .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ratnnczums .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"inc\">inc</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"votendp\">votendp</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"prop_vote\">prop_vote</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cum.n\">cum.n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"prop\">prop</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rangeleft\">rangeleft</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cumrelfreqN\">cumrelfreqN</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"share_decile\">share_decile</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"share_rest\">share_rest</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d1\">d1</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d2\">d2</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d3\">d3</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d4\">d4</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d5\">d5</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d6\">d6</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d7\">d7</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d8\">d8</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d9\">d9</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"d10\">d10</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">1</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">53</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.3173653</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">53</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07230559</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.07230559</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"d1\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d2\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d5\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d7\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d8\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d9\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d10\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">2</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">56</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2580645</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">109</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07639836</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.07230559</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.14870396</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">0.3625000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.63750000</td>\n<td headers=\"d1\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d2\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d5\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d7\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d8\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d9\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d10\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">3</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">15</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2343750</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">124</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.02046385</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.14870396</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.16916780</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"d1\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d2\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d5\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d7\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d8\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d9\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d10\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">4</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">35</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2134146</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">159</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04774898</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.16916780</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.21691678</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">0.6457143</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.35428571</td>\n<td headers=\"d1\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d2\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d3\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d5\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d7\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d8\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d9\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d10\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">5</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">53</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.3291925</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">212</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07230559</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.21691678</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.28922237</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"d1\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d2\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d3\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d5\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d7\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d8\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d9\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d10\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">6</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">47</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2955975</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">259</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.06412005</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.28922237</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.35334243</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">0.1680851</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.83191489</td>\n<td headers=\"d1\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d2\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d3\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d4\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d5\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d7\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d8\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d9\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d10\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">7</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">44</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2784810</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">303</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.06002729</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.35334243</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.41336971</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">0.7772727</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.22272727</td>\n<td headers=\"d1\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d2\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d4\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d5\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d7\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d8\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d9\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d10\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">8</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">71</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2253968</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">374</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.09686221</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.41336971</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.51023192</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">0.8943662</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.10563380</td>\n<td headers=\"d1\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d2\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d5\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d6\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d7\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d8\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d9\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d10\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">10</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">34</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1954023</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">408</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04638472</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.51023192</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.55661664</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"d1\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d2\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d5\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d6\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d7\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d8\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d9\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d10\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">11</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">35</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2348993</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">443</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04774898</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.55661664</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.60436562</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">0.9085714</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.09142857</td>\n<td headers=\"d1\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d2\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d5\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d6\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d7\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d8\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d9\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d10\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">12</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">50</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2450980</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">493</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.06821282</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.60436562</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.67257844</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"d1\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d2\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d5\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d7\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d8\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d9\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d10\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">13</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">28</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2105263</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">521</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.03819918</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.67257844</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.71077763</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">0.7178571</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.28214286</td>\n<td headers=\"d1\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d2\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d5\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d7\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d8\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d9\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d10\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">14</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">56</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2121212</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">577</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07639836</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.71077763</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.78717599</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"d1\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d2\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d5\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d7\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d8\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d9\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d10\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">15</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">19</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1666667</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">596</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.02592087</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.78717599</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.81309686</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">0.4947368</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.50526316</td>\n<td headers=\"d1\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d2\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d5\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d7\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d8\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d9\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d10\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">16</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">26</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1870504</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">622</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.03547067</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.81309686</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.84856753</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"d1\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d2\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d5\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d7\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d8\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d9\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d10\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">17</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">35</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1699029</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">657</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04774898</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.84856753</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.89631651</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"d1\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d2\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d5\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d7\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d8\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d9\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d10\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">18</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">23</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.2169811</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">680</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.03137790</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.89631651</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.92769441</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"d1\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d2\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d5\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d7\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d8\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d9\" class=\"gt_row gt_right\">1</td>\n<td headers=\"d10\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">19</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">32</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1828571</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">712</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04365621</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.92769441</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.97135061</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"d1\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d2\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d5\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d7\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d8\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d9\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d10\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">20</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">21</td>\n<td headers=\"prop_vote\" class=\"gt_row gt_right\">0.1265060</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">733</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.02864939</td>\n<td headers=\"rangeleft\" class=\"gt_row gt_right\">0.97135061</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">1.00000000</td>\n<td headers=\"share_decile\" class=\"gt_row gt_right\">1.0000000</td>\n<td headers=\"share_rest\" class=\"gt_row gt_right\">0.00000000</td>\n<td headers=\"d1\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d2\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d3\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d4\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d5\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d6\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d7\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d8\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d9\" class=\"gt_row gt_right\">0</td>\n<td headers=\"d10\" class=\"gt_row gt_right\">1</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nThis compute the proportion of the first decile directly from the table above:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweighted.mean(x = table.income$prop_vote[table.income$d1 == 1], w = table.income$share_decile[table.income$d1 == 1]) # d1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.301588\n```\n:::\n:::\n\n\nLet's try to compute the 3 first decile in a way that can then be put into a for loop or even into a function later\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# for d_i\n\nweighted.mean(x = c(table.income$prop_vote[table.income[,11] == 1]),\n              w = c(table.income$share_decile[table.income[,11] == 1])) #d1: take columns 11 (D1) and the values of prop vote and share decile for which D11 == 1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.301588\n```\n:::\n\n```{.r .cell-code}\nweighted.mean(x = c(table.income$prop_vote[table.income[,12] == 1]),\n              w = c(table.income$share_rest[table.income[,11] == 1 & table.income[, 12] == 1],\n                    table.income$share_decile[table.income[,11] == 0 & table.income[,12] == 1])) #d2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2350616\n```\n:::\n\n```{.r .cell-code}\nweighted.mean(x = c(table.income$prop_vote[table.income[,13] == 1]),\n              w = c(table.income$share_rest[table.income[,13-1] == 1 & table.income[, 13] == 1], #d3\n                    table.income$share_decile[table.income[13-1] == 0 & table.income[,13] == 1]))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2985395\n```\n:::\n:::\n\n\nLet's try the for loop\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndecile_vec <- rep(NA, 10)\ndecile <- c()\n#11:20 are the decile dummies columns in the dataset\ndecile_vec <- capture.output(for (i in 11:20) {\n\n  if(i == 11){\n    \n  decile =  c(weighted.mean(x = c(table.income$prop_vote[table.income[,i] == 1]),\n              w = c(table.income$share_decile[table.income[,i] == 1])))\n  }else{\n    \n   decile = c(weighted.mean(x = c(table.income$prop_vote[table.income[,i] == 1]),\n              w = c(table.income$share_rest[table.income[,i-1] == 1 & table.income[, i] == 1], \n                    table.income$share_decile[table.income[i-1] == 0 & table.income[,i] == 1])))\n  }\n \ncat(decile,\"\\n\")\n})\n\ndecile_vec <- as.numeric(decile_vec)\ndecile <- data.frame(decile = 1:10,\n                         prop = decile_vec)\ndecile\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   decile      prop\n1       1 0.3015880\n2       2 0.2350616\n3       3 0.2985395\n4       4 0.2873299\n5       5 0.2359808\n6       6 0.2147917\n7       7 0.2308659\n8       8 0.1992121\n9       9 0.1877591\n10     10 0.1546816\n```\n:::\n:::\n\n\nThis seems to work, the 3 first values are the same as the ones computed above\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndecile %>% \n  ggplot()+\n  aes(x = factor(decile), y = prop)+\n  geom_col()+\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](technical-note-piketty-2021_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\nThis graph is very close to the one from the techninal note (figure one, right-sided graph)\n\n![](graph1.png){fig-align=\"center\"}\n\nFor now, let's put the for loop into a function: this function would require the decile dummies columns, the columns for the proportion, the column for decile share and the column for the rest's share:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndecile_vec <- function(data, columns, prop, share_decile, share_rest){\n  \n  decile_vec <- rep(NA, 10)\ndecile <- c()\n\ndecile_vec <- capture.output(for (i in min(columns):max(columns)) {\n\n  if(i == min(columns)){\n    \n  decile =  c(weighted.mean(x = c(prop[data[,i] == 1]),\n              w = c(share_decile[data[,i] == 1])))\n  }else{\n    \n   decile = c(weighted.mean(x = c(prop[data[,i] == 1]),\n              w = c(share_rest[data[,i-1] == 1 & data[, i] == 1], \n                    share_decile[data[i-1] == 0 & data[,i] == 1])))\n  }\n \ncat(decile,\"\\n\")\n})\n\ndecile_vec <- as.numeric(decile_vec)\ndecile <- data.frame(decile = 1:10,\n                         prop = decile_vec)\ndecile\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndecile_vec(data = table.income, columns = 11:20, prop = table.income$prop_vote, share_decile = table.income$share_decile, share_rest = table.income$share_rest)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   decile      prop\n1       1 0.3015880\n2       2 0.2350616\n3       3 0.2985395\n4       4 0.2873299\n5       5 0.2359808\n6       6 0.2147917\n7       7 0.2308659\n8       8 0.1992121\n9       9 0.1877591\n10     10 0.1546816\n```\n:::\n:::\n\n\nThe function seems to work, but requires a specific dataframe (formatted as table.income).\n\n\n## Sidenote: fitting a Pareto line to income brackets\n\nFinally, one can also try to fit a \"Pareto line\" to the income bracket data. Vilfredo Pareto (1848-1923) is well-known for being one of the first economist to have computed inequality indices (his famous alpha coefficient) directly from personal income distribution data. His relationship $log(N) = A-\\alpha log(x)$, with N the number of people earning more than income level x, is a famous relationship and almost every course on income inequality measurement starts with it.\n\nFirst, a table need to be constructed from the data, we count the number of observation per income bracket and compute the inverse of the cumulative relative frequencies, which is the same as N is Pareto's equation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nca2015 %>% \n  count(inc) %>% \n  mutate(prop = n/sum(n),\n         cumrelfreq = cumsum(prop),\n         inverse_rcdf = rev(cumrelfreq)) -> paretotable\n\nparetotable %>% \n  gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"ucjppkpygc\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#ucjppkpygc .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ucjppkpygc .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ucjppkpygc .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ucjppkpygc .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ucjppkpygc .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ucjppkpygc .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ucjppkpygc .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ucjppkpygc .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ucjppkpygc .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ucjppkpygc .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ucjppkpygc .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ucjppkpygc .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ucjppkpygc .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ucjppkpygc .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ucjppkpygc .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ucjppkpygc .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ucjppkpygc .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ucjppkpygc .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ucjppkpygc .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ucjppkpygc .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ucjppkpygc .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ucjppkpygc .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ucjppkpygc .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ucjppkpygc .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ucjppkpygc .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ucjppkpygc .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ucjppkpygc .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ucjppkpygc .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ucjppkpygc .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ucjppkpygc .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ucjppkpygc .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ucjppkpygc .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ucjppkpygc .gt_left {\n  text-align: left;\n}\n\n#ucjppkpygc .gt_center {\n  text-align: center;\n}\n\n#ucjppkpygc .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ucjppkpygc .gt_font_normal {\n  font-weight: normal;\n}\n\n#ucjppkpygc .gt_font_bold {\n  font-weight: bold;\n}\n\n#ucjppkpygc .gt_font_italic {\n  font-style: italic;\n}\n\n#ucjppkpygc .gt_super {\n  font-size: 65%;\n}\n\n#ucjppkpygc .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#ucjppkpygc .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ucjppkpygc .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ucjppkpygc .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ucjppkpygc .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ucjppkpygc .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ucjppkpygc .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"inc\">inc</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"prop\">prop</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cumrelfreq\">cumrelfreq</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"inverse_rcdf\">inverse_rcdf</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">211</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04687847</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.04687847</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">1.00000000</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">2</td>\n<td headers=\"n\" class=\"gt_row gt_right\">327</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07265052</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.11952899</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.87136192</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">3</td>\n<td headers=\"n\" class=\"gt_row gt_right\">79</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.01755166</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.13708065</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.82914908</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">4</td>\n<td headers=\"n\" class=\"gt_row gt_right\">210</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04665630</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.18373695</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.78626972</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">5</td>\n<td headers=\"n\" class=\"gt_row gt_right\">199</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04421240</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.22794934</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.75960898</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">6</td>\n<td headers=\"n\" class=\"gt_row gt_right\">184</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04087980</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.26882915</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.70451011</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">7</td>\n<td headers=\"n\" class=\"gt_row gt_right\">188</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04176850</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.31059764</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.66985114</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">8</td>\n<td headers=\"n\" class=\"gt_row gt_right\">421</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.09353477</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.40413242</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.64185737</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">10</td>\n<td headers=\"n\" class=\"gt_row gt_right\">205</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04554543</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.44967785</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.57209509</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">11</td>\n<td headers=\"n\" class=\"gt_row gt_right\">166</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.03688069</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.48655854</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.53921351</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">12</td>\n<td headers=\"n\" class=\"gt_row gt_right\">237</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.05265497</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.53921351</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.48655854</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">13</td>\n<td headers=\"n\" class=\"gt_row gt_right\">148</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.03288158</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.57209509</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.44967785</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">14</td>\n<td headers=\"n\" class=\"gt_row gt_right\">314</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.06976228</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.64185737</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.40413242</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">15</td>\n<td headers=\"n\" class=\"gt_row gt_right\">126</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.02799378</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.66985114</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.31059764</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">16</td>\n<td headers=\"n\" class=\"gt_row gt_right\">156</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.03465896</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.70451011</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.26882915</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">17</td>\n<td headers=\"n\" class=\"gt_row gt_right\">248</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.05509887</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.75960898</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.22794934</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">18</td>\n<td headers=\"n\" class=\"gt_row gt_right\">120</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.02666074</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.78626972</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.18373695</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">19</td>\n<td headers=\"n\" class=\"gt_row gt_right\">193</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04287936</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.82914908</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.13708065</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">20</td>\n<td headers=\"n\" class=\"gt_row gt_right\">190</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04221284</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.87136192</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.11952899</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"n\" class=\"gt_row gt_right\">579</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.12863808</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">1.00000000</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.04687847</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nFinally, one can plot the log of the inverse of the relative cumulative distribution function against the log of the income groups:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nparetotable %>% \n  ggplot()+\n  aes(x = log(inc), y = log(rev(cumrelfreq)))+\n  geom_point()+\n  geom_smooth(method = \"lm\")+\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](technical-note-piketty-2021_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\nWe can see that the line does not fit the data very well. As explained by [Milanovic](https://glineq.blogspot.com/2015/02/what-remains-of-pareto.html?m=1), the Pareto line fits well only for the top of income distribution. In fact, the data on personal income distribution that Pareto had only collected income data of the very rich. If he had data covering more than the top 1 percent, he would have probably made similar graphs as here and as in Milanovic's blog post.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}