{
  "hash": "61b9d6cbca06e02e87e8aadecaeaab09",
  "result": {
    "markdown": "---\ntitle: \"Notes on the methodology of the WPID\"\nformat: html\neditor: visual\nimage: plot.png\n---\n\n::: {.cell}\n\n:::\n\n\n## How far can we go with income brackets?\n\nTo build their database on [World political cleavages and inequality](https://wpid.world/), Piketty and his team had to use electoral survey data. One problem with these sources is that they collect income data through brackets, without reporting the overall income average of the sample or the average per bracket. This Thus poses the question of how far one can go in terms of statistical analysis with only income brackets as a source of information for income. I will here explore what can be done with such a variable as well as the [technical note](https://wid.world/document/building-the-world-political-cleavages-and-inequality-database-a-new-dataset-on-electoral-behaviors-in-50-democracies-1948-2020-world-inequality-lab-technical-note-2021-01/) that Piketty et al. (2021) provides to explain how they computed the vote share for income and education decile, which they claim is one of their main contributions on political cleavages and inequality.\n\n### A first look on the WPID dataset\n\nThe wpid is based on an impressive [dataset](https://wpid.world/resources/en/zip/wpid-micro.zip) compiling electoral survey data of 500 elections since 1948. Since the technical note takes Canada's 2015 election as an example, I will use the latter here.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nca <- read_dta(\"ca.dta\")\nca2015 <- ca %>% \n  filter(year == 2015)\nrm(ca)\n```\n:::\n\n\nNote that there is already something weird here: in the dataset, the variable income has 20 brackets/categories here whereas it has 18 in the technical note. Since this is not so much of an issue, I will still work with this dataset and we just won't have the same results as in Piketty & al's example.\n\nA first step in analyzing such a variable is to compute the frequency, relative frequency and the cumulative frequencies. Note that I only take the individuals who vote the the New Democratic Party (NDP) as in the technical note's example:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nca2015 %>% filter(votendp == 1) %>% \n  count(inc) %>% \n  drop_na() %>% \n  ungroup() %>% \n  mutate(\n    cum.n = cumsum(n),\n    prop = n/sum(n),\n    cumrelfreqN = cumsum(prop),\n    cumrelfreqInc = cumsum(inc/sum(inc))) -> table.income\n\ntable.income %>% \n  gt(caption = \"Distribution of income groups\")\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"lzyqohuimd\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#lzyqohuimd .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#lzyqohuimd .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lzyqohuimd .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#lzyqohuimd .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#lzyqohuimd .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#lzyqohuimd .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lzyqohuimd .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lzyqohuimd .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#lzyqohuimd .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#lzyqohuimd .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#lzyqohuimd .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#lzyqohuimd .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#lzyqohuimd .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#lzyqohuimd .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#lzyqohuimd .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#lzyqohuimd .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#lzyqohuimd .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#lzyqohuimd .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lzyqohuimd .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#lzyqohuimd .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#lzyqohuimd .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lzyqohuimd .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#lzyqohuimd .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#lzyqohuimd .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lzyqohuimd .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lzyqohuimd .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#lzyqohuimd .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#lzyqohuimd .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lzyqohuimd .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lzyqohuimd .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lzyqohuimd .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lzyqohuimd .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lzyqohuimd .gt_left {\n  text-align: left;\n}\n\n#lzyqohuimd .gt_center {\n  text-align: center;\n}\n\n#lzyqohuimd .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#lzyqohuimd .gt_font_normal {\n  font-weight: normal;\n}\n\n#lzyqohuimd .gt_font_bold {\n  font-weight: bold;\n}\n\n#lzyqohuimd .gt_font_italic {\n  font-style: italic;\n}\n\n#lzyqohuimd .gt_super {\n  font-size: 65%;\n}\n\n#lzyqohuimd .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#lzyqohuimd .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#lzyqohuimd .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#lzyqohuimd .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#lzyqohuimd .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#lzyqohuimd .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#lzyqohuimd .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  <caption>Distribution of income groups</caption>\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"inc\">inc</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cum.n\">cum.n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"prop\">prop</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cumrelfreqN\">cumrelfreqN</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cumrelfreqInc\">cumrelfreqInc</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">53</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">53</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07230559</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.07230559</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.004975124</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">2</td>\n<td headers=\"n\" class=\"gt_row gt_right\">56</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">109</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07639836</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.14870396</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.014925373</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">3</td>\n<td headers=\"n\" class=\"gt_row gt_right\">15</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">124</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.02046385</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.16916780</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.029850746</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">4</td>\n<td headers=\"n\" class=\"gt_row gt_right\">35</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">159</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04774898</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.21691678</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.049751244</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">5</td>\n<td headers=\"n\" class=\"gt_row gt_right\">53</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">212</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07230559</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.28922237</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.074626866</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">6</td>\n<td headers=\"n\" class=\"gt_row gt_right\">47</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">259</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.06412005</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.35334243</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.104477612</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">7</td>\n<td headers=\"n\" class=\"gt_row gt_right\">44</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">303</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.06002729</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.41336971</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.139303483</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">8</td>\n<td headers=\"n\" class=\"gt_row gt_right\">71</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">374</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.09686221</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.51023192</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.179104478</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">10</td>\n<td headers=\"n\" class=\"gt_row gt_right\">34</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">408</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04638472</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.55661664</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.228855721</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">11</td>\n<td headers=\"n\" class=\"gt_row gt_right\">35</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">443</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04774898</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.60436562</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.283582090</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">12</td>\n<td headers=\"n\" class=\"gt_row gt_right\">50</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">493</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.06821282</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.67257844</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.343283582</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">13</td>\n<td headers=\"n\" class=\"gt_row gt_right\">28</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">521</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.03819918</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.71077763</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.407960199</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">14</td>\n<td headers=\"n\" class=\"gt_row gt_right\">56</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">577</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07639836</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.78717599</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.477611940</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">15</td>\n<td headers=\"n\" class=\"gt_row gt_right\">19</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">596</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.02592087</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.81309686</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.552238806</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">16</td>\n<td headers=\"n\" class=\"gt_row gt_right\">26</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">622</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.03547067</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.84856753</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.631840796</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">17</td>\n<td headers=\"n\" class=\"gt_row gt_right\">35</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">657</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04774898</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.89631651</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.716417910</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">18</td>\n<td headers=\"n\" class=\"gt_row gt_right\">23</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">680</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.03137790</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.92769441</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.805970149</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">19</td>\n<td headers=\"n\" class=\"gt_row gt_right\">32</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">712</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04365621</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">0.97135061</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">0.900497512</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">20</td>\n<td headers=\"n\" class=\"gt_row gt_right\">21</td>\n<td headers=\"cum.n\" class=\"gt_row gt_right\">733</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.02864939</td>\n<td headers=\"cumrelfreqN\" class=\"gt_row gt_right\">1.00000000</td>\n<td headers=\"cumrelfreqInc\" class=\"gt_row gt_right\">1.000000000</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nWe can then plot income groups against their proportion\n\n\n::: {.cell .fig-cap-location-top}\n\n```{.r .cell-code}\ntable.income %>% \n  ggplot()+\n  aes(x = factor(inc), y = prop)+\n  geom_col()+\n  theme_bw()+\n  xlab(\"Income group\") -> income.group.plot\n\nincome.group.plot\n```\n\n::: {.cell-output-display}\n![Distribution of Income groups: Canadian 2015 election survey](technical-note-piketty-2021_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nIf we plot the income group against the relative cumulative frequency, we obtain the cumulative distribution of income groups. The cumulative distribution can also be directly plotted with plot(ecdf()):\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable.income %>% \n  ggplot()+\n  aes(x = factor(inc), y = cumrelfreqN)+\n  geom_point()+\n  theme_bw()+\n  xlab(\"Income group\")+\n  labs(title = \"Cumulative distribution of Income group: 2015 Canadian election survey\")\n```\n\n::: {.cell-output-display}\n![](technical-note-piketty-2021_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nIf we plot this relative cumulative distribution of observation against the one for income, we get the Lorenz curve:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable.income %>% \n  ggplot()+\n  aes(x = cumrelfreqN, y = cumrelfreqInc)+\n  geom_point()+\n  geom_line()+\n  geom_abline(intercept = 0, slope = 1, color = \"blue\")+\n  theme_bw()+\n  labs(\"Lorenz curve\")\n```\n\n::: {.cell-output-display}\n![](technical-note-piketty-2021_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nWhat makes Piketty's team approach special and interesting is their systematic analysis in terms of quantile groups. This is, according to them, their main contribution and this approach has the advantage to allow for systematic comparison accross space and time. We will try to reproduce here their conversion of income group into quantiles.\n\nIn R, the decile for each observation can be added to the dataset with the function ntile():\n\n\n::: {.cell}\n\n```{.r .cell-code}\nca2015 <- ca2015 %>% \n  mutate(\n  decile = ntile(inc, 10)\n)\n```\n:::\n\n\nNow, the last column of ca2015 is the decile for each observation in the dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nca2015 %>% filter(votendp == 1) %>% \n  group_by(decile) %>% \n  count(votendp) %>% \n  drop_na() %>% \n  ungroup() %>% \n  mutate(prop = n/sum(n),\n         cumsumprop = cumsum(prop)) -> table.income.vote\n\ntable.income.vote %>% gt(caption = \"Proportion of vote for the NDP per income decile\")\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"unltzwltkv\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#unltzwltkv .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#unltzwltkv .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#unltzwltkv .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#unltzwltkv .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#unltzwltkv .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#unltzwltkv .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#unltzwltkv .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#unltzwltkv .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#unltzwltkv .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#unltzwltkv .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#unltzwltkv .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#unltzwltkv .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#unltzwltkv .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#unltzwltkv .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#unltzwltkv .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#unltzwltkv .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#unltzwltkv .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#unltzwltkv .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#unltzwltkv .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#unltzwltkv .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#unltzwltkv .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#unltzwltkv .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#unltzwltkv .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#unltzwltkv .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#unltzwltkv .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#unltzwltkv .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#unltzwltkv .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#unltzwltkv .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#unltzwltkv .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#unltzwltkv .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#unltzwltkv .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#unltzwltkv .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#unltzwltkv .gt_left {\n  text-align: left;\n}\n\n#unltzwltkv .gt_center {\n  text-align: center;\n}\n\n#unltzwltkv .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#unltzwltkv .gt_font_normal {\n  font-weight: normal;\n}\n\n#unltzwltkv .gt_font_bold {\n  font-weight: bold;\n}\n\n#unltzwltkv .gt_font_italic {\n  font-style: italic;\n}\n\n#unltzwltkv .gt_super {\n  font-size: 65%;\n}\n\n#unltzwltkv .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#unltzwltkv .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#unltzwltkv .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#unltzwltkv .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#unltzwltkv .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#unltzwltkv .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#unltzwltkv .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  <caption>Proportion of vote for the NDP per income decile</caption>\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"decile\">decile</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"votendp\">votendp</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"prop\">prop</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cumsumprop\">cumsumprop</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"decile\" class=\"gt_row gt_right\">1</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">76</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.10368349</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.1036835</td></tr>\n    <tr><td headers=\"decile\" class=\"gt_row gt_right\">2</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">70</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.09549795</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.1991814</td></tr>\n    <tr><td headers=\"decile\" class=\"gt_row gt_right\">3</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">106</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.14461119</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.3437926</td></tr>\n    <tr><td headers=\"decile\" class=\"gt_row gt_right\">4</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">81</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.11050477</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.4542974</td></tr>\n    <tr><td headers=\"decile\" class=\"gt_row gt_right\">5</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">57</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07776262</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.5320600</td></tr>\n    <tr><td headers=\"decile\" class=\"gt_row gt_right\">6</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">88</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.12005457</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.6521146</td></tr>\n    <tr><td headers=\"decile\" class=\"gt_row gt_right\">7</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">70</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.09549795</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.7476126</td></tr>\n    <tr><td headers=\"decile\" class=\"gt_row gt_right\">8</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">67</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.09140518</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.8390177</td></tr>\n    <tr><td headers=\"decile\" class=\"gt_row gt_right\">9</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">63</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.08594816</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">0.9249659</td></tr>\n    <tr><td headers=\"decile\" class=\"gt_row gt_right\">10</td>\n<td headers=\"votendp\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">55</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07503411</td>\n<td headers=\"cumsumprop\" class=\"gt_row gt_right\">1.0000000</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n::: {.cell .fig-cap-location-top}\n\n```{.r .cell-code}\ntable.income.vote %>% \n  ggplot()+\n  aes(x = factor(decile), y = prop)+\n  geom_col()+\n  theme_bw()+\n  xlab(\"decile\") +\n  ylab(\"\")-> decile.plot\n\ncowplot::plot_grid(income.group.plot, decile.plot)\n```\n\n::: {.cell-output-display}\n![Proportion of NDP voters per income groups (left) and decile (right)](technical-note-piketty-2021_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nThe figure here tried to reproduce figure 1 of Piketty & al.'s technical note. This not the exact same graph because the income variable in the technical note has 18 brackets whereas it has 20 here. But the result, if the methodology employed here is correct, is pretty much the same.\n\nFinally, one can also try to fit a \"Pareto line\" to the income bracket data. Vilfredo Pareto (1848-1923) is well-known for being one of the first economist to have computed inequality indices (his famous alpha coefficient) directly from personal income distribution data. His relationship $log(N) = A-\\alpha log(x)$, with N the number of people earning more than income level x, is a famous relationship and almost every course on income inequality measurement starts with it.\n\nFirst, a table need to be constructed from the data, we count the number of observation per income bracket and compute the inverse of the cumulative relative frequencies, which is the same as N is Pareto's equation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nca2015 %>% \n  count(inc) %>% \n  mutate(prop = n/sum(n),\n         cumrelfreq = cumsum(prop),\n         inverse_rcdf = rev(cumrelfreq)) -> paretotable\n\nparetotable %>% \n  gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"orwikpjhlo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#orwikpjhlo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#orwikpjhlo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#orwikpjhlo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#orwikpjhlo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#orwikpjhlo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#orwikpjhlo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#orwikpjhlo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#orwikpjhlo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#orwikpjhlo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#orwikpjhlo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#orwikpjhlo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#orwikpjhlo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#orwikpjhlo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#orwikpjhlo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#orwikpjhlo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#orwikpjhlo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#orwikpjhlo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#orwikpjhlo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#orwikpjhlo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#orwikpjhlo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#orwikpjhlo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#orwikpjhlo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#orwikpjhlo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#orwikpjhlo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#orwikpjhlo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#orwikpjhlo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#orwikpjhlo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#orwikpjhlo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#orwikpjhlo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#orwikpjhlo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#orwikpjhlo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#orwikpjhlo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#orwikpjhlo .gt_left {\n  text-align: left;\n}\n\n#orwikpjhlo .gt_center {\n  text-align: center;\n}\n\n#orwikpjhlo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#orwikpjhlo .gt_font_normal {\n  font-weight: normal;\n}\n\n#orwikpjhlo .gt_font_bold {\n  font-weight: bold;\n}\n\n#orwikpjhlo .gt_font_italic {\n  font-style: italic;\n}\n\n#orwikpjhlo .gt_super {\n  font-size: 65%;\n}\n\n#orwikpjhlo .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#orwikpjhlo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#orwikpjhlo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#orwikpjhlo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#orwikpjhlo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#orwikpjhlo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#orwikpjhlo .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"inc\">inc</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"prop\">prop</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cumrelfreq\">cumrelfreq</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"inverse_rcdf\">inverse_rcdf</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">1</td>\n<td headers=\"n\" class=\"gt_row gt_right\">211</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04687847</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.04687847</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">1.00000000</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">2</td>\n<td headers=\"n\" class=\"gt_row gt_right\">327</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.07265052</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.11952899</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.87136192</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">3</td>\n<td headers=\"n\" class=\"gt_row gt_right\">79</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.01755166</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.13708065</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.82914908</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">4</td>\n<td headers=\"n\" class=\"gt_row gt_right\">210</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04665630</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.18373695</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.78626972</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">5</td>\n<td headers=\"n\" class=\"gt_row gt_right\">199</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04421240</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.22794934</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.75960898</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">6</td>\n<td headers=\"n\" class=\"gt_row gt_right\">184</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04087980</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.26882915</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.70451011</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">7</td>\n<td headers=\"n\" class=\"gt_row gt_right\">188</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04176850</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.31059764</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.66985114</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">8</td>\n<td headers=\"n\" class=\"gt_row gt_right\">421</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.09353477</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.40413242</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.64185737</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">10</td>\n<td headers=\"n\" class=\"gt_row gt_right\">205</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04554543</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.44967785</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.57209509</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">11</td>\n<td headers=\"n\" class=\"gt_row gt_right\">166</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.03688069</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.48655854</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.53921351</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">12</td>\n<td headers=\"n\" class=\"gt_row gt_right\">237</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.05265497</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.53921351</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.48655854</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">13</td>\n<td headers=\"n\" class=\"gt_row gt_right\">148</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.03288158</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.57209509</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.44967785</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">14</td>\n<td headers=\"n\" class=\"gt_row gt_right\">314</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.06976228</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.64185737</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.40413242</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">15</td>\n<td headers=\"n\" class=\"gt_row gt_right\">126</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.02799378</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.66985114</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.31059764</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">16</td>\n<td headers=\"n\" class=\"gt_row gt_right\">156</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.03465896</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.70451011</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.26882915</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">17</td>\n<td headers=\"n\" class=\"gt_row gt_right\">248</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.05509887</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.75960898</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.22794934</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">18</td>\n<td headers=\"n\" class=\"gt_row gt_right\">120</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.02666074</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.78626972</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.18373695</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">19</td>\n<td headers=\"n\" class=\"gt_row gt_right\">193</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04287936</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.82914908</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.13708065</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">20</td>\n<td headers=\"n\" class=\"gt_row gt_right\">190</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.04221284</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">0.87136192</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.11952899</td></tr>\n    <tr><td headers=\"inc\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"n\" class=\"gt_row gt_right\">579</td>\n<td headers=\"prop\" class=\"gt_row gt_right\">0.12863808</td>\n<td headers=\"cumrelfreq\" class=\"gt_row gt_right\">1.00000000</td>\n<td headers=\"inverse_rcdf\" class=\"gt_row gt_right\">0.04687847</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nFinally, one can plot the log of the inverse of the relative cumulative distribution function against the log of the income groups:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nparetotable %>% \n  ggplot()+\n  aes(x = log(inc), y = log(rev(cumrelfreq)))+\n  geom_point()+\n  geom_smooth(method = \"lm\")+\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](technical-note-piketty-2021_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nWe can see that the line does not fit the data very well. As explained by [Milanovic](https://glineq.blogspot.com/2015/02/what-remains-of-pareto.html?m=1), the Pareto line fits well only for the top of income distribution. In fact, the data on personal income distribution that Pareto had only collected income data of the very rich. If he had data covering more than the top 1 percent, he would have probably made similar graphs as here and as in Milanovic's blog post.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}