{
  "hash": "b5f1a4eb27fff89f0b39c693d3722104",
  "result": {
    "markdown": "---\ntitle: \"Income, education and voting outcome: a cross-sectional analysis of voting outcome in Switzerland \"\nformat: html\neditor: visual\nbibliography: biblio.bib\nimage: image.png\nexecute: \n  freeze: true\n---\n\n\n## Note: this post is not finished and still in progress\n\nTwo years ago, Piketty and his team published a fascinating book about the evolution of political cleavages in almost all democratic countries in the world and even beyond. The publication of this book and of its [online database](https://wpid.world/resources/) got me very interested in the study of political cleavages from a political economy approach. This book contains huge amount of findings and observations, but there is one which is really emphasized by the authors: from roughly the 1980s until, the class-based political divide has become a multidimensional one incorporating a \"educational\" or, in Inglehart terms, a \"postmaterial\" or \"cultural\" cleavage [@gethin_political_2021] [@inglehart_silent_1971]. Very shortly, They found that the electoral support for the left shifted from the low income and low education classes to the highly educated ones. Regarding the electoral support for the right, the latter remains positively correlated with income.\n\nThis post is going to simply test this finding for Switzerland using the post-electoral survey for the National Council election in 2019. The following analysis is based on data analysis of the Swiss Election Study (Selects) of 2019. The dataset can be found [here](https://www.swissubase.ch/en/catalogue/studies/13846/18585/overview). I will test if the support for the left is linked positively with the education level and negatively with income.\n\n\n::: {.cell}\n\n:::\n\n\n\n\nTo analyze the link between vote for the left (dependent variable) and income and education, I create a dummy variable from the variable \"W1_f1085_90\" which asked for which party the respondent is going to vote for in the 2019 national council election. The indicator variable is equal to 1 if the respondent declared voting for the socialist party, the greens, the christian socialist party or for far left parties (swiss labour party, solidarités, ensemble à gauche...)\n\nRegarding the independ variables, the variable \"f28910\" asks the gross monthly houshold income of the individual and the variable has 15 income brackets (we thus do not have directly the income of the respondant). For education, \"f21310\" asks the highest level of achieved education. Here is below descriptive statistics for these variables:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Education level](select2019analysis_files/figure-html/unnamed-chunk-3-1.png){fig-pos='H' width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![Gross monthly houshold income](select2019analysis_files/figure-html/unnamed-chunk-4-1.png){fig-pos='H' width=672}\n:::\n:::\n\n\n## First model: binary logistic regression\n\nLet's first start with a logistic regression. I simply regress the vote for the left with income and education. I leave education and income coded as numerical variables for now, since they have enough categories this is not big problem. Of course, that would have been better if I had directly the income of each individual and not brackets. Moreover, I could still do a Pareto interpolation, but I can't due to lack of information: I don't have the average income (total and per bracket) of the sample.\n\nThe model is thus:\n\n$$\nLog(\\frac{P(left)}{1 - P(left)}) = \\beta_0 + \\beta_1income_i + \\beta_2educ_i + \\epsilon_i\n$$\n\nNote that this is a very first step, I will step by step complexify this model.\n\nHere is the regression table:\n\n\n\n<table style=\"text-align:center\"><tr><td colspan=\"2\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\"></td><td><em>Dependent variable:</em></td></tr>\n<tr><td></td><td colspan=\"1\" style=\"border-bottom: 1px solid black\"></td></tr>\n<tr><td style=\"text-align:left\"></td><td>vote_left</td></tr>\n<tr><td colspan=\"2\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\">income</td><td>-0.075<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.007)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td></tr>\n<tr><td style=\"text-align:left\">education</td><td>0.111<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.008)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td></tr>\n<tr><td style=\"text-align:left\">Constant</td><td>-1.033<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.075)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td></tr>\n<tr><td colspan=\"2\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\">Observations</td><td>6,866</td></tr>\n<tr><td style=\"text-align:left\">Log Likelihood</td><td>-4,342.283</td></tr>\n<tr><td style=\"text-align:left\">Akaike Inf. Crit.</td><td>8,690.566</td></tr>\n<tr><td colspan=\"2\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\"><em>Note:</em></td><td style=\"text-align:right\"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr>\n</table>\n\n\nHere is an odd ratios plot to have a better visualization of the coefficients:\n\n\n::: {.cell-output-display}\n![](select2019analysis_files/figure-html/unnamed-chunk-6-1.png){fig-pos='H' width=672}\n:::\n\n\nHere is what this coefficient plot tells: the odds that a Swiss voter vote for a left-wing party for the National Council election in 2019 are linked negatively with income (odd ratio below 1) and positively with education (odd ratio \\> 1). The coefficients are statistically significant at the one percent level, which is not a surprise because the sample is rather large.\n\nOdd ratios are known to be rather difficult to interpret. In effect, odd ratios are not what the literature calls \"quantity of interest\", that is to say, the quantity of the dependent variable which is the most easy to interpret. I this model, the quantity of interest is the probability to vote for a left wing party and not the odds. A lot of economists and social scientists prefer to have a look directly at the marginal effects and predicted probability to have a better view of the relationships between the variables and of the quantity of interest.\n\nI first plot simple graphs of the estimated curves. To do so, I use the function Invlogit from the plot3logit package and put the estimated coefficient into this function. To do such graphs, one has to make the explanatory variable on the x axis to vary while the other explanatory variables are held constant. A choice has thus to be made about which fixed value of the other factors (of Income for the education level plot and conversely), I decided to choose the median value.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Probability of voting for the left - curves from estimated coefficients](select2019analysis_files/figure-html/unnamed-chunk-7-1.png){fig-pos='H' width=672}\n:::\n:::\n\n\nWe can see that the slope of the education level curve is steeper than the one for income: this means that the positive link between the level of education and the probability to vote for the left is greater than the negative one for income. But let's have a look directly at the marginal effects.\n\nThere are a lot of different ways to compute marginal effects, which make the latter sometimes confusing because we don't know which type of marginal effects we are talking about. I will here consider one type of marginal effects:\n\n-   Group-average marginal effects: slope estimates are produced for each row of the dataset used in computing the model. Then, the estimates can be grouped by the values of one of the regressor and the average for each group is computed.\n\nA first step in group-average marginal effects in R is to use the function \"slopes\" which calculate estimates of the slopes (marginal effects) for each observation used to compute the model in the first place. The term \"variables\" is for the variable for which the slopes are estimated and \"by\" the argument for\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmarginaleffectseduc <- slopes(reg, variables = \"education\")\nhead(marginaleffectseduc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n      Term Estimate Std. Error    z Pr(>|z|)  2.5 % 97.5 %\n education   0.0216    0.00156 13.9   <0.001 0.0186 0.0247\n education   0.0277    0.00212 13.1   <0.001 0.0236 0.0319\n education   0.0253    0.00204 12.4   <0.001 0.0213 0.0293\n education   0.0261    0.00212 12.3   <0.001 0.0219 0.0303\n education   0.0266    0.00202 13.2   <0.001 0.0226 0.0306\n education   0.0220    0.00165 13.3   <0.001 0.0188 0.0252\n\nColumns: rowid, term, estimate, std.error, statistic, p.value, conf.low, conf.high, predicted, predicted_hi, predicted_lo, vote_left, income, education \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndim(marginaleffectseduc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 6866   14\n```\n:::\n:::\n\n\nThe dataframe has 5607 rows which is the same number of observation used in the model. We can then used the different values of income level (from 1 to 15) as grouped within which estimates are averaged:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmarginaleffectseduc %>% \n  group_by(income) %>% \n  summarise(mean.slopes.educ = mean(estimate),\n            conf.high = mean(conf.high), ## this is the same for the confidence interval\n            conf.low = mean(conf.low)) %>% \n  ungroup() -> game.educ\nhead(game.educ)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n  income                  mean.slopes.educ conf.high conf.low\n  <dbl+lbl>                          <dbl>     <dbl>    <dbl>\n1 1 [Less than 2'000 CHF]           0.0262    0.0299   0.0225\n2 2 [2'001-3'000 CHF]               0.0258    0.0294   0.0221\n3 3 [3'001-4'000 CHF]               0.0255    0.0290   0.0219\n4 4 [4'001-5'000 CHF]               0.0251    0.0286   0.0216\n5 5 [5'001-6'000 CHF]               0.0250    0.0285   0.0215\n6 6 [6'001-7'000 CHF]               0.0250    0.0285   0.0214\n```\n:::\n:::\n\n\nA plot can then be made to have a better view of the average marginal effects/slopes of education for each group of income:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngame.educ %>% \n  ggplot()+\n  aes(x = income, y = mean.slopes.educ)+\n  geom_point()+\n  geom_line()+\n  geom_ribbon(aes(ymin = conf.low, ymax = conf.high), alpha = 0.5)+\n  theme_bw()+\n  labs(title = \"Group-average marginal effect of education for each level of income group\")+\n  ylab(\"Slopes education\")\n```\n\n::: {.cell-output-display}\n![](select2019analysis_files/figure-html/unnamed-chunk-11-1.png){fig-pos='H' width=672}\n:::\n:::\n\n\nThe slope of education level decreases on average with higher values of income group. This means that even if the probability to vote for the left is linked positively with education level, this link is weaker for higher income groups. However, it is not so much weaker because even though th line is downward slopping, it remains rather flat.\n\nNormally, the function plot_slope should produce the same graph:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_slopes(reg, variables = \"education\", by = \"income\")\n```\n\n::: {.cell-output-display}\n![](select2019analysis_files/figure-html/unnamed-chunk-12-1.png){fig-pos='H' width=672}\n:::\n:::\n\n\nLet's do the same for income:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmarginaleffectsinc <- slopes(reg, variables = \"income\")\ngame.inc <- marginaleffectsinc %>% \n  group_by(education) %>% \n  summarise(mean.slopes.inc = mean(estimate),\n            conf.high = mean(conf.high),\n            conf.low = mean(conf.low)) %>% \n  ungroup() -> game.inc\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngame.inc %>% \n  ggplot()+\n  aes(x = education, y = mean.slopes.inc)+\n  geom_point()+\n  geom_line()+\n  geom_ribbon(aes(ymin = conf.low, ymax = conf.high), alpha = 0.5)+\n  theme_bw()+\n  labs(title = \"Group-average marginal effects of income for each level of education\")+\n  ylab(\"Slopes income\")\n```\n\n::: {.cell-output-display}\n![](select2019analysis_files/figure-html/unnamed-chunk-14-1.png){fig-pos='H' width=672}\n:::\n:::\n\n\nHere the result is more interesting: the average marginal slope of income is negative for each education level but this average decreases with higher level of education. This implies that the probability to vote for the left is linked negatively with income group and that this negative link is strengthened by higher level of education. Rich and highly educated people have thus a very low probability to vote for the left.\n\nAnother way to look at the effect of the two independent variable on the probability to vote for the left is to look at the predictions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npredictionseduc <- predictions(reg, variables = c(\"education\", \"income\"))\npredictionseduc <- predictions(reg, by = c(\"education\", \"income\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_predictions(reg, condition = c(\"education\", \"income\"))+\n  scale_color_brewer(palette = \"Set1\")+\n  scale_fill_brewer(palette = \"Set1\")+\n  theme_bw()+\n  theme(legend.position = c(0.5, 0.7),\n        legend.background = element_blank())+\n  ylab(\"probability vote left\") -> plotpredicteduc\n\nplot_predictions(reg, condition = c(\"income\", \"education\"))+\n  scale_color_brewer(palette = \"Set1\")+\n  scale_fill_brewer(palette = \"Set1\")+\n  theme_bw()+\n  theme(legend.position = c(0.8, 0.8),\n        legend.background = element_blank())+\n  ylab(\"\") -> plotpredictincome\n\ncowplot::plot_grid(plotpredicteduc, plotpredictincome)\n```\n\n::: {.cell-output-display}\n![](select2019analysis_files/figure-html/unnamed-chunk-16-1.png){fig-pos='H' width=672}\n:::\n:::\n\n\nThose plots are essentially the same the first one, but with the confidence interval and for different values of the regressor considered fixed for certain values.\n\nAnother way is to compute directly the average marginal effects without grouping:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmarginaleffectsinc <- slopes(reg, variables = \"income\")\nmarginaleffectseduc <- slopes(reg, variables = \"education\")\navg_effect_summary_reg <- rbind(summary(marginaleffectsinc), summary(marginaleffectseduc))\n\navg_effect_summary_reg\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n      Term    Contrast Estimate Std. Error     z Pr(>|z|)   2.5 %  97.5 %\n income    mean(dY/dX)  -0.0167    0.00150 -11.1   <0.001 -0.0196 -0.0137\n education mean(dY/dX)   0.0245    0.00177  13.9   <0.001  0.0210  0.0279\n\nColumns: term, contrast, estimate, std.error, statistic, p.value, conf.low, conf.high \n```\n:::\n:::\n\n\nHere is a nice way to visualize the table above:\n\n\n::: {.cell}\n\n```{.r .cell-code}\navg_effect_summary_reg %>% \n  ggplot()+\n  aes(x = estimate*100, y = term)+\n  geom_vline(xintercept = 0, color = \"red\")+\n  geom_pointrange(aes(xmin = conf.low*100, xmax = conf.high*100))+\n  theme_bw()+\n  xlab(\"Average marginal effects (percentage points)\")+\n  ylab(\"\")+\n  geom_label(aes(label = round(estimate*100, 3)), nudge_y = 0.15)\n```\n\n::: {.cell-output-display}\n![](select2019analysis_files/figure-html/unnamed-chunk-18-1.png){fig-pos='H' width=672}\n:::\n:::\n\n\nThe advantage of average marginal effects is the fact that they give information on the quantity of interest (here the probability to vote for the left) instead of odd ratio or log odds. The probability to vote for the left decreases on average by -1.6 percentage points if we compare two units which only differs by one income group level. Conversely, the probability increases on average by 2.5 percentage points if we compare two units which only differs by one level of education.\n\n## Complexifying the model\n\n### Hierarchical model\n\nOne possible and interesting way to complexify the model is to include the different Swiss canton into the regression. In fact, the previous regression model can be considered as a \"complete pooling\" model in which I made the asumption that the slopes of the coefficients do not vary by cantons. However, cantons represents an important level of analysis in Switzerland, because elections and politics are a lot structures at the cantonal level. Cantons can thus be considered as levels in which the observed individuals in our sample are grouped.\n\nAccording to @gelman_data_2007 there are two main differents ways to consider these groups in regression analysis:\n\n1.  No pooling models: the slopes and/or the intercepts are allowed to vary across the groups freely.\n\n2.  Partial pooling models: the slopes and/or the intercepts are allowed to vary, but they are modeled (we consider that they follow a normal distribution)\n\nIn the present analysis, I will consider a partial pooling model in which the slopes and intercepts for income and education can vary. In R, partial pooling models can be estimated with the function lmer() from the lme4 package.\n\n\n\n\n\nThe results of this model can be then represented through a table with tab_model()\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab_model(glmer1, transform = NULL, title = \"Partial Pooling model\", digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<caption style=\"font-weight: bold; text-align:left;\">Partial Pooling model</caption>\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">vote_left</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Log-Odds</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.088</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.382&nbsp;&ndash;&nbsp;-0.793</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Gross monthly household<br>income, W1 updated with<br>W4</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.076</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.095&nbsp;&ndash;&nbsp;-0.058</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">education</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.106</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.087&nbsp;&ndash;&nbsp;0.126</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td colspan=\"4\" style=\"font-weight:bold; text-align:left; padding-top:.8em;\">Random Effects</td>\n</tr>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&sigma;<sup>2</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">3.29</td>\n</tr>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>00</sub> <sub>region</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.33</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>11</sub> <sub>region.education</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.00</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>11</sub> <sub>region.income</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.00</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&rho;<sub>01</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">-0.82</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">-0.61</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">N <sub>region</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">26</td>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">6866</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.041 / NA</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\nThe random effects coefficients at the cantons level for income and education are 0, which implies that there is very low variation between cantons. Furthermore, the fixed effect coefficients are almost the same than the previous model: this new model is thus not a big improvement and shows that including cantons as a group does not change the model a lot.\n\nHowever, it is still interesting to plot predicted probabilities to have a better overview:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_predictions(glmer1, condition = c(\"education\", \"income\", \"region\"))+facet_wrap(~region)+\n  aes(linetype = income)+\n  scale_colour_brewer(palette = \"Set1\")+\n  labs(title = \"Probabilités prédites selon le niveau d'éducation, pour chaque canton et pour différent niveau de revenu\",\n       subtitle = \"Election Conseil National 2015\")+\n  geom_hline(yintercept = 0.5, alpha = 0.8)\n```\n\n::: {.cell-output-display}\n![](select2019analysis_files/figure-html/unnamed-chunk-21-1.png){fig-pos='H' width=960}\n:::\n:::\n\n\nThe relationship between the predicted probabilities to vote for the left and education is positive for every cantons. There are a lot of cantons that show similar relationships and curves and whose predicted probabilities, despite the positive link with education, do not go above 0.5 (with some exception such as Aargau, Thurgau, Tessin, Valais, Glarus...). The cantons which show different patterns are Basel-Stadt, Geneva, Jura, Vaud and Neuchâtel with higher predicted probabilities.\n\n### Adding control variables\n\nLet's now add some control variables to the model. The models above are flawed by the fact that there are only two regressors. One important assumption of regression models are the mean independence of the covariates with the error term. The model is assumed to include all the important explanatory variables in the model. If not, the estimates will be biased, so one can suspect that the coefficients estimates for this first model are heavily biased.\n\nFor the second model, I include gender (dummy with female = 1), age (in categories), religiosity (the higher, the less religious is the respondent), a variable indicating whether the respondent has a full-time job (full_time), whether the respondent works in the public sector (public) and marital status. I a third model which include variables on issue position related to socio-economic issues such as EU integration, taxation and attitude towards foreigners (each one of these variables are ordinal on a 1-5 scale). I also run the same final model for the other parties as dependent variables.\n\n\n\n```{.r .cell-code}\nreg2 <- glm(data = datareg, vote_left ~ education + income + age + nonreligious  + as_label(work_situation) + public + married + gender, family=binomial(link=\"logit\"))\n\nreg3 <- glm(data = datareg, vote_left ~ education + income + age + nonreligious + as_label(work_situation) + public + married + gender + against_immigr_limit + against_eu_membership + state_or_freemarket, family=binomial(link=\"logit\"))\n\nregudc <- glm(data = datareg, vote_udc ~ education + income + age + nonreligious + as_label(work_situation) + public + married + gender + against_immigr_limit + against_eu_membership + state_or_freemarket, family=binomial(link=\"logit\"))\n\nregcd <- glm(data = datareg, vote_christ_dem ~ education + income + age + nonreligious + as_label(work_situation) + public + married + gender + against_immigr_limit + against_eu_membership + state_or_freemarket, family=binomial(link=\"logit\"))\n\nregplr <- glm(data = datareg, vote_plr ~ education + income + age + nonreligious + as_label(work_situation) + public + married + gender + against_immigr_limit + against_eu_membership + state_or_freemarket, family=binomial(link=\"logit\"))\n\nreggreen <- glm(data = datareg, vote_greens ~ education + income + age + nonreligious + as_label(work_situation) + public + married + gender + against_immigr_limit + against_eu_membership + state_or_freemarket, family=binomial(link=\"logit\"))\n\nreggreenlib <- glm(data = datareg, vote_greens_lib ~ education + income + age + nonreligious + as_label(work_situation) + public + married + gender + against_immigr_limit + against_eu_membership + state_or_freemarket, family=binomial(link=\"logit\"))\n```\n\n\n```{.r .cell-code}\nstargazer(reg, reg2, reg3, regudc, regcd, regplr, reggreen, reggreenlib, type = \"html\", title = \"Vote for political parties: log(odds)\")\n```\n\n\n<table style=\"text-align:center\"><caption><strong>Vote for political parties: log(odds)</strong></caption>\n<tr><td colspan=\"9\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\"></td><td colspan=\"8\"><em>Dependent variable:</em></td></tr>\n<tr><td></td><td colspan=\"8\" style=\"border-bottom: 1px solid black\"></td></tr>\n<tr><td style=\"text-align:left\"></td><td colspan=\"3\">vote_left</td><td>vote_udc</td><td>vote_christ_dem</td><td>vote_plr</td><td>vote_greens</td><td>vote_greens_lib</td></tr>\n<tr><td style=\"text-align:left\"></td><td>(1)</td><td>(2)</td><td>(3)</td><td>(4)</td><td>(5)</td><td>(6)</td><td>(7)</td><td>(8)</td></tr>\n<tr><td colspan=\"9\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\">income</td><td>-0.075<sup>***</sup></td><td>-0.046<sup>***</sup></td><td>-0.047<sup>***</sup></td><td>-0.046<sup>***</sup></td><td>-0.009</td><td>0.073<sup>***</sup></td><td>-0.024</td><td>0.055<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.007)</td><td>(0.010)</td><td>(0.011)</td><td>(0.014)</td><td>(0.014)</td><td>(0.011)</td><td>(0.015)</td><td>(0.014)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">age</td><td></td><td>0.067<sup>**</sup></td><td>0.037</td><td>-0.034</td><td>0.002</td><td>0.010</td><td>0.020</td><td>0.024</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td>(0.032)</td><td>(0.038)</td><td>(0.043)</td><td>(0.048)</td><td>(0.040)</td><td>(0.050)</td><td>(0.050)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">nonreligious</td><td></td><td>0.124<sup>***</sup></td><td>0.161<sup>***</sup></td><td>0.085<sup>***</sup></td><td>-0.299<sup>***</sup></td><td>0.101<sup>***</sup></td><td>0.108<sup>***</sup></td><td>0.195<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td>(0.024)</td><td>(0.027)</td><td>(0.032)</td><td>(0.031)</td><td>(0.029)</td><td>(0.036)</td><td>(0.039)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">as_label(work_situation)Part time (5-39 hrs per week)</td><td></td><td>0.342<sup>***</sup></td><td>0.237<sup>**</sup></td><td>-0.284<sup>**</sup></td><td>-0.174</td><td>-0.147</td><td>0.191</td><td>0.385<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td>(0.096)</td><td>(0.110)</td><td>(0.136)</td><td>(0.142)</td><td>(0.121)</td><td>(0.140)</td><td>(0.140)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">as_label(work_situation)In training (apprentice, student)</td><td></td><td>0.702<sup>***</sup></td><td>0.380<sup>**</sup></td><td>-0.703<sup>***</sup></td><td>-0.091</td><td>0.231</td><td>-0.048</td><td>0.446<sup>*</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td>(0.167)</td><td>(0.193)</td><td>(0.242)</td><td>(0.253)</td><td>(0.210)</td><td>(0.262)</td><td>(0.246)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">as_label(work_situation)Homemaker</td><td></td><td>0.006</td><td>-0.008</td><td>-0.415<sup>*</sup></td><td>0.182</td><td>0.348<sup>*</sup></td><td>0.015</td><td>-0.038</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td>(0.195)</td><td>(0.218)</td><td>(0.241)</td><td>(0.240)</td><td>(0.209)</td><td>(0.297)</td><td>(0.322)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">as_label(work_situation)Retired (AHV)</td><td></td><td>0.328<sup>**</sup></td><td>0.329<sup>**</sup></td><td>-0.596<sup>***</sup></td><td>-0.212</td><td>0.434<sup>***</sup></td><td>0.001</td><td>0.037</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td>(0.130)</td><td>(0.148)</td><td>(0.170)</td><td>(0.185)</td><td>(0.148)</td><td>(0.201)</td><td>(0.195)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">as_label(work_situation)Person receiving invalidity insurance or other benefits</td><td></td><td>0.419</td><td>0.398</td><td>-0.174</td><td>-0.702</td><td>0.211</td><td>-0.478</td><td>0.040</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td>(0.278)</td><td>(0.316)</td><td>(0.358)</td><td>(0.534)</td><td>(0.328)</td><td>(0.547)</td><td>(0.451)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">as_label(work_situation)Unemployed</td><td></td><td>0.988<sup>***</sup></td><td>0.690<sup>*</sup></td><td>-0.252</td><td>-0.382</td><td>-0.170</td><td>0.624</td><td>-0.668</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td>(0.335)</td><td>(0.386)</td><td>(0.480)</td><td>(0.616)</td><td>(0.467)</td><td>(0.454)</td><td>(0.736)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">as_label(work_situation)Other (e.g., further training, sabbatical)</td><td></td><td>0.817<sup>***</sup></td><td>0.658<sup>**</sup></td><td>0.015</td><td>-0.621</td><td>-0.710</td><td>0.218</td><td>0.032</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td>(0.251)</td><td>(0.293)</td><td>(0.370)</td><td>(0.481)</td><td>(0.443)</td><td>(0.370)</td><td>(0.446)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">public</td><td></td><td>0.599<sup>***</sup></td><td>0.419<sup>***</sup></td><td>-0.210</td><td>0.200</td><td>-0.372<sup>***</sup></td><td>0.137</td><td>-0.075</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td>(0.091)</td><td>(0.104)</td><td>(0.134)</td><td>(0.132)</td><td>(0.124)</td><td>(0.131)</td><td>(0.138)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">married</td><td></td><td>-0.140<sup>*</sup></td><td>-0.116</td><td>-0.013</td><td>0.138</td><td>0.063</td><td>0.073</td><td>-0.129</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td>(0.080)</td><td>(0.091)</td><td>(0.107)</td><td>(0.119)</td><td>(0.097)</td><td>(0.122)</td><td>(0.122)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">gender</td><td></td><td>0.411<sup>***</sup></td><td>0.303<sup>***</sup></td><td>-0.259<sup>**</sup></td><td>0.035</td><td>-0.017</td><td>0.308<sup>***</sup></td><td>-0.135</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td>(0.076)</td><td>(0.087)</td><td>(0.106)</td><td>(0.114)</td><td>(0.092)</td><td>(0.116)</td><td>(0.116)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">against_immigr_limit</td><td></td><td></td><td>0.568<sup>***</sup></td><td>-0.996<sup>***</sup></td><td>0.025</td><td>-0.141<sup>***</sup></td><td>0.317<sup>***</sup></td><td>0.227<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td>(0.036)</td><td>(0.057)</td><td>(0.046)</td><td>(0.039)</td><td>(0.047)</td><td>(0.047)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">against_eu_membership</td><td></td><td></td><td>-0.368<sup>***</sup></td><td>0.729<sup>***</sup></td><td>0.077</td><td>-0.026</td><td>-0.112<sup>**</sup></td><td>-0.114<sup>**</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td>(0.038)</td><td>(0.061)</td><td>(0.051)</td><td>(0.042)</td><td>(0.050)</td><td>(0.051)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">state_or_freemarket</td><td></td><td></td><td>-0.603<sup>***</sup></td><td>0.154<sup>***</sup></td><td>-0.024</td><td>0.533<sup>***</sup></td><td>-0.539<sup>***</sup></td><td>0.177<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td>(0.040)</td><td>(0.048)</td><td>(0.051)</td><td>(0.045)</td><td>(0.052)</td><td>(0.054)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">education</td><td>0.111<sup>***</sup></td><td>0.094<sup>***</sup></td><td>0.028<sup>**</sup></td><td>-0.114<sup>***</sup></td><td>-0.020</td><td>0.047<sup>***</sup></td><td>0.081<sup>***</sup></td><td>0.036<sup>**</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.008)</td><td>(0.011)</td><td>(0.013)</td><td>(0.016)</td><td>(0.016)</td><td>(0.014)</td><td>(0.018)</td><td>(0.017)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">Constant</td><td>-1.033<sup>***</sup></td><td>-2.705<sup>***</sup></td><td>-0.337</td><td>-1.582<sup>***</sup></td><td>-0.761<sup>*</sup></td><td>-4.385<sup>***</sup></td><td>-2.411<sup>***</sup></td><td>-4.760<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.075)</td><td>(0.216)</td><td>(0.342)</td><td>(0.446)</td><td>(0.435)</td><td>(0.380)</td><td>(0.467)</td><td>(0.481)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td colspan=\"9\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\">Observations</td><td>6,866</td><td>4,534</td><td>4,434</td><td>4,434</td><td>4,434</td><td>4,434</td><td>4,434</td><td>4,434</td></tr>\n<tr><td style=\"text-align:left\">Log Likelihood</td><td>-4,342.283</td><td>-2,634.018</td><td>-2,119.472</td><td>-1,560.840</td><td>-1,507.845</td><td>-2,027.539</td><td>-1,346.769</td><td>-1,390.188</td></tr>\n<tr><td style=\"text-align:left\">Akaike Inf. Crit.</td><td>8,690.566</td><td>5,298.036</td><td>4,274.943</td><td>3,157.681</td><td>3,051.689</td><td>4,091.079</td><td>2,729.538</td><td>2,816.376</td></tr>\n<tr><td colspan=\"9\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\"><em>Note:</em></td><td colspan=\"8\" style=\"text-align:right\"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr>\n</table>\n",
    "supporting": [
      "select2019analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}