---
title: "Que peut-on apprendre de l'étude Selects 2023 ?"
author: "Celâl Güney"
format: 
  html:
    toc: true
editor: visual
execute: 
  freeze: true
categories: [Social blocs, Political economy]
draft: true
---

```{r set up}
#| echo: false
#| warning: false
#| message: false

library(tidyverse)
library(haven)
library(sjlabelled)

selects2023 <- read_sav("data/2634_Selects2023_PES_Data_v1.0.sav")
```

```{r set up}
#| echo: false
#| warning: false
#| message: false

selects2023 <- 
selects2023 %>% 
  rename(
    "cantonVoteRight2023" = f10000,
    "PolInterest" = f10100,
    "MostImpProblem" = f12700rec,
    "VoteDummy2023" = f11100rec,
    "VoteChoiceMain62023" = f11800main6,
    "VoteChoice2019" = f10300main7_combined,
    "lr" = f15200,
    "StatifsDemocracy" == f13700,
    "PartyCloseness" == f14010main6,
    "PartcitipationRateVotes" = f12500,
    "UnionDummy" = n13_030a1,
    "ProbsVotePLR" = f14400a,
    "ProbsVotePS" = f14400c,
    "ProbsVoteUDC" = f14400d,
    "ProbsVotePES" = f14400e,
    "ProbsVotePVL" = f14400f,
    "ProbsVoteLega" = f14400h,
    "ProbsVoteMCG" = f14400i,
    "probsVoteCenter" = f14400j,
    "MaritalStatus" = E11,
    "HouseholdSize" = f20500,
    "LanguageFamily" = f20221,
    "Religion" = f20760,
    "Religious" = f20900,
    "EducationLevel" = f21310,
    "EmploymentSituation" = f21400,
    "PositionatWork" = f21500_f24900,
    "Sector" = f21700_f25100,
    "ManageIncome" = f29100,
    "Language" = lingreg_sample,
    "Canton" = canton_sample
    
    
    
  ) %>% 
  mutate(
    lr_recoded = case_when(
      lr %in% c(0,1,2) ~ 1, #left
      lr %in% c(3, 4) ~ 2, # center-left
      lr == 5 ~ 3, # center
      lr %in% c(6,7) == 4,# center-right
      lr %in% c(8, 9, 10) == 5  # right
    ),
    socspendingDummy = if_else(f15420 %in% c(1,2), 1,
                               if_else(is.na(f15420), NA, 0)),# 1 == for reduction
    socspend = case_when(f15420 %in% c(1,2) ~ 1, # for reduction
                         f15420 == 3 ~ 2, # neither nor
                         f15420 %in% c(4,5)), # for increase
    
    EuMembershipDummy = case_when(f15430 %in% c(1,2) ~ 1, # for eu membership
                                  f15430 %in% c(3:5) ~ 0),
    EuMembership = case_when(f15430 %in% c(1,2) ~ 1, # for integration
                             f15430 == 3 ~ 2, # neither nor
                             f15430 %in% c (4,5) ~ 3), # stay outside
    StateInterventionDummy = if_else(f15435 %in% c(1,2), 1, # for more state intervention
                                     if_else(is.na(f15435), NA, 0)),
    StateIntervention = case_when(
      f15435 %in% c(1,2) ~ 1, # for more state intervention
      f15435 %in% c(3) ~ 2, # neither nor
      f15435 %in% c(4,5) ~ 3 # for more free market competition
    ),
    
    EqualOpportunitiyCH_F = case_when(
      f15435 %in% c(1,2) ~ 1, # for equal opportunities
      f15435 == 3 ~ 2, # neither nor
      f15435 %in% c(4,5) ~ 3 # for better opportunities for the swiss
    ),
    
    Environment_vs_growth = case_when(
      
      f15470 %in% c(1,2) ~ 1, # environmental protec mor important 
      f15470 == 3 ~ 2, # neither nor
      f15470 %in% c(4,5) ~ 3 # econ growth more important 
      
    ),
    
    TaxesHighInc = case_when(
      f15480 %in% c(1,2) ~ 1, # for increase
      f15480 == 3 ~ 2, # neither nor
      f15480 %in% c(4,5) ~3 # for a reduction
    ),
    
    TaxesHighIncDummy = if_else(f15480 %in% c(1,2), 1, # for increase
                                if_else(is.na(f15480), NA, 0)),
    
    ModernityTraditions = case_when(
      f15485 %in% c(1,2) ~ 1, # for modern ch
      f15485 ==3 ~ 2, # neither nor
      f15485 %in% c(4,5) ~ 3 # defend traditions
    ),
    
    Retirement67 = case_when(
      f15811 %in% c(1,2) ~ 1, # against
      f15811 == 3 ~ 2, # neither nor
      f15811 %in% c(4,5) ~ 3 # in favor 
    ),
    
    Retirement67Dummy = if_else(f15811 %in% c(1,2), 1, # against
                                if_else(is.na(f15811), NA, 0)),
    
    MinWage4kchf = case_when(
      f15815 %in% c(1,2) ~ 1, # against
      f15815 %in% c(3,4) ~ 2 # in favor (note: there is no indifference category...)
    ),
    
    MinWage4KDummy = if_else(f15815 %in% c(3,4),1,
                             if_else(is.na(f15815), NA, 0)),
    
    VoteRightsForeignMunicip = case_when(
      f15816 %in% c(1,2) ~ 1, # against
      f15816 %in% c(3,4) ~ 2 # in favor
    ),
    
    VoteRightsForeignMunicipDummy = if_else(f15816  %in% c(3,4), 1,
                                            if_else(is.na(f15816), NA, 0)),
    
    EqualRightsHomoCouples = case_when(
      f15817 %in% c(1,2) ~ 1, # against
      f15817 %in% c(3,4) ~ 2 # in favor
    ),
    
    EqualRightsHomoCouplesDummy = if_else(f15817 %in% c(3,4), 1,
                                          if_else(is.na(f15817), NA, 0)),
    
    SelfEmployedDummy = if_else(PositionatWork == 4, 1,
                                if_else(is.na(PositionatWork), NA, 0)),
    
    Income = case_when(
      
      f28910 == 1 ~ 2000,
      f28910 == 2 ~ (3000+2001)/2,
      f28910 == 3 ~ (4000+3001)/2,
      f28910 == 4 ~ (5000+4001)/2,
      f28910 == 5 ~ (6000+5001)/2,
      f28910 == 6 ~ (7000+6001)/2,
      f28910 == 7 ~ (8000+7001)/2,
      f28910 == 8 ~ (9000+8001)/2,
      f28910 == 9 ~ (10000+9001)/2,
      f28910 == 10 ~ (11000+10001)/2,
      f28910 == 11 ~ (12000+11001)/2,
      f28910 == 12 ~ (13000+12001)/2,
      f28910 == 13 ~ (14000+13001)/2,
      f28910 == 14 ~ (15000+14001)/2,
      f28910 == 15 ~ (16000+15001)/2,
      f28910 == 16 ~ (17000+16001)/2,
      f28910 == 17 ~ (18000+17001)/2,
      f28910 == 18 ~ (19000+18001)/2,
      f28910 == 19 ~ (20000+19001)/2,
      f28910 == 20 ~ 20000
      
    ),
    
    IncomeAdjusted = Income/hhsize_sample,
    IncomeAdjustedDecile = ntile(IncomeAdjusted, 10),
    IncomeDecile = ntile(Income, 10),
    
    HouseOwnership = if_else(f21200 == 2,
                             if_else(is.na(f21200), NA, 0))
    
  )






```




















