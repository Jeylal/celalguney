---
title: "The wage share paradox in Switzerland"
author: "Celâl Güney"
format: 
  html:
    toc: true
editor: visual
execute: 
  freeze: true
categories: [Economics, Inequality]
image: fig-divbarcharts-1.png
draft: true
bibliography: references.bib
---

```{r set up}
#| echo: false
#| warning: false
#| message: false

library(tidyverse)
library(mbreaks)
library(readxl)
library(marginaleffects)

setwd("~/GitHub/celalguney/posts/wage share switzerland")



```


```{r data import}
#| echo: false
#| warning: false
#| message: false

# Siegenthaler et al sheet 1
sheet1 <- read_excel("Daten für Kapitel4.xlsx", 
    skip = 1) %>% 
  select(Jahr, `Reales BIP (Mio. CHF 2005)`, `Anzahl Erwerbstätige (in 1000)`) %>% 
  rename("year" = Jahr,
         "real_gdp_cap_2005" = `Reales BIP (Mio. CHF 2005)`,
         "total_employment_in1000" = `Anzahl Erwerbstätige (in 1000)`)


#glimpse(sheet1)

# population total found in sheet 13

population_total <- read_excel("Daten für Kapitel4.xlsx", 
    sheet = "Quelle_Var11") %>% 
  select(Jahr, `Bevölkerung_total`) %>% 
  rename("population_total" = `Bevölkerung_total`,
         "year" = Jahr)

# import nominal gdp and compensation of employees

compensation_employees <- read_excel("Daten für Kapitel4.xlsx", 
    sheet = "Quelle_Var2", skip = 1) %>% 
  select(Jahr, `Zusammengesetzte Reihe: Nominal, zu laufenden Preisen`) %>% 
  rename("year" = Jahr,
         "compensation_employees" = `Zusammengesetzte Reihe: Nominal, zu laufenden Preisen`)


gdp_nominal <- read_excel("Daten für Kapitel4.xlsx", 
    sheet = "Quelle_Var1", skip = 1) %>% 
  select(Jahr, `BIP zu laufenden Preisen, in Millionen Franken`, `BIP-Deflator (Quelle: SECO)`) %>% 
  rename(
    'year' = Jahr,
    'gdp_nominal' = `BIP zu laufenden Preisen, in Millionen Franken`,
    'gdp_deflator2005' = `BIP-Deflator (Quelle: SECO)`
  )


data1 = cbind(sheet1, population_total[-1])
data2 = cbind(compensation_employees, gdp_nominal[-75,-1])

# merging the variables into a single dataframe

data = data1 %>% 
  left_join(data2, by = "year")

# compute unadjusted and adjusted wage share

data3 = data %>% 
  mutate(
    wage_share = compensation_employees/gdp_nominal,
    adj_wage_share = (compensation_employees/population_total)*(gdp_deflator2005*(real_gdp_cap_2005/(total_employment_in1000*1000))),
    adj_wage_share2 = (compensation_employees/population_total)*((total_employment_in1000*1000)/population_total)
  )

```


```{r plot wage share}
data3 %>% 
  filter(year %in% c(1991:2022)) %>% 
  ggplot(aes(x = year, y = wage_share))+
  geom_line()
```
















