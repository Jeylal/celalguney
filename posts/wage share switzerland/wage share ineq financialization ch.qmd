---
title: "The wage share paradox in Switzerland"
author: "Celâl Güney"
format: 
  html:
    toc: true
editor: visual
execute: 
  freeze: true
categories: [Economics, Inequality]
image: fig-divbarcharts-1.png
draft: true
bibliography: references.bib
---

```{r}
#| echo: false
#| warning: false
#| message: false

library(tidyverse)
library(mbreaks)
library(readxl)
library(marginaleffects)
salaire_ofs <- read_excel("salaire_ofs.xlsx", 
    sheet = "total")
salaire_ofs$logrw = log(salaire_ofs$real_wage_total)


realwage = ts(salaire_ofs$real_wage_total, start = 1942, end = 2024)
autoplot(log(realwage))

model_rw = lm(data = salaire_ofs,
           logrw ~ year*I(year > 1978))


coef(model_rw)[2] 

plot_predictions(model_rw, by = "year")+
  geom_line(data = salaire_ofs, aes(x = year, y = logrw), color = "red", size = 1)+
  theme_minimal()+
  labs(title = "Évolution de l'indice des salaires réels suisses")+
  annotate("text", x = 1980, y = 4.7, label = "logrw = -50 + 0.0286*year + 45.76*D1978 + -0.0231*year*D1978")

```