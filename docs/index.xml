<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Celâl Güney</title>
<link>https://jeylal.github.io/myblog/index.html</link>
<atom:link href="https://jeylal.github.io/myblog/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.3.353</generator>
<lastBuildDate>Sat, 08 Jul 2023 22:00:00 GMT</lastBuildDate>
<item>
  <title>Political Conflict and Inequality in Switzerland</title>
  <dc:creator>Celâl Güney</dc:creator>
  <link>https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis.html</link>
  <description><![CDATA[ 




<section id="political-cleavages-and-inequality" class="level1">
<h1>Political Cleavages and inequality</h1>
<section id="introduction-and-problématique" class="level2">
<h2 class="anchored" data-anchor-id="introduction-and-problématique">Introduction and Problématique</h2>
<p>How does social inequality affect political cleavages and political conflict? A recent trend in political economy has developed and built a tremendous analysis of the evolution of political cleavages in almost all democratic countries around the world. This sudden interest, whose origin can be traced back to Piketty’s last book <span class="citation" data-cites="piketty_capital_2019">(Piketty 2019)</span>, gave rise to the World Political Cleavages and Inequality Database (<a href="https://wpid.world/">WPID</a>) and to a book which analyses the effect of income, social and educational inequality on the structure and transformation of political cleavages from 1948 to 2020 in 50 countries <span class="citation" data-cites="gethin_political_2021">(Gethin, Martinez-Toledano, and Piketty 2021)</span>.</p>
<p>Why have political cleavages and political conflict become popular among economists such as Piketty, who were originally more focused on inequality analysis? An answer could be the inequality paradox: the fact that rising inequality in almost all developed countries in the world has no paved the way to growing support for left and far-left parties, income and wealth redistribution and for political contest in general. Political economists such as Piketty have spent years studying inequality, how the latter has evolved and can disturb political and economic stability and how they can be reduced to make society more equal. However, whereas the technical solutions are here, political outcomes are not. Political economists have thus realized that the persistence of inequality is not only technical problem, but also a political one and that inequality analysis musts thus take politics into account.</p>
<p>It is interesting to note how the same reasoning can be applied to ecology. Ecologists face indeed the same issue: global warming becomes increasingly more threatening, and scholars know how it could be stopped or at least reduced, but there is paradoxically no political outcome and no serious political measure which has been taken despite the emergency.</p>
<p>The work of Piketty and coauthors can be summarized as follows: in the post-war period, political cleavages were bipolar with respectively a left a right bloc. Support for social-democratic parties was negatively correlated with income and education: the lower the income and level of education, the higher the probability to support the left and left economic policies. Conversely, support for right-wing parties was positively linked with income and educational level. Political cleavage was thus “classist” and bipolar in the sense that the political positioning of an individual on the left-right axis was mainly determined by his position in the economic structure.</p>
<p>The situation changed around the 1970s and 1980s: the support for the left became positively correlated with education whereas the support for the right remained linked positively with income and education. Political cleavages became thus “multipolar” by combining an economic cleavage (degree of income and wealth), which became relatively less salient, with a growing “cultural” cleavage due to the increase in average educational level. People who are familiar with political science literature will here recognize that Piketty is simply re-asserting Inglehart’s famous “post-materialist” divide over cultural issue, but giving much importance to education as a source of this cleavage.</p>
<p>The left has thus become “brahmin” because supported by high education voters. The right remains “merchant” because it still is supported by the rich. Finally, a new bloc, the “social-nativist” bloc, gathers voters with low income and low educational level. Piketty shows great concern towards the latter, calling it often the “social-nativist trap” <span class="citation" data-cites="piketty_capital_2019">(Piketty 2019)</span>.</p>
<p>Amable and Darcillon <span class="citation" data-cites="amable_brahmin_2022">(2022)</span> offer more contrasted results. Income levels are found to be still an important factor in the formation of political preferences in the classic left-right divide. They identify the possible alliance between the most educated and rich groups, giving rise to a bourgeois bloc. Amable and Palombarini notably described and analyzed how the traditional left and right blocs collapsed in France and how this phenomena allowed the emergence of a bourgeois bloc (led by Macron and his party) gathering the most educated and wealthy voters. In this perspective, the emergence of a bloc bourgeois does not imply the end of class conflict, but rather its reinforcement <span class="citation" data-cites="amable_illusion_2018">(Amable and Palombarini 2018)</span>.</p>
</section>
<section id="political-cleavages-political-conflict-and-inequality-in-switzerland" class="level2">
<h2 class="anchored" data-anchor-id="political-cleavages-political-conflict-and-inequality-in-switzerland">Political cleavages, political conflict and inequality in Switzerland</h2>
<p>Switzerland is considered by this literature as the country in which those transformations have been one of the most important. For instance, Durrer de la Sota et al.&nbsp;explain that “Switzerland is the country where the shift of the higher educated towards the left has been the most dramatic” <span class="citation" data-cites="durrer_de_la_sota_party_2021">(Durrer de la Sota, Gethin, and Martinez-Toledano 2021, 4)</span>. Switzerland is infamous for being the home of one of the most successful social-nativist party, the SVP which now the first political party in Switzerland. Green parties have also become an important force and they are separated between the liberal ecologists and social ecologists. The important elements of the WPID’s analysis of Switzerland are the following:</p>
<ul>
<li><p>The authors used Swiss Election Studies (<em>Selects</em>) data, which are data collected after each parliamentary election.</p></li>
<li><p>The educational shift happened in the late 80s, the period 1983-7 being the last “class-based” period. Switzerland’s political landscape is now a multi-polar and multi-elite one: the support for the greens and socialists is linked positively with education, the rich still support radical/liberal parties and the SVP represents the social-nativist bloc gathering the low income and low education voters.</p></li>
<li><p>The traditional parties, the Socialists (Swiss Socialist Party SSP), the Liberals and Radicals, and the Christian Democrats are in a declining trend, if not collapsing.</p></li>
<li><p>The Greens andradical right are the new strong emergent parties, the latter being the most important bloc.</p></li>
</ul>
<section id="research-questions-hypotheses-and-empirical-strategy" class="level3">
<h3 class="anchored" data-anchor-id="research-questions-hypotheses-and-empirical-strategy">Research questions, hypotheses and empirical strategy</h3>
</section>
<section id="research-question" class="level3">
<h3 class="anchored" data-anchor-id="research-question">Research question</h3>
<p>The present article will test Piketty’s Brahmin left vs Merchant right divide as well as the WPID’s findings on Switzerland. The objective is to explore the following research question:</p>
<ul>
<li><p>To what extent is the support for the left linked positively with the level of education and negatively with the level of income</p></li>
<li><p>To what extent is the support for right parties linked positively with the level of income</p></li>
<li><p>Are there parties for which the support increase with both the level of income and education?</p></li>
</ul>
</section>
<section id="hypothese" class="level3">
<h3 class="anchored" data-anchor-id="hypothese">Hypothese</h3>
<p>These research questions can be given temporary hypothetical answers:</p>
<ul>
<li><p>Brahmin left hypothesis:</p>
<ul>
<li>The support for left-wing parties (mostly SSP and the Greens) is linked positively with the level of education, with no clear link with the level of income.</li>
</ul></li>
<li><p>Merchant right hypothesis:</p>
<ul>
<li>The support for traditional right-wing parties (Liberal-Radicals, Christian Democrats which have become recenty “the center”) is linked positively with the level of income.</li>
</ul></li>
<li><p>Bourgeois bloc hypothesis</p>
<ul>
<li>The support for right-wing parties is linked positively with both the level of income and education.</li>
</ul></li>
</ul>
</section>
<section id="data" class="level3">
<h3 class="anchored" data-anchor-id="data">Data</h3>
<p>As mentioned above, the WPID’s findings for Switzerland are based on Selects data. Since using Selects data again would not make great sense, unless a very different and specific methodology is used, I tried my best to find another data source. I have thus found an interesting dataset, the standardized Voxlt surveys, which are post-electoral survey data that were collected after each referendum voting from 1981 to 2016. In those surveys, not only referendum voting decisions were collected, but also information on party identification, left-right positioning and various soc-dem characteristics.</p>
<p>Party identification will obviously be the dependent variable. I create a dummy variable for each party support.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Party identification</caption>
<thead>
<tr class="header">
<th style="text-align: right;">p02</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">prop</th>
<th style="text-align: left;">label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">5209</td>
<td style="text-align: right;">0.0162681</td>
<td style="text-align: left;">PDC+PCS groupés</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">760</td>
<td style="text-align: right;">0.0023735</td>
<td style="text-align: left;">PCS/CSP</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">18345</td>
<td style="text-align: right;">0.0572929</td>
<td style="text-align: left;">PDC/CVP</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">2589</td>
<td style="text-align: right;">0.0080856</td>
<td style="text-align: left;">PEP/EVP</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">22144</td>
<td style="text-align: right;">0.0691574</td>
<td style="text-align: left;">PRD/FDP</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">1280</td>
<td style="text-align: right;">0.0039975</td>
<td style="text-align: left;">PdL (PA)/FPS (AP)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">9563</td>
<td style="text-align: right;">0.0298660</td>
<td style="text-align: left;">PES/GPS</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">2026</td>
<td style="text-align: right;">0.0063274</td>
<td style="text-align: left;">AdI/LdU</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">1690</td>
<td style="text-align: right;">0.0052780</td>
<td style="text-align: left;">Lega</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">2839</td>
<td style="text-align: right;">0.0088664</td>
<td style="text-align: left;">PLS/LPS</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">2007</td>
<td style="text-align: right;">0.0062680</td>
<td style="text-align: left;">PdT [POCH, PSA]/PdA [POCH, PSA]</td>
</tr>
<tr class="even">
<td style="text-align: right;">11</td>
<td style="text-align: right;">885</td>
<td style="text-align: right;">0.0027639</td>
<td style="text-align: left;">DS (AN)/SD (NA)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12</td>
<td style="text-align: right;">47166</td>
<td style="text-align: right;">0.1473031</td>
<td style="text-align: left;">PSS/SPS</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">30156</td>
<td style="text-align: right;">0.0941795</td>
<td style="text-align: left;">UDC/SVP</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td style="text-align: right;">305</td>
<td style="text-align: right;">0.0009525</td>
<td style="text-align: left;">FraP</td>
</tr>
<tr class="even">
<td style="text-align: right;">15</td>
<td style="text-align: right;">463</td>
<td style="text-align: right;">0.0014460</td>
<td style="text-align: left;">AV/GB</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">0.0001530</td>
<td style="text-align: left;">AdG</td>
</tr>
<tr class="even">
<td style="text-align: right;">17</td>
<td style="text-align: right;">320</td>
<td style="text-align: right;">0.0009994</td>
<td style="text-align: left;">UDF/EDU</td>
</tr>
<tr class="odd">
<td style="text-align: right;">18</td>
<td style="text-align: right;">1521</td>
<td style="text-align: right;">0.0047502</td>
<td style="text-align: left;">PBD/BDP</td>
</tr>
<tr class="even">
<td style="text-align: right;">19</td>
<td style="text-align: right;">2413</td>
<td style="text-align: right;">0.0075360</td>
<td style="text-align: left;">Verts Libéraux/GLP</td>
</tr>
<tr class="odd">
<td style="text-align: right;">20</td>
<td style="text-align: right;">12601</td>
<td style="text-align: right;">0.0393539</td>
<td style="text-align: left;">PLR/FDP Die Liberalen</td>
</tr>
<tr class="even">
<td style="text-align: right;">30</td>
<td style="text-align: right;">2819</td>
<td style="text-align: right;">0.0088040</td>
<td style="text-align: left;">Autre parti</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31</td>
<td style="text-align: right;">12996</td>
<td style="text-align: right;">0.0405875</td>
<td style="text-align: left;">Plusieurs partis</td>
</tr>
<tr class="even">
<td style="text-align: right;">32</td>
<td style="text-align: right;">6033</td>
<td style="text-align: right;">0.0188415</td>
<td style="text-align: left;">Pas un parti, mais une personne</td>
</tr>
<tr class="odd">
<td style="text-align: right;">33</td>
<td style="text-align: right;">102205</td>
<td style="text-align: right;">0.3191941</td>
<td style="text-align: left;">Aucun parti</td>
</tr>
<tr class="even">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">31813</td>
<td style="text-align: right;">0.0993545</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The two main explanatory variable will be income and educational level. On the one hand, the dataset contains the variable “educ” which is a 1-6 point scale variable on the highest achieved level of education of the respondant, 1 being mandatory school and 6 university. I do not here perform any modification on this variable and I will consider it as continuous. Considering this variable as continuous is not a ideal option since the distance between each group is not really the same, but since I will perform complex multilevel models with years as a level and varying slopes for education and income, considering this variable as a factor would make computation in R very hard and tedious (especially the glmer function, which can take a long time).</p>
<p>On the other hand, the dataset offers two variables for income: “nivmena” and “revenu”.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">educ</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">prop</th>
<th style="text-align: left;">label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">44007</td>
<td style="text-align: right;">0.1374373</td>
<td style="text-align: left;">Ecole obligatoire</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">147792</td>
<td style="text-align: right;">0.4615658</td>
<td style="text-align: left;">Apprentissage</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">29759</td>
<td style="text-align: right;">0.0929397</td>
<td style="text-align: left;">Maturité + école normale</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">31534</td>
<td style="text-align: right;">0.0984831</td>
<td style="text-align: left;">Formation prof. supérieure</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">16599</td>
<td style="text-align: right;">0.0518400</td>
<td style="text-align: left;">Haute école spécialisée</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">47681</td>
<td style="text-align: right;">0.1489115</td>
<td style="text-align: left;">Université + Polytechnique</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">2825</td>
<td style="text-align: right;">0.0088227</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>On the other hand, the dataset offers two variables for income: “nivmena” and “revenu”. Nivmena, a 4 point scale ordinal variable (in categories), was collected until 1993 and revenu was then collected. the latter is a 5 points scale ordinal income brackets variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">vox <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(nivmena) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(n), </span>
<span id="cb1-4">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_character</span>(nivmena)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>()</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">nivmena</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">prop</th>
<th style="text-align: left;">label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5515</td>
<td style="text-align: right;">0.0172238</td>
<td style="text-align: left;">Elevé</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">19126</td>
<td style="text-align: right;">0.0597320</td>
<td style="text-align: left;">Moyen supérieur</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">35285</td>
<td style="text-align: right;">0.1101978</td>
<td style="text-align: left;">Moyen inférieur</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">9292</td>
<td style="text-align: right;">0.0290196</td>
<td style="text-align: left;">Bas</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">250979</td>
<td style="text-align: right;">0.7838268</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">vox <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(revenu) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(n), </span>
<span id="cb2-4">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_character</span>(revenu)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>()</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">revenu</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">prop</th>
<th style="text-align: left;">label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">23419</td>
<td style="text-align: right;">0.0731393</td>
<td style="text-align: left;">3’000.- CHF et moins</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">51879</td>
<td style="text-align: right;">0.1620221</td>
<td style="text-align: left;">de 3’001 à 5’000.- CHF</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">53038</td>
<td style="text-align: right;">0.1656418</td>
<td style="text-align: left;">de 5’001 à 7’000.- CHF</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">34683</td>
<td style="text-align: right;">0.1083177</td>
<td style="text-align: left;">de 7’001 à 9’000.- CHF</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">35171</td>
<td style="text-align: right;">0.1098418</td>
<td style="text-align: left;">9’001.- CHF et plus</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">13940</td>
<td style="text-align: right;">0.0435357</td>
<td style="text-align: left;">nsp</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">108067</td>
<td style="text-align: right;">0.3375016</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>I made the choice to merge the two variables by recoding the revenu variable so that it fits into the categories of the first variable. I do so by considering the first income bracket as the “low” category, the second as “inferior-middle”, the third and fourth as the “upper-middle” category and the fifth as the “upper” category.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Two ways to create the income variable</span></span>
<span id="cb3-2">vox <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> vox <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">income =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(revenu <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(nivmena), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb3-4">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(revenu <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(nivmena), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb3-5">                                  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(revenu <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(nivmena), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb3-6">                                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(revenu <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(nivmena), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-7">                                                  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(revenu) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> annee <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1993</span>, nivmena, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>))))))</span>
<span id="cb3-8"></span>
<span id="cb3-9">         </span>
<span id="cb3-10">vox<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>income <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(vox<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>income <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-11">                    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(vox<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>income <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb3-12">                        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(vox<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>income <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb3-13">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(vox<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>income <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>))))</span></code></pre></div>
</div>
</section>
</section>
<section id="exploratory-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-analysis">Exploratory Analysis</h2>
<p>Let’s first see how support for the Swiss Socialist Party (SSP) evolved across income groups in the last decades. I expect the lower groups to support the SSP until the 1990s, when the poor have supposedly shifted their support from the SSP to other parties (mainly the SVP) or to abstention.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis_files/figure-html/vote for the left by income group-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The graph above shows well the reversal of the SSP support. From 1981 to around 1992, the lowest income groups (1 and 2) were the groups that supported the SSP the most. The richest group (4) was clearly not supporting the SSP a lot until the middle of the 1990s, when it became the most supportive group!. A reversal has thus clearly happened during the 1990s: the support for SSP declined among the poorest and increased among the upper middle class and the richest.</p>
<p>Let’s now see how the support for the radicals/Liberals evolved. The Radicals are surely one of the most important political bloc historically in Switzerland. Radicals literally created modern Switzerland in the middle of the 19th century. Radicals underwent a lot of transformations, fusions and alliances with other parties. From 1984 to 2008, their party was the “radical-democratic party” after having merged with Swiss democrates. In 2009, this party merged again with another, the Swiss Liberal party, to create the Liberal-Radical (PLR) party which is the party which exists until nowadays. The bourgeois element of this bloc has never been a taboo and the PLR can clearly be named a bourgeois party.</p>
<p>The bourgeois dimension of the PLR is also made clear by the graph below:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis_files/figure-html/support plr by income group-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see that the radical-democrates (from 1981 to 2008) and then PLR (2009-2016) was always mainly supported by the richest income groups. Support among the poorest rarely went beyond the 10%.</p>
<p>Regarding the support for Swiss People’s party (SVP), here is the graph below:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis_files/figure-html/support udc by income group-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The graph illustrates well how the avarage support for SVP increased in almost all income groups, except for the highest group. The latter used to support SVP the most until the late 1990s. Moreover, we can see that the common and widespread idea that the SVP is the most successful among the poorest voters is an exaggeration. The support for SVP also increased among the third and second income group. It is interesting to note how a reversal happened in 1992, the year of the voting on the adhesion to the European Economic Area (EEA). Before 1992, the richest group used to be the most supportive of the SVP. After 1992, the support among the richest declined and is the lowest in almost every year.</p>
</section>
<section id="modelling" class="level2">
<h2 class="anchored" data-anchor-id="modelling">Modelling</h2>
<p>To analyze the relationship between party support and income and education, let’s now run some regressions. I will run separate binary logit regression for each party support dummies with income and education as explanatory variable. Since we have a timeframe which goes from 1981 to 2016, a choice has to be made regarding which regression model to run in order to take years into account. The first and most simple option would be to run separate regressions for each year. This is the repeated cross-sectional regression option. Another option would be to run a multilevel regression with years as a level and with varying slopes for education and income.</p>
<p>The first option is a lot more convenient than the multilevel model, because it is a lot faster to run in R, especially when control variables are added in the model. However, multilevel model is more appropriated and gives more robust results and better inference. Since it would be also interesting to compare the results between the two options, both repeated cross-sectional and multilevel regressions will be run here.</p>
<section id="repeated-cross-section-support-for-ssp" class="level4">
<h4 class="anchored" data-anchor-id="repeated-cross-section-support-for-ssp">Repeated Cross-section: support for SSP</h4>
<p>Let’s first run binary logit regression separately for each year of the dataset. The package purrr and map() function allows to do this quiet easily:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">nprcs_ssp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb4-2">vox <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">split</span>(.<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>annee_f) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(pss <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> income <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> educ, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> .x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">binomial</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"logit"</span>)))</span>
<span id="cb4-5"></span>
<span id="cb4-6"></span>
<span id="cb4-7">year <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1981</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2016</span>)</span>
<span id="cb4-8"></span>
<span id="cb4-9">nprcs_ssp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_df</span>(tidy) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year =</span> year[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(year)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),],</span>
<span id="cb4-12">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">test =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(p.value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>),</span>
<span id="cb4-13">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lower =</span> estimate <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.96</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>std.error,</span>
<span id="cb4-14">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">upper =</span> estimate <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.96</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>std.error) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> nprcs_ssp_results</span>
<span id="cb4-15"></span>
<span id="cb4-16"></span>
<span id="cb4-17">nprcs_ssp_results <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(term <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(Intercept)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> estimate, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(year), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> term, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> term)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_pointrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> lower, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> upper))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>term)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vote for SSP, log(odds)"</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis_files/figure-html/no pooling repeated cross section (nprcs) regression vote for ssp-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here are the estimated coefficient for each regression. Since the coefficients give information on log(odds), they are not very informative (even if their sign still is). To give more meaningful results, I compute average marginal effects (AME) for each year:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># computing average marginal effect for each year</span></span>
<span id="cb5-2">ame_income_nprcrs_ssp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb5-3">nprcs_ssp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slopes</span>(.x ,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variables =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"income"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_df</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(.x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ame =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(estimate),</span>
<span id="cb5-6">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">high =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(conf.high),</span>
<span id="cb5-7">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">low =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(conf.low))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-8">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1981</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2016</span>,</span>
<span id="cb5-9">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variable =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"income"</span>)</span>
<span id="cb5-10"></span>
<span id="cb5-11">ame_educ_nprcrs_ssp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb5-12">nprcs_ssp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slopes</span>(.x ,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variables =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"educ"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_df</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(.x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ame =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(estimate),</span>
<span id="cb5-15">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">high =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(conf.high),</span>
<span id="cb5-16">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">low =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(conf.low))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-17">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1981</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2016</span>, </span>
<span id="cb5-18">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variable =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"educ"</span>)</span>
<span id="cb5-19"></span>
<span id="cb5-20"></span>
<span id="cb5-21">ame_nprcrs_ssp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(ame_income_nprcrs_ssp, ame_educ_nprcrs_ssp)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## plot the AME for each year</span></span>
<span id="cb6-2">plot_ame_ssp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb6-3">ame_nprcrs_ssp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_ame</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probability to vote for SSP"</span>,</span>
<span id="cb6-6">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Repeated cross-section, no controls"</span>,</span>
<span id="cb6-7">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Average Marginal Effect"</span>)</span>
<span id="cb6-8">plot_ame_ssp</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis_files/figure-html/plot ame nprcs ssp-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This graph offers interesting results. The support for SSP used to be strongly negatively associated with income in 1981-2, but this negative relationship declined a lot during the 80s. It recovered a bit during the 90s but then even became positive in the middle of the 1990s and positive again in the early 2000s. On the other hand, the support for SSP seems to be always linked positively with the level of education. We can thus say that the SSP was and still is indeed a brahmin party, and even endorse the role of a bourgeois party for some years when its support is linked positively with income and education.</p>
<p>Another way to represent the relationship between support for SSP and income and education is to estimates of probability differences between given values of the predictors using the comparisons() function, which compute (in our case) probability differences between values at certain levels. The graph below show comparisons between the highest and lowest income groups (4-1). For education, I compare the highest level of education (university) not with the lowest level (primary school), but with vocational trainees/apprenticeship because the latter is the most widespread highest achieved level of education in Switzerland, even nowadays.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># how to compute and plot average comparison in R</span></span>
<span id="cb7-2">ame_income_comparison_ssp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb7-3">nprcs_ssp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">comparisons</span>(.x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variables =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">income =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_df</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(.x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ame =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(estimate),</span>
<span id="cb7-6">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">high =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(conf.high),</span>
<span id="cb7-7">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">low =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(conf.low))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-8">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1981</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2016</span>,</span>
<span id="cb7-9">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variable =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"income 4-1"</span>)</span>
<span id="cb7-10">  </span>
<span id="cb7-11"></span>
<span id="cb7-12">ame_educ_comparison_ssp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb7-13">nprcs_ssp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">comparisons</span>(.x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variables =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">educ =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_df</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(.x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ame =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(estimate),</span>
<span id="cb7-16">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">high =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(conf.high),</span>
<span id="cb7-17">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">low =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(conf.low))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-18">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1981</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2016</span>,</span>
<span id="cb7-19">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variable =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"educ 6-2"</span>)</span>
<span id="cb7-20"></span>
<span id="cb7-21"></span>
<span id="cb7-22">comparison_npcrs_ssp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(ame_educ_comparison_ssp, ame_income_comparison_ssp)</span>
<span id="cb7-23"></span>
<span id="cb7-24">comparison_npcrs_ssp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_ame</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Difference in Probabilities: SSP Support"</span>,</span>
<span id="cb7-27">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Repeated Cross-sectional logit regressions"</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis_files/figure-html/nprcs comparisons ssp-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In 1981, an individual of the highest income group was 28% less probable to support the SSP compared with someone from the lowest income income. This difference decreased substantially over the years, and is rather close to zero nowadays. This is not the case for education. In 1981, a highly educated individual from either university of polytechnic school had around 19% more probabilities to support the SSP than someone who completed an apprenticeship. This difference has decreased over the years, but is still quiet high, around 10% in 2016. This show that the SSP was and still is the party of the most educated, but not necessarily of the poorest or the richest.</p>
<p>To check whether the results above are robust, I run and present a second model which controls for soc-dem characteristics (age, gender, marital status, region):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">plot_ame_nprcs_ssp_controls <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb8-2">ame_nprcs_ssp_controls <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_ame</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probability to support the SSP"</span>,</span>
<span id="cb8-5">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Repeated Cross-sectional logit regressions, after controls"</span>,</span>
<span id="cb8-6">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Average Marginal Effect"</span>)</span>
<span id="cb8-7"></span>
<span id="cb8-8">plot_ame_nprcs_ssp_controls</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis_files/figure-html/plot ame ssp full-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The graph above does not imply any change to the broad picture, let’s see for comparisons</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis_files/figure-html/plot comparisons ssp controls-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The differences in probability have slighlty change, but the conclusions here are in fine the same as the no-control regression.</p>
</section>
<section id="repeated-cross-section-support-for-svp" class="level4">
<h4 class="anchored" data-anchor-id="repeated-cross-section-support-for-svp">Repeated Cross-section: support for SVP</h4>
<p>The results show how the support for SVP is clearly linked negatively with educational level. The relationship with income is less clear since a lot of the results are not statistically significant (the confidence interval cross 0 for most years). Here I will not give any conclusion before fitting the multilevel regression.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis_files/figure-html/comparisons svp-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="repeated-cross-section-support-for-plr" class="level4">
<h4 class="anchored" data-anchor-id="repeated-cross-section-support-for-plr">Repeated Cross-section: support for PLR</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis_files/figure-html/plr nprcs controls-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">comparisons_plr_educ <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb9-2">  nprcs_plr_controls <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">comparisons_educ</span>()</span>
<span id="cb9-4"></span>
<span id="cb9-5">comparisons_plr_income <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb9-6">  nprcs_plr_controls <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">comparisons_income</span>()</span>
<span id="cb9-8"></span>
<span id="cb9-9"></span>
<span id="cb9-10">comparisons_plr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(comparisons_plr_educ, comparisons_plr_income)</span>
<span id="cb9-11"></span>
<span id="cb9-12">comparisons_plr <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_ame</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Difference in Predicted Probabilities: vote for radicals/liberals"</span>,</span>
<span id="cb9-15">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Repeated Cross-sectional regressions, with controls"</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis_files/figure-html/plr comparisons nprcs-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Finally, here are the results for PLR support. We can see that the PLR clearly fits into the bourgeois category with support linked positively with both education and income, the latter being the important factor even if it declined nonetheless.</p>
<p>Some observations can still be made regarding the comparisons plot. The difference in probability between the richest and poorest in supporting the Radicals/Liberals was highly positive in the 1980s (around 28% in 1981). This difference decreased, but is still high. Most of the time, this difference is also positive between the highest educational group and the second lowest one (apprenticeship).</p>
</section>
<section id="repeated-cross-section-support-for-the-greens" class="level4">
<h4 class="anchored" data-anchor-id="repeated-cross-section-support-for-the-greens">Repeated Cross-section: support for the Greens</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis_files/figure-html/greens plot-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis_files/figure-html/greens plot-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Regarding the support for the Greens, it is associated positively with education. The relationship with income is not clear, the multilevel model will hopefully give better results.</p>
</section>
<section id="multilevel-regression-partial-pooling-for-years" class="level3">
<h3 class="anchored" data-anchor-id="multilevel-regression-partial-pooling-for-years">Multilevel regression: partial pooling for years</h3>
<section id="support-for-ssp" class="level4">
<h4 class="anchored" data-anchor-id="support-for-ssp">Support for SSP</h4>
<p>The multilevel regressions, with years as a level, lead globally to the same conclusions as above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">glmer_pss <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glmer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> vox,</span>
<span id="cb10-2">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> pss <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> income <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> educ <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> gender <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> age_cat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> married <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> regionL <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> religion <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (income <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> educ <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> annee_f),</span>
<span id="cb10-3">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">binomial</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"logit"</span>))</span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis_files/figure-html/plot ame partial pooling pss-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The results are very close to the repeated cross-section model.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis_files/figure-html/plot glmer comparisons ssp-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="support-for-radicalsliberals" class="level4">
<h4 class="anchored" data-anchor-id="support-for-radicalsliberals">Support for Radicals/Liberals</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis_files/figure-html/partial pooling plr plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis_files/figure-html/plot comparisons glmer plr-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="partial-pooling-support-for-svp" class="level4">
<h4 class="anchored" data-anchor-id="partial-pooling-support-for-svp">Partial Pooling: Support for SVP</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">glmer_udc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glmer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> vox,</span>
<span id="cb11-2">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> udc <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> income <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> educ <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> gender <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> age_cat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> married <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> regionL <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> religion <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (income <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> educ <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> annee_f),</span>
<span id="cb11-3">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">binomial</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"logit"</span>))</span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis_files/figure-html/partial pooling udc plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis_files/figure-html/comparison plot glmer svp-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="partial-pooling-support-for-the-greens" class="level4">
<h4 class="anchored" data-anchor-id="partial-pooling-support-for-the-greens">Partial Pooling: Support for the Greens</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis_files/figure-html/plot comparisons glmer greens-1.png" class="img-fluid" width="672"></p>
</div>
</div>



</section>
</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-amable_brahmin_2022" class="csl-entry">
Amable, Bruno, and Thibault Darcillon. 2022. <span>“Brahmin Left Versus Merchant Right. How Useful Is This Distinction for the Analysis of Political Divides in Western Democracies?”</span> <em>Political Economy Working Papers</em>.
</div>
<div id="ref-amable_illusion_2018" class="csl-entry">
Amable, Bruno, and Stefano Palombarini. 2018. <em>L’illusion Du Bloc Bourgeois: Alliances Sociales Et Avenir Du Modèle Français</em>. Raisons d’agir. Paris.
</div>
<div id="ref-durrer_de_la_sota_party_2021" class="csl-entry">
Durrer de la Sota, Carmen, Amory Gethin, and Clara Martinez-Toledano. 2021. <span>“Party System Transformation and the Structure of Political Cleavages in Austria, Belgium, the Netherlands and Switzerland, 1967-2019.”</span> <em>World Inequality Lab – Working Paper</em>, no. 2021. <a href="https://wid.world/wp-content/uploads/2021/03/WorldInequalityLab_WP2021_08_PoliticalCleavages_AustriaBelgiumNLSwitzerland.pdf">https://wid.world/wp-content/uploads/2021/03/WorldInequalityLab_WP2021_08_PoliticalCleavages_AustriaBelgiumNLSwitzerland.pdf</a>.
</div>
<div id="ref-gethin_political_2021" class="csl-entry">
Gethin, Armory, Clara Martinez-Toledano, and Thomas Piketty. 2021. <em>Political Cleavages and Social Inequalities a Study of Fifty Democracies, 1948–2020</em>. Harvard Univeristy Press.
</div>
<div id="ref-piketty_capital_2019" class="csl-entry">
Piketty, Thomas. 2019. <em>Capital Et Idéologie</em>. Le Seuil.
</div>
</div></section></div> ]]></description>
  <category>Political Economy</category>
  <category>Statistics</category>
  <guid>https://jeylal.github.io/myblog/posts/vox and voto analysis/vox_voto_analysis.html</guid>
  <pubDate>Sat, 08 Jul 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Web Scraping with R</title>
  <dc:creator>Celâl Güney</dc:creator>
  <link>https://jeylal.github.io/myblog/posts/web scraping/web_scraping.html</link>
  <description><![CDATA[ 




<section id="an-introduction-to-web-scraping-in-r" class="level2">
<h2 class="anchored" data-anchor-id="an-introduction-to-web-scraping-in-r">An introduction to web scraping in R</h2>
<p>Web scraping is nowadays rife in statistics and data science. This data collection method has become fashionable not only in computer and data science, but also in economics, sociology and social sciences in general. The reasons for the success of web scraping need hardly to be told at length: the usefulness of web scrapping, extracting data from whatever website we visit, is self-evident. Go to any Wikipedia page, and you can extract whatever data table in contains into your favorite statistical software. The potential of web scraping is huge and will be increasingly used in social sciences.</p>
<p>The main goal of this post is to show the basics of web scraping using R and the package rvest. To do so, I draw extensively on Paul C. Bauer’s <a href="https://bookdown.org/paul/2021_computational_social_science/data-collection-web-screen-scraping.html">Computational Social Sciences manual</a>, which explains in depth how to do web scraping in R.</p>
<div class="cell">

</div>
</section>
<section id="getting-data-videogame-prices" class="level2">
<h2 class="anchored" data-anchor-id="getting-data-videogame-prices">Getting data: videogame prices</h2>
<p>I will here use web scraping to get video-game prices in Switzerland. The first step of web scraping is to find a webpage from which you want to collect data. To collect the prices of video-games, I need a web page from for instance a chain stores. In Switzerland, MediaMarkt is a famous chain stores selling consumer electronics and most Swiss people who still buy or order physical copy of their favorite video-games go to or order from MediaMarkt.</p>
<p>For the anecdote, at the time and for many years (at least until I was 18 in the 2010s), MediaMarkt used to sell video-games slightly below market prices and some stores in Geneva even sometimes sold copies before the release date. The situation has much changed since and the stores are now barely able to sell and distribute physical copies day one (it was the case this year at least for Wo Long and Dead Space 2 remake).</p>
<p>I search then, on MediaMarkt website, the webpage dedicated to video-games. The webpages are separated by video-games platforms/consoles, so I choose to focus on Playstation 5 games. I store the <a href="https://www.mediamarkt.ch/fr/category/_jeux-ps5-772119.html">link</a> in an object called url. Then, the web page can be read in R using read_html():</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://www.mediamarkt.ch/fr/category/_jeux-ps5-772119.html?searchParams=&amp;sort=&amp;view=PRODUCTGRID&amp;page=1"</span></span>
<span id="cb1-2">mediamarkt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_html</span>(url)</span></code></pre></div>
</div>
<p>The next step is to search and select each videogame price as well as the videogame’s titles using the chrome extension selectorgadget. This step is a bit tricky and is a pain because selectorgadget is a chrome-only extension. So if you don’t have chrome, you have to install it and then add selector gadget on it. To use selectorgadget, just click on what you want to collect on the webpage and then copy the css selector which is on the left of the selectorgadget bar.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jeylal.github.io/myblog/posts/web scraping/imagemediamarkt.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Using selectorgadget</figcaption><p></p>
</figure>
</div>
<p>Then, you just have to paste it into the html_nodes function (here .info-wrapper for the price, then .product-link for the title).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">price <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_nodes</span>(mediamarkt, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".info-wrapper"</span>)</span>
<span id="cb2-2">game <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_nodes</span>(mediamarkt, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".product-link"</span>)</span></code></pre></div>
</div>
<p>Then, html_text() will extract the information we want:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">price <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_text</span>(price, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trim =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb3-2">game <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_text</span>(game, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trim =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(price)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "274.95\r\n\t\r\n\t\t\tTVA compris, plus frais d’expédition 0.-"
[2] "34.95\r\n\t\r\n\t\t\tTVA compris, plus frais d’expédition 0.-" 
[3] "72.95\r\n\t\r\n\t\t\tTVA compris, plus frais d’expédition 0.-" 
[4] "94.95\r\n\t\r\n\t\t\tTVA compris, plus frais d’expédition 0.-" 
[5] "72.95\r\n\t\r\n\t\t\tTVA compris, plus frais d’expédition 0.-" 
[6] "42.95\r\n\t\r\n\t\t\tTVA compris, plus frais d’expédition 0.-" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(game)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Marvel's Spider-Man 2: Édition Collector (CiaB) - PlayStation 5 - Allemand, Français, Italien"
[2] "FIFA 23 - PlayStation 5 - Allemand, Français, Italien"                                        
[3] "F1 23 - PlayStation 5 - Allemand, Français, Italien"                                          
[4] "Final Fantasy XVI : Édition Deluxe - PlayStation 5 - Français"                                
[5] "Final Fantasy XVI - PlayStation 5 - Français"                                                 
[6] "Marvel’s Spider-Man: Miles Morales - PlayStation 5 - Allemand, Français, Italien"             </code></pre>
</div>
</div>
<p>It worked well for the game titles (even if they could be simplified), but not so much for prices. We need to extract the latter from the text in the price object. This can be done using function gsub() and some Regex manipulation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">price_final <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"([0.001-9]+).*$"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1"</span>, price))</span>
<span id="cb7-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#"([0.001-9]+).*$" means: "keep only characters from 0.001 to 9 multiple times" it will thus extract the number from the character list we got with html_text()</span></span>
<span id="cb7-3">price_final</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 274.95  34.95  72.95  94.95  72.95  42.95  72.95  62.95  54.95  54.00
[11]  82.95  77.95  99.95  62.95  74.95  69.95  34.95  54.95  62.95  32.00
[21]  69.95  62.95  34.95  29.00</code></pre>
</div>
</div>
<p>Similarly, the video-game titles can be simplified using some Regex:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">game_final <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"- PlayStation 5 - Allemand.*"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, game)</span></code></pre></div>
</div>
<p>And finally, prices and titles can be combined in a dataframe</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(game_final, price_final)</span>
<span id="cb10-2">data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>()</span></code></pre></div>
<div class="cell-output-display">

<div id="rjyscfelzh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#rjyscfelzh) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#rjyscfelzh) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#rjyscfelzh) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#rjyscfelzh) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#rjyscfelzh) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#rjyscfelzh) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#rjyscfelzh) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#rjyscfelzh) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#rjyscfelzh) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#rjyscfelzh) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#rjyscfelzh) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#rjyscfelzh) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#rjyscfelzh) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#rjyscfelzh) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#rjyscfelzh) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#rjyscfelzh) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#rjyscfelzh) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#rjyscfelzh) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#rjyscfelzh) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#rjyscfelzh) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#rjyscfelzh) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#rjyscfelzh) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#rjyscfelzh) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#rjyscfelzh) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#rjyscfelzh) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#rjyscfelzh) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#rjyscfelzh) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#rjyscfelzh) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#rjyscfelzh) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#rjyscfelzh) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#rjyscfelzh) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#rjyscfelzh) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#rjyscfelzh) .gt_left {
  text-align: left;
}

:where(#rjyscfelzh) .gt_center {
  text-align: center;
}

:where(#rjyscfelzh) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#rjyscfelzh) .gt_font_normal {
  font-weight: normal;
}

:where(#rjyscfelzh) .gt_font_bold {
  font-weight: bold;
}

:where(#rjyscfelzh) .gt_font_italic {
  font-style: italic;
}

:where(#rjyscfelzh) .gt_super {
  font-size: 65%;
}

:where(#rjyscfelzh) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#rjyscfelzh) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#rjyscfelzh) .gt_indent_1 {
  text-indent: 5px;
}

:where(#rjyscfelzh) .gt_indent_2 {
  text-indent: 10px;
}

:where(#rjyscfelzh) .gt_indent_3 {
  text-indent: 15px;
}

:where(#rjyscfelzh) .gt_indent_4 {
  text-indent: 20px;
}

:where(#rjyscfelzh) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="game_final">game_final</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="price_final">price_final</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="game_final" class="gt_row gt_left">Marvel's Spider-Man 2: Édition Collector (CiaB) </td>
<td headers="price_final" class="gt_row gt_right">274.95</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">FIFA 23 </td>
<td headers="price_final" class="gt_row gt_right">34.95</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">F1 23 </td>
<td headers="price_final" class="gt_row gt_right">72.95</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">Final Fantasy XVI : Édition Deluxe - PlayStation 5 - Français</td>
<td headers="price_final" class="gt_row gt_right">94.95</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">Final Fantasy XVI - PlayStation 5 - Français</td>
<td headers="price_final" class="gt_row gt_right">72.95</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">Marvel’s Spider-Man: Miles Morales </td>
<td headers="price_final" class="gt_row gt_right">42.95</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">Final Fantasy XVI </td>
<td headers="price_final" class="gt_row gt_right">72.95</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">Diablo IV </td>
<td headers="price_final" class="gt_row gt_right">62.95</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">Ratchet &amp; Clank : Rift Apart </td>
<td headers="price_final" class="gt_row gt_right">54.95</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">STAR WARS Jedi : Survivor </td>
<td headers="price_final" class="gt_row gt_right">54.00</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">Gran Turismo 7 </td>
<td headers="price_final" class="gt_row gt_right">82.95</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">Sackboy: A Big Adventure </td>
<td headers="price_final" class="gt_row gt_right">77.95</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">Final Fantasy XVI: Deluxe Edition </td>
<td headers="price_final" class="gt_row gt_right">99.95</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">Hogwarts Legacy </td>
<td headers="price_final" class="gt_row gt_right">62.95</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">Marvel's Spider-Man 2 </td>
<td headers="price_final" class="gt_row gt_right">74.95</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">Horizon Forbidden West </td>
<td headers="price_final" class="gt_row gt_right">69.95</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">Uncharted : Legacy of Thieves Collection </td>
<td headers="price_final" class="gt_row gt_right">34.95</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">The Last of Us Part I </td>
<td headers="price_final" class="gt_row gt_right">54.95</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">Diablo IV - PlayStation 5 - Français</td>
<td headers="price_final" class="gt_row gt_right">62.95</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">Need for Speed Unbound </td>
<td headers="price_final" class="gt_row gt_right">32.00</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">Street Fighter 6 </td>
<td headers="price_final" class="gt_row gt_right">69.95</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">Diablo IV - PlayStation 5 - Italien</td>
<td headers="price_final" class="gt_row gt_right">62.95</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">Grand Theft Auto V </td>
<td headers="price_final" class="gt_row gt_right">34.95</td></tr>
    <tr><td headers="game_final" class="gt_row gt_left">Wild Hearts </td>
<td headers="price_final" class="gt_row gt_right">29.00</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>We have thus collected every game’s title and price on the first page of MediaMarkt Playstation 5 games.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reorder</span>(game_final, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>price_final), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> price_final)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> price_final), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Playstation 5 games"</span>,</span>
<span id="cb11-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"price in swiss francs"</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/web scraping/web_scraping_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="getting-data-on-all-pages" class="level2">
<h2 class="anchored" data-anchor-id="getting-data-on-all-pages">Getting data on all pages</h2>
<p>We have until now collected data only the first page of the website, but ideally we want to be able to collect data on all pages automatically. This can be done as follow:</p>
<p>First, create a function which will automatically most of the steps: reading the url (read_html), the css nodes found with the chrome extension SelectorGadget and extracting the information of interest:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">scrape_website <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(url){</span>
<span id="cb12-2">  </span>
<span id="cb12-3">  website <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_html</span>(url)</span>
<span id="cb12-4">  </span>
<span id="cb12-5">  title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_nodes</span>(website, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".product-link"</span>)</span>
<span id="cb12-6">  price <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_nodes</span>(website, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".info-wrapper"</span>)</span>
<span id="cb12-7">  </span>
<span id="cb12-8">  </span>
<span id="cb12-9">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">game =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"- PlayStation 5 - Allemand.*"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_text</span>(title, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trim =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)),</span>
<span id="cb12-10">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">price =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"([0.005-9]+).*$"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_text</span>(price, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trim =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))))</span>
<span id="cb12-11">  </span>
<span id="cb12-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(df)</span>
<span id="cb12-13">}</span></code></pre></div>
</div>
<p>But what about the url? In our example, there are 21 pages in total, resulting in 21 different url. Fortunately, since those pages are in fact a list of products, their patterns are very similar. The only difference between the pages are the “page=#” at the end, with # the number of the page. We can thus define base_url as the recurring url pattern common to all the 21 pages and then number of each particular page (pages object):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">base_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://www.mediamarkt.ch/fr/category/_jeux-ps5-772119.html?searchParams=&amp;sort=&amp;view=PRODUCTGRID&amp;page="</span></span>
<span id="cb13-2"></span>
<span id="cb13-3">pages <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</div>
<p>This is an example on how to extract data using the function for the first page:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(base_url, pages[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb14-2">datasets <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>()</span>
<span id="cb14-3">datasets[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scrape_website</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">url =</span> url)</span></code></pre></div>
</div>
<p>Finally, to perform web scrapping on all the pages, Paul Bauer proposes the following for loop code</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">datasets <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>()</span>
<span id="cb15-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(pages)){</span>
<span id="cb15-3">  </span>
<span id="cb15-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># informative message about progress of loop</span></span>
<span id="cb15-5">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(i, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/'</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(pages))</span>
<span id="cb15-6">  </span>
<span id="cb15-7">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># prepare URL</span></span>
<span id="cb15-8">      url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(base_url, pages[i], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb15-9">      </span>
<span id="cb15-10">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># scrape website</span></span>
<span id="cb15-11">      datasets[[i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scrape_website</span>(url)</span>
<span id="cb15-12">      </span>
<span id="cb15-13">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># wait a couple of seconds between URL calls</span></span>
<span id="cb15-14">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.sleep</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>)</span>
<span id="cb15-15">}</span></code></pre></div>
</div>
<p>However, I propose to simplify the code by using the map() function from the purrr package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(base_url, pages[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#create a vector with all the pages url</span></span>
<span id="cb16-2"></span>
<span id="cb16-3">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> url <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb16-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_df</span>(scrape_website) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#apply the scrape_website function for each element of the url vector and store into a dataframe</span></span></code></pre></div>
</div>
<p>We thus have all the data we wanted! Let’s now have a quick look at what we collected.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb17-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(price, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb17-3">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">median =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(price, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb17-4">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(price, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb17-5">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(price, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb17-6">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(price, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb17-7">            ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb17-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Video-games summary statistics (CHF)"</span>)</span></code></pre></div>
<div class="cell-output-display">

<div id="irxfefsdwr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#irxfefsdwr) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#irxfefsdwr) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#irxfefsdwr) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#irxfefsdwr) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#irxfefsdwr) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#irxfefsdwr) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#irxfefsdwr) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#irxfefsdwr) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#irxfefsdwr) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#irxfefsdwr) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#irxfefsdwr) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#irxfefsdwr) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#irxfefsdwr) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#irxfefsdwr) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#irxfefsdwr) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#irxfefsdwr) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#irxfefsdwr) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#irxfefsdwr) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#irxfefsdwr) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#irxfefsdwr) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#irxfefsdwr) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#irxfefsdwr) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#irxfefsdwr) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#irxfefsdwr) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#irxfefsdwr) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#irxfefsdwr) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#irxfefsdwr) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#irxfefsdwr) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#irxfefsdwr) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#irxfefsdwr) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#irxfefsdwr) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#irxfefsdwr) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#irxfefsdwr) .gt_left {
  text-align: left;
}

:where(#irxfefsdwr) .gt_center {
  text-align: center;
}

:where(#irxfefsdwr) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#irxfefsdwr) .gt_font_normal {
  font-weight: normal;
}

:where(#irxfefsdwr) .gt_font_bold {
  font-weight: bold;
}

:where(#irxfefsdwr) .gt_font_italic {
  font-style: italic;
}

:where(#irxfefsdwr) .gt_super {
  font-size: 65%;
}

:where(#irxfefsdwr) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#irxfefsdwr) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#irxfefsdwr) .gt_indent_1 {
  text-indent: 5px;
}

:where(#irxfefsdwr) .gt_indent_2 {
  text-indent: 10px;
}

:where(#irxfefsdwr) .gt_indent_3 {
  text-indent: 15px;
}

:where(#irxfefsdwr) .gt_indent_4 {
  text-indent: 20px;
}

:where(#irxfefsdwr) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  <caption>Video-games summary statistics (CHF)</caption>
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mean">mean</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="median">median</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sd">sd</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="min">min</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="max">max</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="mean" class="gt_row gt_right">35.83075</td>
<td headers="median" class="gt_row gt_right">34.95</td>
<td headers="sd" class="gt_row gt_right">23.90328</td>
<td headers="min" class="gt_row gt_right">5</td>
<td headers="max" class="gt_row gt_right">299.95</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb18-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(price <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb18-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> price) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb18-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">binwidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkblue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Video-game price"</span>,</span>
<span id="cb18-9">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Switzerland, Playstation 5 games, July 2023"</span>,</span>
<span id="cb18-10">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Swiss Francs (CHF)"</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/web scraping/web_scraping_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="getting-data-from-a-table" class="level2">
<h2 class="anchored" data-anchor-id="getting-data-from-a-table">Getting data from a table</h2>
<p>When browsing the internet, it often happens that we come across tables but without any possibility to export this table. Web scraping allows to easily read those tables into R.</p>
<p>I will here import data from a table on the results of the famous 1992 Swiss voting on the adhesion to the European Economic Area. The Swiss government website provides a table <a href="https://www.bk.admin.ch/ch/f/pore/va/19921206/can388.html">here</a>. I am almost certain that the Swiss government provides an excel or csv file on this but since I am too lazy to search for it (for my defense, the website page should allow to export directly the table into csv or excel), I will use web scraping to read this table in R and then extract the data into a dataframe.</p>
<p>The first step is the same as above: read the url to import the html code into R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://www.bk.admin.ch/ch/f/pore/va/19921206/can388.html"</span></span>
<span id="cb19-2">page <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_html</span>(url)</span></code></pre></div>
</div>
<p>Then, html_table() can directly import the table information</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_table</span>(page, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb20-2"></span>
<span id="cb20-3">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> table[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#extract the table dataframe from the list</span></span>
<span id="cb20-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(data) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb20-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>()</span></code></pre></div>
<div class="cell-output-display">

<div id="qomkamtpta" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#qomkamtpta) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#qomkamtpta) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#qomkamtpta) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#qomkamtpta) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#qomkamtpta) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#qomkamtpta) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#qomkamtpta) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#qomkamtpta) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#qomkamtpta) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#qomkamtpta) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#qomkamtpta) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#qomkamtpta) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#qomkamtpta) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#qomkamtpta) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#qomkamtpta) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#qomkamtpta) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#qomkamtpta) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#qomkamtpta) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#qomkamtpta) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#qomkamtpta) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#qomkamtpta) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#qomkamtpta) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#qomkamtpta) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#qomkamtpta) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#qomkamtpta) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#qomkamtpta) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#qomkamtpta) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#qomkamtpta) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#qomkamtpta) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#qomkamtpta) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#qomkamtpta) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#qomkamtpta) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#qomkamtpta) .gt_left {
  text-align: left;
}

:where(#qomkamtpta) .gt_center {
  text-align: center;
}

:where(#qomkamtpta) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#qomkamtpta) .gt_font_normal {
  font-weight: normal;
}

:where(#qomkamtpta) .gt_font_bold {
  font-weight: bold;
}

:where(#qomkamtpta) .gt_font_italic {
  font-style: italic;
}

:where(#qomkamtpta) .gt_super {
  font-size: 65%;
}

:where(#qomkamtpta) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#qomkamtpta) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#qomkamtpta) .gt_indent_1 {
  text-indent: 5px;
}

:where(#qomkamtpta) .gt_indent_2 {
  text-indent: 10px;
}

:where(#qomkamtpta) .gt_indent_3 {
  text-indent: 15px;
}

:where(#qomkamtpta) .gt_indent_4 {
  text-indent: 20px;
}

:where(#qomkamtpta) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Canton">Canton</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Electeurs">Electeurs</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Votants">Votants</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="% Particip.">% Particip.</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Oui">Oui</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Non">Non</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="% Oui">% Oui</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="% Non">% Non</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Canton" class="gt_row gt_left">Zurich</td>
<td headers="Electeurs" class="gt_row gt_right">768'126</td>
<td headers="Votants" class="gt_row gt_right">618'209</td>
<td headers="% Particip." class="gt_row gt_right">80.48%</td>
<td headers="Oui" class="gt_row gt_right">297'503</td>
<td headers="Non" class="gt_row gt_right">316'154</td>
<td headers="% Oui" class="gt_row gt_right">48.5%</td>
<td headers="% Non" class="gt_row gt_right">51.5%</td></tr>
    <tr><td headers="Canton" class="gt_row gt_left">Berne</td>
<td headers="Electeurs" class="gt_row gt_right">686'459</td>
<td headers="Votants" class="gt_row gt_right">540'179</td>
<td headers="% Particip." class="gt_row gt_right">78.69%</td>
<td headers="Oui" class="gt_row gt_right">255'224</td>
<td headers="Non" class="gt_row gt_right">281'026</td>
<td headers="% Oui" class="gt_row gt_right">47.6%</td>
<td headers="% Non" class="gt_row gt_right">52.4%</td></tr>
    <tr><td headers="Canton" class="gt_row gt_left">Lucerne</td>
<td headers="Electeurs" class="gt_row gt_right">224'458</td>
<td headers="Votants" class="gt_row gt_right">181'614</td>
<td headers="% Particip." class="gt_row gt_right">80.91%</td>
<td headers="Oui" class="gt_row gt_right">70'878</td>
<td headers="Non" class="gt_row gt_right">109'447</td>
<td headers="% Oui" class="gt_row gt_right">39.3%</td>
<td headers="% Non" class="gt_row gt_right">60.7%</td></tr>
    <tr><td headers="Canton" class="gt_row gt_left">Uri</td>
<td headers="Electeurs" class="gt_row gt_right">25'290</td>
<td headers="Votants" class="gt_row gt_right">19'816</td>
<td headers="% Particip." class="gt_row gt_right">78.36%</td>
<td headers="Oui" class="gt_row gt_right">4'943</td>
<td headers="Non" class="gt_row gt_right">14'728</td>
<td headers="% Oui" class="gt_row gt_right">25.1%</td>
<td headers="% Non" class="gt_row gt_right">74.9%</td></tr>
    <tr><td headers="Canton" class="gt_row gt_left">Schwyz</td>
<td headers="Electeurs" class="gt_row gt_right">77'278</td>
<td headers="Votants" class="gt_row gt_right">64'315</td>
<td headers="% Particip." class="gt_row gt_right">83.23%</td>
<td headers="Oui" class="gt_row gt_right">17'094</td>
<td headers="Non" class="gt_row gt_right">46'962</td>
<td headers="% Oui" class="gt_row gt_right">26.7%</td>
<td headers="% Non" class="gt_row gt_right">73.3%</td></tr>
    <tr><td headers="Canton" class="gt_row gt_left">Obwald</td>
<td headers="Electeurs" class="gt_row gt_right">20'713</td>
<td headers="Votants" class="gt_row gt_right">16'940</td>
<td headers="% Particip." class="gt_row gt_right">81.78%</td>
<td headers="Oui" class="gt_row gt_right">4'737</td>
<td headers="Non" class="gt_row gt_right">12'062</td>
<td headers="% Oui" class="gt_row gt_right">28.2%</td>
<td headers="% Non" class="gt_row gt_right">71.8%</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>There is one problem here: the numbers either contain “‘” or “%”. As a result, R read them as characters and it will not be possible to convert those number into numeric format unless all the’ and % are deleted.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">data2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(data, <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) {<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"'|%"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, x)})) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># collapse all ' and % in the values to transform them into numeric</span></span>
<span id="cb21-2"></span>
<span id="cb21-3">data2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb21-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_df</span>(<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) {<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"'|%"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, x)}) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># same using map_df from dplyr</span></span></code></pre></div>
</div>
<p>All the ’ and % symbols are now removed. The last step is to convert the values into numeric values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">data2[,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data2[,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb22-2">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_df</span>(as.numeric) <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## convert all columns into numeric except for canton (first column)</span></span>
<span id="cb22-3"></span>
<span id="cb22-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(data2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [27 × 8] (S3: tbl_df/tbl/data.frame)
 $ Canton     : chr [1:27] "Zurich" "Berne" "Lucerne" "Uri" ...
 $ Electeurs  : num [1:27] 768126 686459 224458 25290 77278 ...
 $ Votants    : num [1:27] 618209 540179 181614 19816 64315 ...
 $ % Particip.: num [1:27] 80.5 78.7 80.9 78.4 83.2 ...
 $ Oui        : num [1:27] 297503 255224 70878 4943 17094 ...
 $ Non        : num [1:27] 316154 281026 109447 14728 46962 ...
 $ % Oui      : num [1:27] 48.5 47.6 39.3 25.1 26.7 28.2 33.9 31.9 43.8 64.9 ...
 $ % Non      : num [1:27] 51.5 52.4 60.7 74.9 73.3 71.8 66.1 68.1 56.2 35.1 ...</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/web scraping/web_scraping_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>

 ]]></description>
  <category>web scraping</category>
  <category>data science</category>
  <guid>https://jeylal.github.io/myblog/posts/web scraping/web_scraping.html</guid>
  <pubDate>Mon, 03 Jul 2023 22:00:00 GMT</pubDate>
  <media:content url="https://jeylal.github.io/myblog/posts/web scraping/imagemediamarkt.png" medium="image" type="image/png" height="104" width="144"/>
</item>
<item>
  <title>Political stability and political crises in Switzerland: empirical evidence</title>
  <link>https://jeylal.github.io/myblog/posts/trust institution switzerland/trust institution switzerland.html</link>
  <description><![CDATA[ 




<section id="political-stability-and-crisis-in-switzerland" class="level2">
<h2 class="anchored" data-anchor-id="political-stability-and-crisis-in-switzerland">Political stability and crisis in Switzerland</h2>
<p>Switzerland is often considered as a successful and well-performing economy. The country typically ranks among the firsts in a wide variety of living standard measures such as the human development index, GDP per capita and so on. Along with the good performances of the economy, one expects that Swiss people also have more trust in their institutions compared with other countries. If one looks at, for instance, the data provided by the OECD on the confidence in government and other institutions, Switzerland is indeed one of the countries with the highest level of trust:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.oecd.org/gov/government-at-a-glance-22214399.htm"><img src="https://jeylal.github.io/myblog/posts/trust institution switzerland/graph_ocde2.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">Source: OECD (Government at Glance, 2021)</figcaption><p></p>
</figure>
</div>
<p>In Switzerland, the confidence in national government in 2020 was the highest among OECD countries with a level of 85%. Other countries like France and Italy have a level of confidence lower than the average.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.oecd.org/gov/government-at-a-glance-22214399.htm"><img src="https://jeylal.github.io/myblog/posts/trust institution switzerland/graph_ocde.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">Source: OECD (Government at Glance, 2021)</figcaption><p></p>
</figure>
</div>
<p>If one looks at other data provided by the OECD, Switzerland still ranks among the highest. In the graph above, Swiss people show a great deal of confidence in the police (about 85%), parliament (60%) and government (70%). This stands in sharp contrast with France, Italy and the US (which shows very low level of confidence in parliament with 15%). If one tries therefore to assess the evolution of trust in institutions in Switzerland, one thus expects to find a great stability. Nonetheless, one period in recent Swiss history represents an exception: the crisis of the 1990s. This period was marked by recession and was accompanied by a decline in trust in institutions <span class="citation" data-cites="brunner_crise_1997">(Brunner and Sgier 1997)</span>.</p>
<p>But why is the evolution of trust in institutions important? For my research, I am interested in social conflict, political cleavages and institutional change. The Neorealism approach developped by Amable and Palombarini <span class="citation" data-cites="amable_leconomie_2005 amable_neorealist_2008">(2005; 2008)</span>, which is dedicated to the analysis of those topics, offers insightful concepts and methods that I will mobilize here in assessing the evolution of Switzerland’s trust in its institutions in the last decades. Until now, Neorealism has been first and foremost mobilized by its founders to analyse France and Italy <span class="citation" data-cites="amable_bloc_2014 amable_illusion_2018">(Bruno Amable and Palombarini 2014, 2018)</span>. In their work, they typically start with the fact that Italy and France went under periods of deep political crises. Leaving their conceptual definitions of crisis (which are really interesting) aside and focusing only on how they identify it empirically, they typically expose data on trust in politicians, institutions, government and in political turnover. However, it is rather straightforward to anyone interested in politics and contemporary history that Italy and France underwent political crises, and data like the ones above only serve to describe well-known facts. The situation is totally different for Switzerland, which is why it is interesting to study this country in a Neorealist approach.</p>
<p>This post will hence be an attempt to periodize, analyse and assess the evolution of trust in institutions in Switzerland as a way to inderectly measure the country’s political stability through time. The objective here is, by using post-electoral survey, to identify the trends in trust in institutions and assess whether and when Switzerland can be characterized as a politically stable country, as opposed to France and Italy. The figures above already show that Switzerland is characterized with a relatively high level of trust, so the goal here is to explore other data which could also allow to see the temporal evolution and thus identify the periods of political stability and crisis in Switzerland.</p>
<section id="assessing-political-stability-in-switzerland-selects-data" class="level3">
<h3 class="anchored" data-anchor-id="assessing-political-stability-in-switzerland-selects-data">Assessing political stability in Switzerland: Selects data</h3>
<p>Let’s first see what Selects data offer. The Swiss Election Studies (SELECTS) contains a cumulative dataset which is of particular interest.</p>
<div class="cell">

</div>
<p>This dataset is in fact a harmonized dataset of all the successive post-electoral studies that have been conducted in Switzerland between 1971 and 2019 by different universities. This dataset contains a set of “trust in political institutions” variables which are of interest, but not all of them can be used because they are not avaliable for each year of the dataset. The ones which have the most time coverage are the following variables and that I will analyse here are described in the following table:</p>
<table class="table">
<colgroup>
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>Code</th>
<th>name</th>
<th>values</th>
<th>Years</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>trust1</td>
<td>trust in federal council</td>
<td>0 (no trust) to 10 (full trust) with decimal values</td>
<td>not 1979, 2015, 2019</td>
</tr>
<tr class="even">
<td>trust2</td>
<td>trust in national parliament</td>
<td>0 (no trust) to 10 (full trust) with decimal values</td>
<td>1991, 1995, 1999, 2003, 2007, 2011</td>
</tr>
<tr class="odd">
<td>trust3</td>
<td>trust in cantonal authorities</td>
<td>0 (no trust) to 10 (full trust) with decimal values</td>
<td>1995, 1999, 2003, 2007, 2011</td>
</tr>
<tr class="even">
<td>trust5</td>
<td>trust in national political parties</td>
<td>0 (no trust) to 10 (full trust) with decimal values</td>
<td>1999, 2003, 2007, 2011</td>
</tr>
<tr class="odd">
<td>eps1</td>
<td>evaluation: political system/democracy</td>
<td>scale from 0 to 1, with decimal values</td>
<td>1971, 1979, 1995, 1999, 2003, 2007, 2011, 2015, 2019</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="trust-in-federal-council" class="level2">
<h2 class="anchored" data-anchor-id="trust-in-federal-council">Trust in Federal Council</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/trust institution switzerland/trust-institution-switzerland_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<p>Here is a basic visualisation to show the distribution of the variable for each year. It is strinking how the distribution is almost the same for the years 1971-1975-1987 and then from 1995 to 2011. This suggests a great stability of trust in Federal Council, which seems rather strong. However, since the graph above is rather difficult to interpret due to the fact that it carries too much information and the scales change through the years, I will create an indicator variable to simplify the information. The dummy variable will take value 1 if the respondent takes a value higher than 5 (the middle point level of indifference), and 0 otherwise.</p>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/trust institution switzerland/trust-institution-switzerland_files/figure-html/trust1 dummy descriptive-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The graph above represents the percentage of respondents who declared to always or most of the time trust the federal council. The only period this trust declined was between 1975 and 1991. However, one should be cautious with the strong decline in 1991, because the scale (number of values the ordinal variable can take) changes for the first time for this year (see the precedent graph above). In fact, the strong decline in 1991 is surely due to the fact that the scale, by including more response choices in the survey (from 4 to 7 points scale), perhaps induced more “middle-point” responses (the middle answer is the mode for 1991). From 1995 to 2011, the trust in federal council shows a great stability, and even increases between 2007 and 2011. Nonetheless, the variable does not include data after 2011, which is unfortunate. Fortunately, there are other variables which cover a bigger time frame. In this regard, the variable on the evaluation of the Swiss democracy/political system (eps1) is interesting:</p>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/trust institution switzerland/trust-institution-switzerland_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The graph above shows how strong trust in institutions is in Switzerland and that the latter has even increased in the last years until 2019. Note that the data for 1995 have the same problem as for the year 1991 in the previous graph (change in the variable’s number of categories). I can thus conclude that the trust in institutions is not only stable in Switzerland, but even increasing. One further step, however, is to look at how trust changes if one takes education and income levels into account: do poorer people and less educated people have less trust in institutions in Switzerland? We will see that the picture is slightly more contrasted trust is analyzed for each income level.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/trust institution switzerland/trust-institution-switzerland_files/figure-html/eps1d trust and income quintiles-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>Taking into account income quintiles offer a slightly more contrasted results, but trust is high even for low income levels. There is no strong differences in trust if we compare the lowest quintile with the highest (with still somme difference in each year), but one can see that trust increases with income group: richer Swiss people (in terms of income) have more confidence in the political system/democracy in this sample.</p>
<p>Since the dataset also gives the education group, one can do the same graph above with education:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/trust institution switzerland/trust-institution-switzerland_files/figure-html/eps1 and education group-1.png" class="img-fluid" width="1248"></p>
</div>
</div>
<p>There is overall a positive association between education level and trust in democracy/political system, even though trust is high and systematically above 50% in each year (with one exception for 1979).</p>
<section id="alternative-data-source-the-european-social-survey-ess" class="level3">
<h3 class="anchored" data-anchor-id="alternative-data-source-the-european-social-survey-ess">Alternative data source: the European Social Survey (ESS)</h3>
<p>As we have seen, Selects data have some shortcomings which prevent to conduct a serious evaluation of the evolution of trust in institutions. One thus has to look at other data. To do so, I will now analyse the Swiss trust in institutions using ESS data.</p>
<table class="table">
<colgroup>
<col style="width: 25%">
<col style="width: 29%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th>variable</th>
<th>name</th>
<th>scale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>trstplt</td>
<td>trust in politician</td>
<td>0 = no trust, 10 = complete trust (discrete scale)</td>
</tr>
<tr class="even">
<td>trstprl</td>
<td>Trust in country’s parliament</td>
<td>0 = no trust, 10 = complete trust (discrete scale)</td>
</tr>
<tr class="odd">
<td>stfeco</td>
<td>How satisfied with present state of economy in country</td>
<td>0 = extremely dissatisfied, 1 = extremely satisfied (discrete scale)</td>
</tr>
<tr class="even">
<td>stfgov</td>
<td>How satisfied with the national government</td>
<td>0 = extremely dissatisfied, 1 = extremely satisfied (discrete scale)</td>
</tr>
<tr class="odd">
<td>stfdem</td>
<td>How satisfied with the way democracy works in country</td>
<td>0 = extremely dissatisfied, 1 = extremely satisfied (discrete scale)</td>
</tr>
<tr class="even">
<td>agea</td>
<td>Age of respondent, calculated</td>
<td></td>
</tr>
<tr class="odd">
<td>edulvla</td>
<td>Highest level of education</td>
<td>0 = not possible to harmonize, 1 = less than secondary, 5 = tertiary education completed</td>
</tr>
<tr class="even">
<td>edlvch</td>
<td>Highest level of education (Switzerland)</td>
<td>1 = incomplete compulsory school, 15 = university, 16 = other (discrete scale)</td>
</tr>
<tr class="odd">
<td>hinctnt</td>
<td>Household’s total net income, all sources</td>
<td></td>
</tr>
</tbody>
</table>
<p>An advantage of the ESS data compared with Selects is the comparability of the trust in institutions variables. As we saw in the first graphs, Selects have changed the scale of their variables through the years, which makes comparison difficult even with a cumulative and harmonized dataset. ESS variables (see table above) do not change their scale, so one can compare data from 2002 and 2020 without facing the problems I had with Selects data.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: le package 'naniar' a été compilé avec la version R 4.2.3</code></pre>
</div>
</div>
<p>Let’s first have a look at how the variable is distributed for a given year, for instance 2020:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/trust institution switzerland/trust-institution-switzerland_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The graph is coherent with all the previous data we saw: most Swiss people have confidence and trust in the politicians of their country in 2020. What about the evolution of this trust if one looks at all the rounds provided by ESS since 2002? To have a look a this, I load all the ESS rounds, create an indicator variable (still from the same variable, trstplt) taking value 1 if the respondent takes at least value 5 and plot the proportion for each year:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jeylal.github.io/myblog/posts/trust institution switzerland/trust in instit blog post switzerland.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>If one considers trust in politicians as a good indicator of political stability, Switzerland shows a great and increasing level of stability and it would be difficult to say that the country has known any deep political crisis in the last years. The political stability of Switzerland is even more striking when compared with countries which have known instability and systemic crises such as Italy and France:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jeylal.github.io/myblog/posts/trust institution switzerland/trust_pol_parties_ess.png" class="img-fluid figure-img" width="691"></p>
</figure>
</div>
<p><img src="https://jeylal.github.io/myblog/posts/trust institution switzerland/trust_natio_gov_ess.png" class="img-fluid"></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jeylal.github.io/myblog/posts/trust institution switzerland/trust_pol_ess.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>However, ESS data are rather limited with respect to the time frame: only data from 2002 to 2020 are available. Ideally, I would like to have data which come back at least to the 1980s. In my opinion, both Selects and ESS data have serious shortcomings that prevent any straightforward conclusion regarding the evolution of political stability in Switzerland. For this reason, I searched other data source and found one which can give better results and insights.</p>
</section>
<section id="last-data-source-vox-data" class="level3">
<h3 class="anchored" data-anchor-id="last-data-source-vox-data">Last data source: Vox data</h3>
<p>A final and last alternative data source to assess the temporal evolution of trust in institutions in Switzerland (and thus its period of political stability/crises) are the “Vox” studies, which are conducted for after Swiss referendum (“votation populaire” in French) since 1981. Kriesi, Brunner and Lorétan compiled and standardized every Vox studies from 1981 up to 2016 to create a cumulative dataset <span class="citation" data-cites="kriesi_enquetes_2017">(Kriesi, Brunner, and Lorétan 2017)</span>. This dataset has a variable of interest, “a22 (confidence in government)”, which is a binary variable (either confidence of mistrust in government). The graph below plots the percentage of respondents having confidence in government for each year:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jeylal.github.io/myblog/posts/trust institution switzerland/vox_trust_gov.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>We finally have a satisfying and valuable graph: the time frame is large enough, the variable is the same for each year and the results are far more contrasted and interesting than the previous graphs. One can see clearly different periods of declining and increasing confidence in government, which lead to the conclusion that Switzerland knew different waves of decreasing and increasing political stability as well as clear periods of political crisis. For instance, the graph illustrates well the political crisis of the 1990s: the percentage of people who declared having confidence in government fell from 65% in 1998 to 38.9% in 1995. Confidence in government then fell a for second time from 2001 (64%) to 2005 (38.4%), a period which can thus be considered as a second political crisis due to the very low level of confidence in 2005. But about the period post-2016? The shortcoming of this dataset is that it does not go beyond 2016. Fortunately, another dataset gathered data for the period 2016-2020.</p>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-amable_neorealist_2008" class="csl-entry">
Amable, B., and S. Palombarini. 2008. <span>“A Neorealist Approach to Institutional Change and the Diversity of Capitalism.”</span> <em>Socio-Economic Review</em> 7 (1): 123–43. <a href="https://doi.org/10.1093/ser/mwn018">https://doi.org/10.1093/ser/mwn018</a>.
</div>
<div id="ref-amable_leconomie_2005" class="csl-entry">
Amable, Bruno, and Stefano Palombarini. 2005. <em>L’économie Politique n’est Pas Une Science Morale</em>. Raisons d’Agir. Paris.
</div>
<div id="ref-amable_bloc_2014" class="csl-entry">
———. 2014. <span>“The Bloc Bourgeois in France and Italy.”</span> In <em>Economic Crises and Policy Regimes</em>, Edward Elgar Publishing, 177–216.
</div>
<div id="ref-amable_illusion_2018" class="csl-entry">
———. 2018. <em>L’illusion Du Bloc Bourgeois: Alliances Sociales Et Avenir Du Modèle Français</em>. Raisons d’agir. Paris.
</div>
<div id="ref-brunner_crise_1997" class="csl-entry">
Brunner, Matthias, and Lea Sgier. 1997. <span>“Crise de Confiance Dans Les Institutions Politiques Suisses? Quelques Résultats d’une Enquête d’opinion.”</span> <em>Swiss Political Science Review</em> 3 (1): 1–113.
</div>
<div id="ref-kriesi_enquetes_2017" class="csl-entry">
Kriesi, Hanspeter, Matthias Brunner, and François Lorétan. 2017. <span>“Enquêtes Standardisées <span>VoxIt</span> 1981-2016.”</span> https://doi.org/<a href="https://doi.org/10.23662/FORS-DS-688-2">https://doi.org/10.23662/FORS-DS-688-2</a>.
</div>
</div></section></div> ]]></description>
  <category>Political Economy</category>
  <category>Stats</category>
  <guid>https://jeylal.github.io/myblog/posts/trust institution switzerland/trust institution switzerland.html</guid>
  <pubDate>Sat, 24 Jun 2023 22:00:00 GMT</pubDate>
  <media:content url="https://jeylal.github.io/myblog/posts/trust institution switzerland/vox_trust_gov.png" medium="image" type="image/png" height="90" width="144"/>
</item>
<item>
  <title>Income, education and voting outcome: a cross-sectional analysis of voting outcome in Switzerland</title>
  <link>https://jeylal.github.io/myblog/posts/Vote for the left in Switzerland a simple analysis/select2019analysis.html</link>
  <description><![CDATA[ 




<section id="note-this-post-is-not-finished-and-still-in-progress" class="level2">
<h2 class="anchored" data-anchor-id="note-this-post-is-not-finished-and-still-in-progress">Note: this post is not finished and still in progress</h2>
<p>Two years ago, Piketty and his team published a fascinating book about the evolution of political cleavages in almost all democratic countries in the world and even beyond. The publication of this book and of its <a href="https://wpid.world/resources/">online database</a> got me very interested in the study of political cleavages from a political economy approach. This book contains huge amount of findings and observations, but there is one which is really emphasized by the authors: from roughly the 1980s until, the class-based political divide has become a multidimensional one incorporating a “educational” or, in Inglehart terms, a “postmaterial” or “cultural” cleavage <span class="citation" data-cites="gethin_political_2021">(Gethin, Martinez-Toledano, and Piketty 2021)</span> <span class="citation" data-cites="inglehart_silent_1971">(Inglehart 1971)</span>. Very shortly, They found that the electoral support for the left shifted from the low income and low education classes to the highly educated ones. Regarding the electoral support for the right, the latter remains positively correlated with income.</p>
<p>This post is going to simply test this finding for Switzerland using the post-electoral survey for the National Council election in 2019. The following analysis is based on data analysis of the Swiss Election Study (Selects) of 2019. The dataset can be found <a href="https://www.swissubase.ch/en/catalogue/studies/13846/18585/overview">here</a>. I will test if the support for the left is linked positively with the education level and negatively with income.</p>
<div class="cell">

</div>
<p>To analyze the link between vote for the left (dependent variable) and income and education, I create a dummy variable from the variable “W1_f1085_90” which asked for which party the respondent is going to vote for in the 2019 national council election. The indicator variable is equal to 1 if the respondent declared voting for the socialist party, the greens, the christian socialist party or for far left parties (swiss labour party, solidarités, ensemble à gauche…)</p>
<p>Regarding the independ variables, the variable “f28910” asks the gross monthly houshold income of the individual and the variable has 15 income brackets (we thus do not have directly the income of the respondant). For education, “f21310” asks the highest level of achieved education. Here is below descriptive statistics for these variables:</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jeylal.github.io/myblog/posts/Vote for the left in Switzerland a simple analysis/select2019analysis_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Education level</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jeylal.github.io/myblog/posts/Vote for the left in Switzerland a simple analysis/select2019analysis_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Gross monthly houshold income</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="first-model-binary-logistic-regression" class="level2">
<h2 class="anchored" data-anchor-id="first-model-binary-logistic-regression">First model: binary logistic regression</h2>
<p>Let’s first start with a logistic regression. I simply regress the vote for the left with income and education. I leave education and income coded as numerical variables for now, since they have enough categories this is not big problem. Of course, that would have been better if I had directly the income of each individual and not brackets. Moreover, I could still do a Pareto interpolation, but I can’t due to lack of information: I don’t have the average income (total and per bracket) of the sample.</p>
<p>The model is thus:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0ALog(%5Cfrac%7BP(left)%7D%7B1%20-%20P(left)%7D)%20=%20%5Cbeta_0%20+%20%5Cbeta_1income_i%20+%20%5Cbeta_2educ_i%20+%20%5Cepsilon_i%0A"></p>
<p>Note that this is a very first step, I will step by step complexify this model.</p>
<p>Here is the regression table:</p>

<table style="text-align:center">
<tbody><tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
vote_left
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
income
</td>
<td>
-0.075<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
education
</td>
<td>
0.111<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.008)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-1.033<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.075)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
6,866
</td>
</tr>
<tr>
<td style="text-align:left">
Log Likelihood
</td>
<td>
-4,342.283
</td>
</tr>
<tr>
<td style="text-align:left">
Akaike Inf. Crit.
</td>
<td>
8,690.566
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></em></sup><em>p&lt;0.1; <sup><strong></strong></sup><strong>p&lt;0.05; <sup></sup></strong></em>p&lt;0.01
</td>
</tr>

</tbody></table>
<p>Here is an odd ratios plot to have a better visualization of the coefficients:</p>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jeylal.github.io/myblog/posts/Vote for the left in Switzerland a simple analysis/select2019analysis_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<p>Here is what this coefficient plot tells: the odds that a Swiss voter vote for a left-wing party for the National Council election in 2019 are linked negatively with income (odd ratio below 1) and positively with education (odd ratio &gt; 1). The coefficients are statistically significant at the one percent level, which is not a surprise because the sample is rather large.</p>
<p>Odd ratios are known to be rather difficult to interpret. In effect, odd ratios are not what the literature calls “quantity of interest”, that is to say, the quantity of the dependent variable which is the most easy to interpret. I this model, the quantity of interest is the probability to vote for a left wing party and not the odds. A lot of economists and social scientists prefer to have a look directly at the marginal effects and predicted probability to have a better view of the relationships between the variables and of the quantity of interest.</p>
<p>I first plot simple graphs of the estimated curves. To do so, I use the function Invlogit from the plot3logit package and put the estimated coefficient into this function. To do such graphs, one has to make the explanatory variable on the x axis to vary while the other explanatory variables are held constant. A choice has thus to be made about which fixed value of the other factors (of Income for the education level plot and conversely), I decided to choose the median value.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jeylal.github.io/myblog/posts/Vote for the left in Switzerland a simple analysis/select2019analysis_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Probability of voting for the left - curves from estimated coefficients</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>We can see that the slope of the education level curve is steeper than the one for income: this means that the positive link between the level of education and the probability to vote for the left is greater than the negative one for income. But let’s have a look directly at the marginal effects.</p>
<p>There are a lot of different ways to compute marginal effects, which make the latter sometimes confusing because we don’t know which type of marginal effects we are talking about. I will here consider one type of marginal effects:</p>
<ul>
<li>Group-average marginal effects: slope estimates are produced for each row of the dataset used in computing the model. Then, the estimates can be grouped by the values of one of the regressor and the average for each group is computed.</li>
</ul>
<p>A first step in group-average marginal effects in R is to use the function “slopes” which calculate estimates of the slopes (marginal effects) for each observation used to compute the model in the first place. The term “variables” is for the variable for which the slopes are estimated and “by” the argument for</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">marginaleffectseduc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slopes</span>(reg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variables =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"education"</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(marginaleffectseduc)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
      Term Estimate Std. Error    z Pr(&gt;|z|)  2.5 % 97.5 %
 education   0.0216    0.00156 13.9   &lt;0.001 0.0186 0.0247
 education   0.0277    0.00212 13.1   &lt;0.001 0.0236 0.0319
 education   0.0253    0.00204 12.4   &lt;0.001 0.0213 0.0293
 education   0.0261    0.00212 12.3   &lt;0.001 0.0219 0.0303
 education   0.0266    0.00202 13.2   &lt;0.001 0.0226 0.0306
 education   0.0220    0.00165 13.3   &lt;0.001 0.0188 0.0252

Columns: rowid, term, estimate, std.error, statistic, p.value, conf.low, conf.high, predicted, predicted_hi, predicted_lo, vote_left, income, education </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(marginaleffectseduc)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6866   14</code></pre>
</div>
</div>
<p>The dataframe has 5607 rows which is the same number of observation used in the model. We can then used the different values of income level (from 1 to 15) as grouped within which estimates are averaged:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">marginaleffectseduc <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(income) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean.slopes.educ =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(estimate),</span>
<span id="cb5-4">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">conf.high =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(conf.high), <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## this is the same for the confidence interval</span></span>
<span id="cb5-5">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">conf.low =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(conf.low)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> game.educ</span>
<span id="cb5-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(game.educ)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  income                  mean.slopes.educ conf.high conf.low
  &lt;dbl+lbl&gt;                          &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 1 [Less than 2'000 CHF]           0.0262    0.0299   0.0225
2 2 [2'001-3'000 CHF]               0.0258    0.0294   0.0221
3 3 [3'001-4'000 CHF]               0.0255    0.0290   0.0219
4 4 [4'001-5'000 CHF]               0.0251    0.0286   0.0216
5 5 [5'001-6'000 CHF]               0.0250    0.0285   0.0215
6 6 [6'001-7'000 CHF]               0.0250    0.0285   0.0214</code></pre>
</div>
</div>
<p>A plot can then be made to have a better view of the average marginal effects/slopes of education for each group of income:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">game.educ <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> income, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> mean.slopes.educ)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_ribbon</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> conf.low, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> conf.high), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Group-average marginal effect of education for each level of income group"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Slopes education"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jeylal.github.io/myblog/posts/Vote for the left in Switzerland a simple analysis/select2019analysis_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The slope of education level decreases on average with higher values of income group. This means that even if the probability to vote for the left is linked positively with education level, this link is weaker for higher income groups. However, it is not so much weaker because even though th line is downward slopping, it remains rather flat.</p>
<p>Normally, the function plot_slope should produce the same graph:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_slopes</span>(reg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variables =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"education"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"income"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jeylal.github.io/myblog/posts/Vote for the left in Switzerland a simple analysis/select2019analysis_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let’s do the same for income:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">marginaleffectsinc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slopes</span>(reg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variables =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"income"</span>)</span>
<span id="cb9-2">game.inc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> marginaleffectsinc <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(education) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean.slopes.inc =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(estimate),</span>
<span id="cb9-5">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">conf.high =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(conf.high),</span>
<span id="cb9-6">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">conf.low =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(conf.low)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> game.inc</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">game.inc <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> education, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> mean.slopes.inc)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_ribbon</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> conf.low, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> conf.high), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Group-average marginal effects of income for each level of education"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Slopes income"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jeylal.github.io/myblog/posts/Vote for the left in Switzerland a simple analysis/select2019analysis_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here the result is more interesting: the average marginal slope of income is negative for each education level but this average decreases with higher level of education. This implies that the probability to vote for the left is linked negatively with income group and that this negative link is strengthened by higher level of education. Rich and highly educated people have thus a very low probability to vote for the left.</p>
<p>Another way to look at the effect of the two independent variable on the probability to vote for the left is to look at the predictions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">predictionseduc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predictions</span>(reg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variables =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"education"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"income"</span>))</span>
<span id="cb11-2">predictionseduc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predictions</span>(reg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"education"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"income"</span>))</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_predictions</span>(reg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">condition =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"education"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"income"</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Set1"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Set1"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>),</span>
<span id="cb12-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"probability vote left"</span>) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> plotpredicteduc</span>
<span id="cb12-8"></span>
<span id="cb12-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_predictions</span>(reg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">condition =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"income"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"education"</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Set1"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Set1"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>),</span>
<span id="cb12-14">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> plotpredictincome</span>
<span id="cb12-16"></span>
<span id="cb12-17">cowplot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_grid</span>(plotpredicteduc, plotpredictincome)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jeylal.github.io/myblog/posts/Vote for the left in Switzerland a simple analysis/select2019analysis_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Those plots are essentially the same the first one, but with the confidence interval and for different values of the regressor considered fixed for certain values.</p>
<p>Another way is to compute directly the average marginal effects without grouping:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">marginaleffectsinc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slopes</span>(reg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variables =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"income"</span>)</span>
<span id="cb13-2">marginaleffectseduc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slopes</span>(reg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variables =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"education"</span>)</span>
<span id="cb13-3">avg_effect_summary_reg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(marginaleffectsinc), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(marginaleffectseduc))</span>
<span id="cb13-4"></span>
<span id="cb13-5">avg_effect_summary_reg</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
      Term    Contrast Estimate Std. Error     z Pr(&gt;|z|)   2.5 %  97.5 %
 income    mean(dY/dX)  -0.0167    0.00150 -11.1   &lt;0.001 -0.0196 -0.0137
 education mean(dY/dX)   0.0245    0.00177  13.9   &lt;0.001  0.0210  0.0279

Columns: term, contrast, estimate, std.error, statistic, p.value, conf.low, conf.high </code></pre>
</div>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margins_summary</span>(reg)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    factor     AME     SE        z      p   lower   upper
 education  0.0245 0.0018  13.8684 0.0000  0.0210  0.0279
    income -0.0167 0.0015 -11.0920 0.0000 -0.0196 -0.0137</code></pre>
</div>
</div>
<p>Here is a nice way to visualize the table above:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">avg_effect_summary_reg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb17-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> estimate<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> term)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_pointrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> conf.low<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> conf.high<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Average marginal effects (percentage points)"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_label</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(estimate<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jeylal.github.io/myblog/posts/Vote for the left in Switzerland a simple analysis/select2019analysis_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The advantage of average marginal effects is the fact that they give information on the quantity of interest (here the probability to vote for the left) instead of odd ratio or log odds. The probability to vote for the left decreases on average by -1.6 percentage points if we compare two units which only differs by one income group level. Conversely, the probability increases on average by 2.5 percentage points if we compare two units which only differs by one level of education.</p>
</section>
<section id="complexifying-the-model" class="level2">
<h2 class="anchored" data-anchor-id="complexifying-the-model">Complexifying the model</h2>
<section id="hierarchical-model" class="level3">
<h3 class="anchored" data-anchor-id="hierarchical-model">Hierarchical model</h3>
<p>One possible and interesting way to complexify the model is to include the different Swiss canton into the regression. In fact, the previous regression model can be considered as a “complete pooling” model in which I made the asumption that the slopes of the coefficients do not vary by cantons. However, cantons represents an important level of analysis in Switzerland, because elections and politics are a lot structures at the cantonal level. Cantons can thus be considered as levels in which the observed individuals in our sample are grouped.</p>
<p>According to <span class="citation" data-cites="gelman_data_2007">Gelman and Hill (2007)</span> there are two main differents ways to consider these groups in regression analysis:</p>
<ol type="1">
<li><p>No pooling models: the slopes and/or the intercepts are allowed to vary across the groups freely.</p></li>
<li><p>Partial pooling models: the slopes and/or the intercepts are allowed to vary, but they are modeled (we consider that they follow a normal distribution)</p></li>
</ol>
<p>In the present analysis, I will consider a partial pooling model in which the slopes and intercepts for income and education can vary. In R, partial pooling models can be estimated with the function lmer() from the lme4 package.</p>
<p>The results of this model can be then represented through a table with tab_model()</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_model</span>(glmer1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">transform =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Partial Pooling model"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<caption style="font-weight: bold; text-align:left;">Partial Pooling model</caption>
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">vote_left</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Log-Odds</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.088</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.382&nbsp;–&nbsp;-0.793</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Gross monthly household<br>income, W1 updated with<br>W4</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.076</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.095&nbsp;–&nbsp;-0.058</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">education</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.106</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.087&nbsp;–&nbsp;0.126</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>region</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.33</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>region.education</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.00</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>region.income</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.00</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">-0.82</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">-0.61</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>region</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">26</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">6866</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.041 / NA</td>
</tr>

</tbody></table>

</div>
</div>
<p>The random effects coefficients at the cantons level for income and education are 0, which implies that there is very low variation between cantons. Furthermore, the fixed effect coefficients are almost the same than the previous model: this new model is thus not a big improvement and shows that including cantons as a group does not change the model a lot.</p>
<p>However, it is still interesting to plot predicted probabilities to have a better overview:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_predictions</span>(glmer1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">condition =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"education"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"income"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"region"</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>region)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> income)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Set1"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probabilités prédites selon le niveau d'éducation, pour chaque canton et pour différent niveau de revenu"</span>,</span>
<span id="cb19-5">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Election Conseil National 2015"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jeylal.github.io/myblog/posts/Vote for the left in Switzerland a simple analysis/select2019analysis_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>The relationship between the predicted probabilities to vote for the left and education is positive for every cantons. There are a lot of cantons that show similar relationships and curves and whose predicted probabilities, despite the positive link with education, do not go above 0.5 (with some exception such as Aargau, Thurgau, Tessin, Valais, Glarus…). The cantons which show different patterns are Basel-Stadt, Geneva, Jura, Vaud and Neuchâtel with higher predicted probabilities.</p>
</section>
<section id="adding-variables-to-the-model" class="level3">
<h3 class="anchored" data-anchor-id="adding-variables-to-the-model">Adding variables to the model</h3>
<p>Let’s now add some control variables to the model. The models above are flawed by the fact that there are only two regressors. One important assumption of regression models are the mean independence of the covariates with the error term. The model is assumed to include all the important explanatory variables in the model. If not, the estimates will be biased, so one can suspect that the coefficients estimates for this first model are heavily biased.</p>
<p>For the second model, I include gender (dummy with female = 1), age (in categories), religiosity (the higher, the less religious is the respondent), a variable indicating whether the respondent has a full-time job (full_time), whether the respondent works in the public sector (public) and marital status. I also include variables on issue position related to socio-economic issues such as EU integration, taxation and attitude towards foreigners (each one of these variables are ordinal on a 1-5 scale). Finally, I run the same model for the other main parties in Switzerland: the liberal radical party (center-right, plr), the Swiss people’s party (far-right, udc) and the two greens party (the greens, the liberal greens).</p>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">marginsfull <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb20-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> AME<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> factor, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> party, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> party)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_pointrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> lower<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> upper<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Average marginal effects (percentage points)"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2019 Swiss national council election"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb20-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>party)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb20-12">        )</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jeylal.github.io/myblog/posts/Vote for the left in Switzerland a simple analysis/select2019analysis_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-gelman_data_2007" class="csl-entry">
Gelman, Andrew, and Jennifer Hill. 2007. <em>Data Analysis Using Regression and Multilevel/Hierarchical Models</em>. Cambridge University Press.
</div>
<div id="ref-gethin_political_2021" class="csl-entry">
Gethin, Armory, Clara Martinez-Toledano, and Thomas Piketty. 2021. <em>Political Cleavages and Social Inequalities a Study of Fifty Democracies, 1948–2020</em>. Harvard Univeristy Press.
</div>
<div id="ref-inglehart_silent_1971" class="csl-entry">
Inglehart, Ronald. 1971. <span>“The Silent Revolution in Europe: Intergenerational Change in Post-Industrial Societies.”</span> <em>The American Political Science Review</em> 65 (4): 991–1017. <a href="https://www.jstor.org/stable/1953494">https://www.jstor.org/stable/1953494</a>.
</div>
</div></section></div> ]]></description>
  <category>Political Economy</category>
  <category>Stats</category>
  <guid>https://jeylal.github.io/myblog/posts/Vote for the left in Switzerland a simple analysis/select2019analysis.html</guid>
  <pubDate>Tue, 09 May 2023 22:00:00 GMT</pubDate>
  <media:content url="https://jeylal.github.io/myblog/posts/Vote for the left in Switzerland a simple analysis/image.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>From income brackets to income decile</title>
  <link>https://jeylal.github.io/myblog/posts/Techinal notes of political cleavages and inequality/technical note piketty 2021.html</link>
  <description><![CDATA[ 




<div class="cell">

</div>
<section id="how-far-can-we-go-with-income-brackets-in-progress" class="level2">
<h2 class="anchored" data-anchor-id="how-far-can-we-go-with-income-brackets-in-progress">How far can we go with income brackets? (in progress)</h2>
<p>To build their database on <a href="https://wpid.world/">World political cleavages and inequality</a>, Piketty and his team had to use electoral survey data. One problem with these sources is that they collect income data through brackets, without reporting the overall income average of the sample or the average per bracket. This Thus poses the question of how far one can go in terms of statistical analysis with only income brackets as a source of information for income. I will here explore what can be done with such a variable as well as the <a href="https://wid.world/document/building-the-world-political-cleavages-and-inequality-database-a-new-dataset-on-electoral-behaviors-in-50-democracies-1948-2020-world-inequality-lab-technical-note-2021-01/">technical note</a> that Piketty et al.&nbsp;(2021) provides to explain how they computed the vote share for income and education decile, which they claim is one of their main contributions on political cleavages and inequality.</p>
<section id="from-brackets-to-decile" class="level3">
<h3 class="anchored" data-anchor-id="from-brackets-to-decile">From brackets to decile</h3>
<p>The wpid is based on an impressive <a href="https://wpid.world/resources/en/zip/wpid-micro.zip">dataset</a> compiling electoral survey data of 500 elections since 1948. Since the technical note takes Canada’s 2015 election as an example, I will use the latter here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">list =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span>())</span>
<span id="cb1-2">ca <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_dta</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ca.dta"</span>)</span>
<span id="cb1-3">ca2015 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ca <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2015</span>)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(ca)</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(ca2015<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>inc))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8 10 11 12 13 14 15 16 17 18 19 20</code></pre>
</div>
</div>
<p>Note that there is already something going on here: in the dataset, the variable income has 19 brackets/categories here whereas it has 18 in the technical note. Furthermore, income brackets “jump” from 8 to 10. I will ignore these issues and still work with this dataset, we just won’t have the same results as in Piketty &amp; al’s example.</p>
<p>A first step in analyzing such a variable is to compute the frequency, relative frequency and the cumulative frequencies. More precisely, I will construct two tables. On the one hand, I compute the descriptive statistics for the NDP’s voters within each income brackets. On the other hand, I construct a table for the overall distribution of income brackets for the NPD’s voters only. Note that I directly add the proportion of NDP’s voters from the first table to the second one to simplify further calculations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">ca2015 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(inc) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(votendp) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_na</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cum.n =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(n),</span>
<span id="cb3-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(n)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> table.income.pervote</span>
<span id="cb3-8"></span>
<span id="cb3-9">ca2015 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(votendp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(inc) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(votendp) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_na</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop_vote =</span> table.income.pervote<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prop[table.income.pervote<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>votendp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb3-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cum.n =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(n),</span>
<span id="cb3-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(n),</span>
<span id="cb3-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rangeleft =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lag</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(prop), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb3-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cumrelfreqN =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(prop),</span>
<span id="cb3-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cumrelfreqInc =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(inc<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(inc))) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> table.income</span>
<span id="cb3-21"></span>
<span id="cb3-22">table.income.pervote <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of the vote for the NDP by income group"</span>)</span></code></pre></div>
<div class="cell-output-display">

<div id="pcqmnerzop" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#pcqmnerzop) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#pcqmnerzop) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#pcqmnerzop) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#pcqmnerzop) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#pcqmnerzop) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#pcqmnerzop) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#pcqmnerzop) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#pcqmnerzop) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#pcqmnerzop) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#pcqmnerzop) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#pcqmnerzop) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#pcqmnerzop) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#pcqmnerzop) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#pcqmnerzop) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#pcqmnerzop) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#pcqmnerzop) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#pcqmnerzop) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#pcqmnerzop) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#pcqmnerzop) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#pcqmnerzop) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#pcqmnerzop) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#pcqmnerzop) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#pcqmnerzop) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#pcqmnerzop) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#pcqmnerzop) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#pcqmnerzop) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#pcqmnerzop) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#pcqmnerzop) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#pcqmnerzop) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#pcqmnerzop) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#pcqmnerzop) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#pcqmnerzop) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#pcqmnerzop) .gt_left {
  text-align: left;
}

:where(#pcqmnerzop) .gt_center {
  text-align: center;
}

:where(#pcqmnerzop) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#pcqmnerzop) .gt_font_normal {
  font-weight: normal;
}

:where(#pcqmnerzop) .gt_font_bold {
  font-weight: bold;
}

:where(#pcqmnerzop) .gt_font_italic {
  font-style: italic;
}

:where(#pcqmnerzop) .gt_super {
  font-size: 65%;
}

:where(#pcqmnerzop) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#pcqmnerzop) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#pcqmnerzop) .gt_indent_1 {
  text-indent: 5px;
}

:where(#pcqmnerzop) .gt_indent_2 {
  text-indent: 10px;
}

:where(#pcqmnerzop) .gt_indent_3 {
  text-indent: 15px;
}

:where(#pcqmnerzop) .gt_indent_4 {
  text-indent: 20px;
}

:where(#pcqmnerzop) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  <caption>Distribution of the vote for the NDP by income group</caption>
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="inc">inc</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="votendp">votendp</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cum.n">cum.n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="prop">prop</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="inc" class="gt_row gt_right">1</td>
<td headers="votendp" class="gt_row gt_right">0</td>
<td headers="n" class="gt_row gt_right">114</td>
<td headers="cum.n" class="gt_row gt_right">114</td>
<td headers="prop" class="gt_row gt_right">0.6826347</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">1</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">53</td>
<td headers="cum.n" class="gt_row gt_right">167</td>
<td headers="prop" class="gt_row gt_right">0.3173653</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">2</td>
<td headers="votendp" class="gt_row gt_right">0</td>
<td headers="n" class="gt_row gt_right">161</td>
<td headers="cum.n" class="gt_row gt_right">161</td>
<td headers="prop" class="gt_row gt_right">0.7419355</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">2</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">56</td>
<td headers="cum.n" class="gt_row gt_right">217</td>
<td headers="prop" class="gt_row gt_right">0.2580645</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">3</td>
<td headers="votendp" class="gt_row gt_right">0</td>
<td headers="n" class="gt_row gt_right">49</td>
<td headers="cum.n" class="gt_row gt_right">49</td>
<td headers="prop" class="gt_row gt_right">0.7656250</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">3</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">15</td>
<td headers="cum.n" class="gt_row gt_right">64</td>
<td headers="prop" class="gt_row gt_right">0.2343750</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">4</td>
<td headers="votendp" class="gt_row gt_right">0</td>
<td headers="n" class="gt_row gt_right">129</td>
<td headers="cum.n" class="gt_row gt_right">129</td>
<td headers="prop" class="gt_row gt_right">0.7865854</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">4</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">35</td>
<td headers="cum.n" class="gt_row gt_right">164</td>
<td headers="prop" class="gt_row gt_right">0.2134146</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">5</td>
<td headers="votendp" class="gt_row gt_right">0</td>
<td headers="n" class="gt_row gt_right">108</td>
<td headers="cum.n" class="gt_row gt_right">108</td>
<td headers="prop" class="gt_row gt_right">0.6708075</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">5</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">53</td>
<td headers="cum.n" class="gt_row gt_right">161</td>
<td headers="prop" class="gt_row gt_right">0.3291925</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">6</td>
<td headers="votendp" class="gt_row gt_right">0</td>
<td headers="n" class="gt_row gt_right">112</td>
<td headers="cum.n" class="gt_row gt_right">112</td>
<td headers="prop" class="gt_row gt_right">0.7044025</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">6</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">47</td>
<td headers="cum.n" class="gt_row gt_right">159</td>
<td headers="prop" class="gt_row gt_right">0.2955975</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">7</td>
<td headers="votendp" class="gt_row gt_right">0</td>
<td headers="n" class="gt_row gt_right">114</td>
<td headers="cum.n" class="gt_row gt_right">114</td>
<td headers="prop" class="gt_row gt_right">0.7215190</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">7</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">44</td>
<td headers="cum.n" class="gt_row gt_right">158</td>
<td headers="prop" class="gt_row gt_right">0.2784810</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">8</td>
<td headers="votendp" class="gt_row gt_right">0</td>
<td headers="n" class="gt_row gt_right">244</td>
<td headers="cum.n" class="gt_row gt_right">244</td>
<td headers="prop" class="gt_row gt_right">0.7746032</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">8</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">71</td>
<td headers="cum.n" class="gt_row gt_right">315</td>
<td headers="prop" class="gt_row gt_right">0.2253968</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">10</td>
<td headers="votendp" class="gt_row gt_right">0</td>
<td headers="n" class="gt_row gt_right">140</td>
<td headers="cum.n" class="gt_row gt_right">140</td>
<td headers="prop" class="gt_row gt_right">0.8045977</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">10</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">34</td>
<td headers="cum.n" class="gt_row gt_right">174</td>
<td headers="prop" class="gt_row gt_right">0.1954023</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">11</td>
<td headers="votendp" class="gt_row gt_right">0</td>
<td headers="n" class="gt_row gt_right">114</td>
<td headers="cum.n" class="gt_row gt_right">114</td>
<td headers="prop" class="gt_row gt_right">0.7651007</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">11</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">35</td>
<td headers="cum.n" class="gt_row gt_right">149</td>
<td headers="prop" class="gt_row gt_right">0.2348993</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">12</td>
<td headers="votendp" class="gt_row gt_right">0</td>
<td headers="n" class="gt_row gt_right">154</td>
<td headers="cum.n" class="gt_row gt_right">154</td>
<td headers="prop" class="gt_row gt_right">0.7549020</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">12</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">50</td>
<td headers="cum.n" class="gt_row gt_right">204</td>
<td headers="prop" class="gt_row gt_right">0.2450980</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">13</td>
<td headers="votendp" class="gt_row gt_right">0</td>
<td headers="n" class="gt_row gt_right">105</td>
<td headers="cum.n" class="gt_row gt_right">105</td>
<td headers="prop" class="gt_row gt_right">0.7894737</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">13</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">28</td>
<td headers="cum.n" class="gt_row gt_right">133</td>
<td headers="prop" class="gt_row gt_right">0.2105263</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">14</td>
<td headers="votendp" class="gt_row gt_right">0</td>
<td headers="n" class="gt_row gt_right">208</td>
<td headers="cum.n" class="gt_row gt_right">208</td>
<td headers="prop" class="gt_row gt_right">0.7878788</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">14</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">56</td>
<td headers="cum.n" class="gt_row gt_right">264</td>
<td headers="prop" class="gt_row gt_right">0.2121212</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">15</td>
<td headers="votendp" class="gt_row gt_right">0</td>
<td headers="n" class="gt_row gt_right">95</td>
<td headers="cum.n" class="gt_row gt_right">95</td>
<td headers="prop" class="gt_row gt_right">0.8333333</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">15</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">19</td>
<td headers="cum.n" class="gt_row gt_right">114</td>
<td headers="prop" class="gt_row gt_right">0.1666667</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">16</td>
<td headers="votendp" class="gt_row gt_right">0</td>
<td headers="n" class="gt_row gt_right">113</td>
<td headers="cum.n" class="gt_row gt_right">113</td>
<td headers="prop" class="gt_row gt_right">0.8129496</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">16</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">26</td>
<td headers="cum.n" class="gt_row gt_right">139</td>
<td headers="prop" class="gt_row gt_right">0.1870504</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">17</td>
<td headers="votendp" class="gt_row gt_right">0</td>
<td headers="n" class="gt_row gt_right">171</td>
<td headers="cum.n" class="gt_row gt_right">171</td>
<td headers="prop" class="gt_row gt_right">0.8300971</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">17</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">35</td>
<td headers="cum.n" class="gt_row gt_right">206</td>
<td headers="prop" class="gt_row gt_right">0.1699029</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">18</td>
<td headers="votendp" class="gt_row gt_right">0</td>
<td headers="n" class="gt_row gt_right">83</td>
<td headers="cum.n" class="gt_row gt_right">83</td>
<td headers="prop" class="gt_row gt_right">0.7830189</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">18</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">23</td>
<td headers="cum.n" class="gt_row gt_right">106</td>
<td headers="prop" class="gt_row gt_right">0.2169811</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">19</td>
<td headers="votendp" class="gt_row gt_right">0</td>
<td headers="n" class="gt_row gt_right">143</td>
<td headers="cum.n" class="gt_row gt_right">143</td>
<td headers="prop" class="gt_row gt_right">0.8171429</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">19</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">32</td>
<td headers="cum.n" class="gt_row gt_right">175</td>
<td headers="prop" class="gt_row gt_right">0.1828571</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">20</td>
<td headers="votendp" class="gt_row gt_right">0</td>
<td headers="n" class="gt_row gt_right">145</td>
<td headers="cum.n" class="gt_row gt_right">145</td>
<td headers="prop" class="gt_row gt_right">0.8734940</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">20</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">21</td>
<td headers="cum.n" class="gt_row gt_right">166</td>
<td headers="prop" class="gt_row gt_right">0.1265060</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">table.income <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of income group among NDP's voters"</span>)</span></code></pre></div>
<div class="cell-output-display">

<div id="lkgbncgpvg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#lkgbncgpvg) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#lkgbncgpvg) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#lkgbncgpvg) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#lkgbncgpvg) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#lkgbncgpvg) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#lkgbncgpvg) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#lkgbncgpvg) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#lkgbncgpvg) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#lkgbncgpvg) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#lkgbncgpvg) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#lkgbncgpvg) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#lkgbncgpvg) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#lkgbncgpvg) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#lkgbncgpvg) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#lkgbncgpvg) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#lkgbncgpvg) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#lkgbncgpvg) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#lkgbncgpvg) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#lkgbncgpvg) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#lkgbncgpvg) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#lkgbncgpvg) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#lkgbncgpvg) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#lkgbncgpvg) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#lkgbncgpvg) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#lkgbncgpvg) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#lkgbncgpvg) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#lkgbncgpvg) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#lkgbncgpvg) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#lkgbncgpvg) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#lkgbncgpvg) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#lkgbncgpvg) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#lkgbncgpvg) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#lkgbncgpvg) .gt_left {
  text-align: left;
}

:where(#lkgbncgpvg) .gt_center {
  text-align: center;
}

:where(#lkgbncgpvg) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#lkgbncgpvg) .gt_font_normal {
  font-weight: normal;
}

:where(#lkgbncgpvg) .gt_font_bold {
  font-weight: bold;
}

:where(#lkgbncgpvg) .gt_font_italic {
  font-style: italic;
}

:where(#lkgbncgpvg) .gt_super {
  font-size: 65%;
}

:where(#lkgbncgpvg) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#lkgbncgpvg) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#lkgbncgpvg) .gt_indent_1 {
  text-indent: 5px;
}

:where(#lkgbncgpvg) .gt_indent_2 {
  text-indent: 10px;
}

:where(#lkgbncgpvg) .gt_indent_3 {
  text-indent: 15px;
}

:where(#lkgbncgpvg) .gt_indent_4 {
  text-indent: 20px;
}

:where(#lkgbncgpvg) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  <caption>Distribution of income group among NDP's voters</caption>
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="inc">inc</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="votendp">votendp</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="prop_vote">prop_vote</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cum.n">cum.n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="prop">prop</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rangeleft">rangeleft</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cumrelfreqN">cumrelfreqN</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cumrelfreqInc">cumrelfreqInc</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="inc" class="gt_row gt_right">1</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">53</td>
<td headers="prop_vote" class="gt_row gt_right">0.3173653</td>
<td headers="cum.n" class="gt_row gt_right">53</td>
<td headers="prop" class="gt_row gt_right">0.07230559</td>
<td headers="rangeleft" class="gt_row gt_right">0.00000000</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.07230559</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.004975124</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">2</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">56</td>
<td headers="prop_vote" class="gt_row gt_right">0.2580645</td>
<td headers="cum.n" class="gt_row gt_right">109</td>
<td headers="prop" class="gt_row gt_right">0.07639836</td>
<td headers="rangeleft" class="gt_row gt_right">0.07230559</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.14870396</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.014925373</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">3</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">15</td>
<td headers="prop_vote" class="gt_row gt_right">0.2343750</td>
<td headers="cum.n" class="gt_row gt_right">124</td>
<td headers="prop" class="gt_row gt_right">0.02046385</td>
<td headers="rangeleft" class="gt_row gt_right">0.14870396</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.16916780</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.029850746</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">4</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">35</td>
<td headers="prop_vote" class="gt_row gt_right">0.2134146</td>
<td headers="cum.n" class="gt_row gt_right">159</td>
<td headers="prop" class="gt_row gt_right">0.04774898</td>
<td headers="rangeleft" class="gt_row gt_right">0.16916780</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.21691678</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.049751244</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">5</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">53</td>
<td headers="prop_vote" class="gt_row gt_right">0.3291925</td>
<td headers="cum.n" class="gt_row gt_right">212</td>
<td headers="prop" class="gt_row gt_right">0.07230559</td>
<td headers="rangeleft" class="gt_row gt_right">0.21691678</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.28922237</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.074626866</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">6</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">47</td>
<td headers="prop_vote" class="gt_row gt_right">0.2955975</td>
<td headers="cum.n" class="gt_row gt_right">259</td>
<td headers="prop" class="gt_row gt_right">0.06412005</td>
<td headers="rangeleft" class="gt_row gt_right">0.28922237</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.35334243</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.104477612</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">7</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">44</td>
<td headers="prop_vote" class="gt_row gt_right">0.2784810</td>
<td headers="cum.n" class="gt_row gt_right">303</td>
<td headers="prop" class="gt_row gt_right">0.06002729</td>
<td headers="rangeleft" class="gt_row gt_right">0.35334243</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.41336971</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.139303483</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">8</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">71</td>
<td headers="prop_vote" class="gt_row gt_right">0.2253968</td>
<td headers="cum.n" class="gt_row gt_right">374</td>
<td headers="prop" class="gt_row gt_right">0.09686221</td>
<td headers="rangeleft" class="gt_row gt_right">0.41336971</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.51023192</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.179104478</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">10</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">34</td>
<td headers="prop_vote" class="gt_row gt_right">0.1954023</td>
<td headers="cum.n" class="gt_row gt_right">408</td>
<td headers="prop" class="gt_row gt_right">0.04638472</td>
<td headers="rangeleft" class="gt_row gt_right">0.51023192</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.55661664</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.228855721</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">11</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">35</td>
<td headers="prop_vote" class="gt_row gt_right">0.2348993</td>
<td headers="cum.n" class="gt_row gt_right">443</td>
<td headers="prop" class="gt_row gt_right">0.04774898</td>
<td headers="rangeleft" class="gt_row gt_right">0.55661664</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.60436562</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.283582090</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">12</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">50</td>
<td headers="prop_vote" class="gt_row gt_right">0.2450980</td>
<td headers="cum.n" class="gt_row gt_right">493</td>
<td headers="prop" class="gt_row gt_right">0.06821282</td>
<td headers="rangeleft" class="gt_row gt_right">0.60436562</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.67257844</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.343283582</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">13</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">28</td>
<td headers="prop_vote" class="gt_row gt_right">0.2105263</td>
<td headers="cum.n" class="gt_row gt_right">521</td>
<td headers="prop" class="gt_row gt_right">0.03819918</td>
<td headers="rangeleft" class="gt_row gt_right">0.67257844</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.71077763</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.407960199</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">14</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">56</td>
<td headers="prop_vote" class="gt_row gt_right">0.2121212</td>
<td headers="cum.n" class="gt_row gt_right">577</td>
<td headers="prop" class="gt_row gt_right">0.07639836</td>
<td headers="rangeleft" class="gt_row gt_right">0.71077763</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.78717599</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.477611940</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">15</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">19</td>
<td headers="prop_vote" class="gt_row gt_right">0.1666667</td>
<td headers="cum.n" class="gt_row gt_right">596</td>
<td headers="prop" class="gt_row gt_right">0.02592087</td>
<td headers="rangeleft" class="gt_row gt_right">0.78717599</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.81309686</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.552238806</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">16</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">26</td>
<td headers="prop_vote" class="gt_row gt_right">0.1870504</td>
<td headers="cum.n" class="gt_row gt_right">622</td>
<td headers="prop" class="gt_row gt_right">0.03547067</td>
<td headers="rangeleft" class="gt_row gt_right">0.81309686</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.84856753</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.631840796</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">17</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">35</td>
<td headers="prop_vote" class="gt_row gt_right">0.1699029</td>
<td headers="cum.n" class="gt_row gt_right">657</td>
<td headers="prop" class="gt_row gt_right">0.04774898</td>
<td headers="rangeleft" class="gt_row gt_right">0.84856753</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.89631651</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.716417910</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">18</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">23</td>
<td headers="prop_vote" class="gt_row gt_right">0.2169811</td>
<td headers="cum.n" class="gt_row gt_right">680</td>
<td headers="prop" class="gt_row gt_right">0.03137790</td>
<td headers="rangeleft" class="gt_row gt_right">0.89631651</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.92769441</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.805970149</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">19</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">32</td>
<td headers="prop_vote" class="gt_row gt_right">0.1828571</td>
<td headers="cum.n" class="gt_row gt_right">712</td>
<td headers="prop" class="gt_row gt_right">0.04365621</td>
<td headers="rangeleft" class="gt_row gt_right">0.92769441</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.97135061</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.900497512</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">20</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">21</td>
<td headers="prop_vote" class="gt_row gt_right">0.1265060</td>
<td headers="cum.n" class="gt_row gt_right">733</td>
<td headers="prop" class="gt_row gt_right">0.02864939</td>
<td headers="rangeleft" class="gt_row gt_right">0.97135061</td>
<td headers="cumrelfreqN" class="gt_row gt_right">1.00000000</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">1.000000000</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>We can then plot income groups against their proportion</p>
<div class="cell fig-cap-location-top">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">table.income.pervote <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(votendp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(inc), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> prop)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Income group"</span>) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> income.group.plot</span>
<span id="cb5-7"></span>
<span id="cb5-8">table.income <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(inc), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> prop) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> income.group.plot2</span>
<span id="cb5-15">  </span>
<span id="cb5-16"></span>
<span id="cb5-17">cowplot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_grid</span>(income.group.plot, income.group.plot2)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jeylal.github.io/myblog/posts/Techinal notes of political cleavages and inequality/technical-note-piketty-2021_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Distribution of Income groups: Canadian 2015 election survey</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>On the left, we have a graph very similar to the one of the technical note. The right-sided graph is different, because the proportion are for the overall NPD’s voters whereas the left-sided graph represents the proportion within the income group. For example, 30% of income bracket 1 voted for the NDP, but they represent about 7.4% of total NDP’s voters.</p>
<p>What makes Piketty’s team approach special and interesting is their systematic analysis in terms of quantile groups. This is, according to them, their main contribution and this approach has the advantage to allow for systematic comparison accross space and time. We will try to reproduce here their conversion of income group into quantiles.</p>
<p>In R, the decile for each observation can be added to the dataset with the function ntile():</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">ca2015 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ca2015 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb6-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decile =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ntile</span>(inc, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb6-4">)</span></code></pre></div>
</div>
<p>Now, the last column of ca2015 is the decile for each observation in the dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">ca2015 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(decile) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(votendp) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(votendp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_na</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(n)) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> table.income.vote</span>
<span id="cb7-8"></span>
<span id="cb7-9">table.income.vote <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Decile and income bracket"</span>)</span></code></pre></div>
<div class="cell-output-display">

<div id="ktjbvxmzcn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#ktjbvxmzcn) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#ktjbvxmzcn) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#ktjbvxmzcn) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#ktjbvxmzcn) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#ktjbvxmzcn) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#ktjbvxmzcn) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#ktjbvxmzcn) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#ktjbvxmzcn) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#ktjbvxmzcn) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#ktjbvxmzcn) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#ktjbvxmzcn) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#ktjbvxmzcn) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#ktjbvxmzcn) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#ktjbvxmzcn) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#ktjbvxmzcn) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#ktjbvxmzcn) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#ktjbvxmzcn) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#ktjbvxmzcn) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#ktjbvxmzcn) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#ktjbvxmzcn) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#ktjbvxmzcn) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#ktjbvxmzcn) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#ktjbvxmzcn) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#ktjbvxmzcn) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#ktjbvxmzcn) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#ktjbvxmzcn) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#ktjbvxmzcn) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#ktjbvxmzcn) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#ktjbvxmzcn) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#ktjbvxmzcn) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#ktjbvxmzcn) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#ktjbvxmzcn) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#ktjbvxmzcn) .gt_left {
  text-align: left;
}

:where(#ktjbvxmzcn) .gt_center {
  text-align: center;
}

:where(#ktjbvxmzcn) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#ktjbvxmzcn) .gt_font_normal {
  font-weight: normal;
}

:where(#ktjbvxmzcn) .gt_font_bold {
  font-weight: bold;
}

:where(#ktjbvxmzcn) .gt_font_italic {
  font-style: italic;
}

:where(#ktjbvxmzcn) .gt_super {
  font-size: 65%;
}

:where(#ktjbvxmzcn) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#ktjbvxmzcn) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#ktjbvxmzcn) .gt_indent_1 {
  text-indent: 5px;
}

:where(#ktjbvxmzcn) .gt_indent_2 {
  text-indent: 10px;
}

:where(#ktjbvxmzcn) .gt_indent_3 {
  text-indent: 15px;
}

:where(#ktjbvxmzcn) .gt_indent_4 {
  text-indent: 20px;
}

:where(#ktjbvxmzcn) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  <caption>Decile and income bracket</caption>
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="decile">decile</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="votendp">votendp</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="prop">prop</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="decile" class="gt_row gt_right">1</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">76</td>
<td headers="prop" class="gt_row gt_right">0.10368349</td></tr>
    <tr><td headers="decile" class="gt_row gt_right">2</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">70</td>
<td headers="prop" class="gt_row gt_right">0.09549795</td></tr>
    <tr><td headers="decile" class="gt_row gt_right">3</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">106</td>
<td headers="prop" class="gt_row gt_right">0.14461119</td></tr>
    <tr><td headers="decile" class="gt_row gt_right">4</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">81</td>
<td headers="prop" class="gt_row gt_right">0.11050477</td></tr>
    <tr><td headers="decile" class="gt_row gt_right">5</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">57</td>
<td headers="prop" class="gt_row gt_right">0.07776262</td></tr>
    <tr><td headers="decile" class="gt_row gt_right">6</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">88</td>
<td headers="prop" class="gt_row gt_right">0.12005457</td></tr>
    <tr><td headers="decile" class="gt_row gt_right">7</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">70</td>
<td headers="prop" class="gt_row gt_right">0.09549795</td></tr>
    <tr><td headers="decile" class="gt_row gt_right">8</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">67</td>
<td headers="prop" class="gt_row gt_right">0.09140518</td></tr>
    <tr><td headers="decile" class="gt_row gt_right">9</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">63</td>
<td headers="prop" class="gt_row gt_right">0.08594816</td></tr>
    <tr><td headers="decile" class="gt_row gt_right">10</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">55</td>
<td headers="prop" class="gt_row gt_right">0.07503411</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>However, it is straightforward to see that the ntile() function has flaws in decile computing. More generally, computing income decile when the income variable is in brackets seems complicated, but the technical note proposes a re-weighting average approach to partially solve this problem.</p>
<p>To see how the re-weighing approach works, let’s go back to the first table:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">table.income <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>()</span></code></pre></div>
<div class="cell-output-display">

<div id="vsvjxlvjmv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#vsvjxlvjmv) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#vsvjxlvjmv) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#vsvjxlvjmv) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#vsvjxlvjmv) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#vsvjxlvjmv) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#vsvjxlvjmv) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#vsvjxlvjmv) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#vsvjxlvjmv) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#vsvjxlvjmv) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#vsvjxlvjmv) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#vsvjxlvjmv) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#vsvjxlvjmv) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#vsvjxlvjmv) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#vsvjxlvjmv) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#vsvjxlvjmv) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#vsvjxlvjmv) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#vsvjxlvjmv) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#vsvjxlvjmv) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#vsvjxlvjmv) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#vsvjxlvjmv) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#vsvjxlvjmv) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#vsvjxlvjmv) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#vsvjxlvjmv) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#vsvjxlvjmv) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#vsvjxlvjmv) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#vsvjxlvjmv) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#vsvjxlvjmv) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#vsvjxlvjmv) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#vsvjxlvjmv) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#vsvjxlvjmv) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#vsvjxlvjmv) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#vsvjxlvjmv) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#vsvjxlvjmv) .gt_left {
  text-align: left;
}

:where(#vsvjxlvjmv) .gt_center {
  text-align: center;
}

:where(#vsvjxlvjmv) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#vsvjxlvjmv) .gt_font_normal {
  font-weight: normal;
}

:where(#vsvjxlvjmv) .gt_font_bold {
  font-weight: bold;
}

:where(#vsvjxlvjmv) .gt_font_italic {
  font-style: italic;
}

:where(#vsvjxlvjmv) .gt_super {
  font-size: 65%;
}

:where(#vsvjxlvjmv) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#vsvjxlvjmv) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#vsvjxlvjmv) .gt_indent_1 {
  text-indent: 5px;
}

:where(#vsvjxlvjmv) .gt_indent_2 {
  text-indent: 10px;
}

:where(#vsvjxlvjmv) .gt_indent_3 {
  text-indent: 15px;
}

:where(#vsvjxlvjmv) .gt_indent_4 {
  text-indent: 20px;
}

:where(#vsvjxlvjmv) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="inc">inc</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="votendp">votendp</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="prop_vote">prop_vote</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cum.n">cum.n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="prop">prop</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rangeleft">rangeleft</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cumrelfreqN">cumrelfreqN</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cumrelfreqInc">cumrelfreqInc</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="inc" class="gt_row gt_right">1</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">53</td>
<td headers="prop_vote" class="gt_row gt_right">0.3173653</td>
<td headers="cum.n" class="gt_row gt_right">53</td>
<td headers="prop" class="gt_row gt_right">0.07230559</td>
<td headers="rangeleft" class="gt_row gt_right">0.00000000</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.07230559</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.004975124</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">2</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">56</td>
<td headers="prop_vote" class="gt_row gt_right">0.2580645</td>
<td headers="cum.n" class="gt_row gt_right">109</td>
<td headers="prop" class="gt_row gt_right">0.07639836</td>
<td headers="rangeleft" class="gt_row gt_right">0.07230559</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.14870396</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.014925373</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">3</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">15</td>
<td headers="prop_vote" class="gt_row gt_right">0.2343750</td>
<td headers="cum.n" class="gt_row gt_right">124</td>
<td headers="prop" class="gt_row gt_right">0.02046385</td>
<td headers="rangeleft" class="gt_row gt_right">0.14870396</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.16916780</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.029850746</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">4</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">35</td>
<td headers="prop_vote" class="gt_row gt_right">0.2134146</td>
<td headers="cum.n" class="gt_row gt_right">159</td>
<td headers="prop" class="gt_row gt_right">0.04774898</td>
<td headers="rangeleft" class="gt_row gt_right">0.16916780</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.21691678</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.049751244</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">5</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">53</td>
<td headers="prop_vote" class="gt_row gt_right">0.3291925</td>
<td headers="cum.n" class="gt_row gt_right">212</td>
<td headers="prop" class="gt_row gt_right">0.07230559</td>
<td headers="rangeleft" class="gt_row gt_right">0.21691678</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.28922237</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.074626866</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">6</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">47</td>
<td headers="prop_vote" class="gt_row gt_right">0.2955975</td>
<td headers="cum.n" class="gt_row gt_right">259</td>
<td headers="prop" class="gt_row gt_right">0.06412005</td>
<td headers="rangeleft" class="gt_row gt_right">0.28922237</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.35334243</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.104477612</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">7</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">44</td>
<td headers="prop_vote" class="gt_row gt_right">0.2784810</td>
<td headers="cum.n" class="gt_row gt_right">303</td>
<td headers="prop" class="gt_row gt_right">0.06002729</td>
<td headers="rangeleft" class="gt_row gt_right">0.35334243</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.41336971</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.139303483</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">8</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">71</td>
<td headers="prop_vote" class="gt_row gt_right">0.2253968</td>
<td headers="cum.n" class="gt_row gt_right">374</td>
<td headers="prop" class="gt_row gt_right">0.09686221</td>
<td headers="rangeleft" class="gt_row gt_right">0.41336971</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.51023192</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.179104478</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">10</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">34</td>
<td headers="prop_vote" class="gt_row gt_right">0.1954023</td>
<td headers="cum.n" class="gt_row gt_right">408</td>
<td headers="prop" class="gt_row gt_right">0.04638472</td>
<td headers="rangeleft" class="gt_row gt_right">0.51023192</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.55661664</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.228855721</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">11</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">35</td>
<td headers="prop_vote" class="gt_row gt_right">0.2348993</td>
<td headers="cum.n" class="gt_row gt_right">443</td>
<td headers="prop" class="gt_row gt_right">0.04774898</td>
<td headers="rangeleft" class="gt_row gt_right">0.55661664</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.60436562</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.283582090</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">12</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">50</td>
<td headers="prop_vote" class="gt_row gt_right">0.2450980</td>
<td headers="cum.n" class="gt_row gt_right">493</td>
<td headers="prop" class="gt_row gt_right">0.06821282</td>
<td headers="rangeleft" class="gt_row gt_right">0.60436562</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.67257844</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.343283582</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">13</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">28</td>
<td headers="prop_vote" class="gt_row gt_right">0.2105263</td>
<td headers="cum.n" class="gt_row gt_right">521</td>
<td headers="prop" class="gt_row gt_right">0.03819918</td>
<td headers="rangeleft" class="gt_row gt_right">0.67257844</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.71077763</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.407960199</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">14</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">56</td>
<td headers="prop_vote" class="gt_row gt_right">0.2121212</td>
<td headers="cum.n" class="gt_row gt_right">577</td>
<td headers="prop" class="gt_row gt_right">0.07639836</td>
<td headers="rangeleft" class="gt_row gt_right">0.71077763</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.78717599</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.477611940</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">15</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">19</td>
<td headers="prop_vote" class="gt_row gt_right">0.1666667</td>
<td headers="cum.n" class="gt_row gt_right">596</td>
<td headers="prop" class="gt_row gt_right">0.02592087</td>
<td headers="rangeleft" class="gt_row gt_right">0.78717599</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.81309686</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.552238806</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">16</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">26</td>
<td headers="prop_vote" class="gt_row gt_right">0.1870504</td>
<td headers="cum.n" class="gt_row gt_right">622</td>
<td headers="prop" class="gt_row gt_right">0.03547067</td>
<td headers="rangeleft" class="gt_row gt_right">0.81309686</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.84856753</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.631840796</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">17</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">35</td>
<td headers="prop_vote" class="gt_row gt_right">0.1699029</td>
<td headers="cum.n" class="gt_row gt_right">657</td>
<td headers="prop" class="gt_row gt_right">0.04774898</td>
<td headers="rangeleft" class="gt_row gt_right">0.84856753</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.89631651</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.716417910</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">18</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">23</td>
<td headers="prop_vote" class="gt_row gt_right">0.2169811</td>
<td headers="cum.n" class="gt_row gt_right">680</td>
<td headers="prop" class="gt_row gt_right">0.03137790</td>
<td headers="rangeleft" class="gt_row gt_right">0.89631651</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.92769441</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.805970149</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">19</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">32</td>
<td headers="prop_vote" class="gt_row gt_right">0.1828571</td>
<td headers="cum.n" class="gt_row gt_right">712</td>
<td headers="prop" class="gt_row gt_right">0.04365621</td>
<td headers="rangeleft" class="gt_row gt_right">0.92769441</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.97135061</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.900497512</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">20</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">21</td>
<td headers="prop_vote" class="gt_row gt_right">0.1265060</td>
<td headers="cum.n" class="gt_row gt_right">733</td>
<td headers="prop" class="gt_row gt_right">0.02864939</td>
<td headers="rangeleft" class="gt_row gt_right">0.97135061</td>
<td headers="cumrelfreqN" class="gt_row gt_right">1.00000000</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">1.000000000</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>We can directly see the problem posed by income brackets: for example, we can observe that all of income bracket one belongs to the first decile since its relative range is between 0 and 0.0723. However, the relative range of bracket two is [0.0723 - 0.1487]. Some part of it belong to the first decile ([0 - 0.1]), but some belong to the second ([0 - 0.2]). The approach to compute the proportion of observations belonging to the any given decile is to compute the share of each income bracket belonging to this decile and then compute a weighted average. For example, if I want to compute the share of observation of the first decile (D10), I already know that 100% of income bracket one belongs to D10 but I need to know the share of bracket 2 (B2) belonging to D10.</p>
<p>To estimate this, let’s assume the distribution of B2 is uniform <img src="https://latex.codecogs.com/png.latex?x%20%5Csim%20U%5B0.0723;%200.1487%5D">, with x the observation within this range. We want to know <img src="https://latex.codecogs.com/png.latex?P(x%3C0.1)">, that is to say, the probability that x belongs to the first decile. We use the uniform cumulative distribution function with parameters min = 0.073 and max = 0.1487: <img src="https://latex.codecogs.com/png.latex?P(x%3C0.1)%20=%20%5Cfrac%7B0.1-0.0723%7D%7B0.1487-0.0723%7D%20=%200.3626">. This means that 36.26% of B2 belongs to D10. Then, the weighted average for the proportion of observation within D10: <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1*0.317+0.3626*0.26%7D%7B1+0.3626%7D%20=%200.3018">. 30.2% the first decile voters voted for the NDP in 2015.</p>
<p>Here are the computations in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">punif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3625</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.317+0.3626</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.26</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">+0.3626</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3018318</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">weighted.mean</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prop_vote[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prop_vote[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">punif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.301588</code></pre>
</div>
</div>
<p>Unfortunately, there is to my knowledge no function in R that will compute the weights automatically. I can nonetheless compute them through a tedious for loop:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">weight <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>inc))</span>
<span id="cb15-2"></span>
<span id="cb15-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>inc)) {</span>
<span id="cb15-4">  weight[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb15-5">                  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">punif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i]),</span>
<span id="cb15-6">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">punif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i]),</span>
<span id="cb15-7">                                <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">punif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i]),</span>
<span id="cb15-8">                                       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">punif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i]), </span>
<span id="cb15-9">                                              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">punif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i]), </span>
<span id="cb15-10">                                                     <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">punif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i]),</span>
<span id="cb15-11">                                                            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">punif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i]),</span>
<span id="cb15-12">                                                                   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">punif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i]), </span>
<span id="cb15-13">                                                                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">punif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN[i]), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))))))))))</span>
<span id="cb15-14">}</span>
<span id="cb15-15">weight</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1.0000000 0.3625000 0.0000000 0.6457143 0.0000000 0.1680851 0.7772727
 [8] 0.8943662 0.0000000 0.9085714 0.0000000 0.7178571 0.0000000 0.4947368
[15] 0.0000000 0.0000000 0.1173913 0.0000000 1.0000000</code></pre>
</div>
</div>
<p>I replace the 0 with 1:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">weight <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(weight <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, weight)</span>
<span id="cb17-2"></span>
<span id="cb17-3">table.income <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> table.income <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb17-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">share_decile =</span> weight)</span>
<span id="cb17-5"></span>
<span id="cb17-6">table.income <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb17-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">share_rest =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> weight) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> table.income</span>
<span id="cb17-8"></span>
<span id="cb17-9">table.income <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb17-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop_vote =</span> table.income.pervote<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prop[table.income.pervote<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>votendp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb17-11">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>()</span></code></pre></div>
<div class="cell-output-display">

<div id="krqdtdkhtu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#krqdtdkhtu) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#krqdtdkhtu) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#krqdtdkhtu) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#krqdtdkhtu) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#krqdtdkhtu) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#krqdtdkhtu) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#krqdtdkhtu) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#krqdtdkhtu) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#krqdtdkhtu) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#krqdtdkhtu) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#krqdtdkhtu) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#krqdtdkhtu) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#krqdtdkhtu) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#krqdtdkhtu) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#krqdtdkhtu) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#krqdtdkhtu) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#krqdtdkhtu) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#krqdtdkhtu) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#krqdtdkhtu) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#krqdtdkhtu) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#krqdtdkhtu) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#krqdtdkhtu) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#krqdtdkhtu) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#krqdtdkhtu) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#krqdtdkhtu) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#krqdtdkhtu) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#krqdtdkhtu) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#krqdtdkhtu) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#krqdtdkhtu) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#krqdtdkhtu) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#krqdtdkhtu) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#krqdtdkhtu) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#krqdtdkhtu) .gt_left {
  text-align: left;
}

:where(#krqdtdkhtu) .gt_center {
  text-align: center;
}

:where(#krqdtdkhtu) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#krqdtdkhtu) .gt_font_normal {
  font-weight: normal;
}

:where(#krqdtdkhtu) .gt_font_bold {
  font-weight: bold;
}

:where(#krqdtdkhtu) .gt_font_italic {
  font-style: italic;
}

:where(#krqdtdkhtu) .gt_super {
  font-size: 65%;
}

:where(#krqdtdkhtu) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#krqdtdkhtu) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#krqdtdkhtu) .gt_indent_1 {
  text-indent: 5px;
}

:where(#krqdtdkhtu) .gt_indent_2 {
  text-indent: 10px;
}

:where(#krqdtdkhtu) .gt_indent_3 {
  text-indent: 15px;
}

:where(#krqdtdkhtu) .gt_indent_4 {
  text-indent: 20px;
}

:where(#krqdtdkhtu) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="inc">inc</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="votendp">votendp</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="prop_vote">prop_vote</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cum.n">cum.n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="prop">prop</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rangeleft">rangeleft</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cumrelfreqN">cumrelfreqN</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cumrelfreqInc">cumrelfreqInc</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="share_decile">share_decile</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="share_rest">share_rest</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="inc" class="gt_row gt_right">1</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">53</td>
<td headers="prop_vote" class="gt_row gt_right">0.3173653</td>
<td headers="cum.n" class="gt_row gt_right">53</td>
<td headers="prop" class="gt_row gt_right">0.07230559</td>
<td headers="rangeleft" class="gt_row gt_right">0.00000000</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.07230559</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.004975124</td>
<td headers="share_decile" class="gt_row gt_right">1.0000000</td>
<td headers="share_rest" class="gt_row gt_right">0.00000000</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">2</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">56</td>
<td headers="prop_vote" class="gt_row gt_right">0.2580645</td>
<td headers="cum.n" class="gt_row gt_right">109</td>
<td headers="prop" class="gt_row gt_right">0.07639836</td>
<td headers="rangeleft" class="gt_row gt_right">0.07230559</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.14870396</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.014925373</td>
<td headers="share_decile" class="gt_row gt_right">0.3625000</td>
<td headers="share_rest" class="gt_row gt_right">0.63750000</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">3</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">15</td>
<td headers="prop_vote" class="gt_row gt_right">0.2343750</td>
<td headers="cum.n" class="gt_row gt_right">124</td>
<td headers="prop" class="gt_row gt_right">0.02046385</td>
<td headers="rangeleft" class="gt_row gt_right">0.14870396</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.16916780</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.029850746</td>
<td headers="share_decile" class="gt_row gt_right">1.0000000</td>
<td headers="share_rest" class="gt_row gt_right">0.00000000</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">4</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">35</td>
<td headers="prop_vote" class="gt_row gt_right">0.2134146</td>
<td headers="cum.n" class="gt_row gt_right">159</td>
<td headers="prop" class="gt_row gt_right">0.04774898</td>
<td headers="rangeleft" class="gt_row gt_right">0.16916780</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.21691678</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.049751244</td>
<td headers="share_decile" class="gt_row gt_right">0.6457143</td>
<td headers="share_rest" class="gt_row gt_right">0.35428571</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">5</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">53</td>
<td headers="prop_vote" class="gt_row gt_right">0.3291925</td>
<td headers="cum.n" class="gt_row gt_right">212</td>
<td headers="prop" class="gt_row gt_right">0.07230559</td>
<td headers="rangeleft" class="gt_row gt_right">0.21691678</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.28922237</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.074626866</td>
<td headers="share_decile" class="gt_row gt_right">1.0000000</td>
<td headers="share_rest" class="gt_row gt_right">0.00000000</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">6</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">47</td>
<td headers="prop_vote" class="gt_row gt_right">0.2955975</td>
<td headers="cum.n" class="gt_row gt_right">259</td>
<td headers="prop" class="gt_row gt_right">0.06412005</td>
<td headers="rangeleft" class="gt_row gt_right">0.28922237</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.35334243</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.104477612</td>
<td headers="share_decile" class="gt_row gt_right">0.1680851</td>
<td headers="share_rest" class="gt_row gt_right">0.83191489</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">7</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">44</td>
<td headers="prop_vote" class="gt_row gt_right">0.2784810</td>
<td headers="cum.n" class="gt_row gt_right">303</td>
<td headers="prop" class="gt_row gt_right">0.06002729</td>
<td headers="rangeleft" class="gt_row gt_right">0.35334243</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.41336971</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.139303483</td>
<td headers="share_decile" class="gt_row gt_right">0.7772727</td>
<td headers="share_rest" class="gt_row gt_right">0.22272727</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">8</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">71</td>
<td headers="prop_vote" class="gt_row gt_right">0.2253968</td>
<td headers="cum.n" class="gt_row gt_right">374</td>
<td headers="prop" class="gt_row gt_right">0.09686221</td>
<td headers="rangeleft" class="gt_row gt_right">0.41336971</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.51023192</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.179104478</td>
<td headers="share_decile" class="gt_row gt_right">0.8943662</td>
<td headers="share_rest" class="gt_row gt_right">0.10563380</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">10</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">34</td>
<td headers="prop_vote" class="gt_row gt_right">0.1954023</td>
<td headers="cum.n" class="gt_row gt_right">408</td>
<td headers="prop" class="gt_row gt_right">0.04638472</td>
<td headers="rangeleft" class="gt_row gt_right">0.51023192</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.55661664</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.228855721</td>
<td headers="share_decile" class="gt_row gt_right">1.0000000</td>
<td headers="share_rest" class="gt_row gt_right">0.00000000</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">11</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">35</td>
<td headers="prop_vote" class="gt_row gt_right">0.2348993</td>
<td headers="cum.n" class="gt_row gt_right">443</td>
<td headers="prop" class="gt_row gt_right">0.04774898</td>
<td headers="rangeleft" class="gt_row gt_right">0.55661664</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.60436562</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.283582090</td>
<td headers="share_decile" class="gt_row gt_right">0.9085714</td>
<td headers="share_rest" class="gt_row gt_right">0.09142857</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">12</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">50</td>
<td headers="prop_vote" class="gt_row gt_right">0.2450980</td>
<td headers="cum.n" class="gt_row gt_right">493</td>
<td headers="prop" class="gt_row gt_right">0.06821282</td>
<td headers="rangeleft" class="gt_row gt_right">0.60436562</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.67257844</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.343283582</td>
<td headers="share_decile" class="gt_row gt_right">1.0000000</td>
<td headers="share_rest" class="gt_row gt_right">0.00000000</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">13</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">28</td>
<td headers="prop_vote" class="gt_row gt_right">0.2105263</td>
<td headers="cum.n" class="gt_row gt_right">521</td>
<td headers="prop" class="gt_row gt_right">0.03819918</td>
<td headers="rangeleft" class="gt_row gt_right">0.67257844</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.71077763</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.407960199</td>
<td headers="share_decile" class="gt_row gt_right">0.7178571</td>
<td headers="share_rest" class="gt_row gt_right">0.28214286</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">14</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">56</td>
<td headers="prop_vote" class="gt_row gt_right">0.2121212</td>
<td headers="cum.n" class="gt_row gt_right">577</td>
<td headers="prop" class="gt_row gt_right">0.07639836</td>
<td headers="rangeleft" class="gt_row gt_right">0.71077763</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.78717599</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.477611940</td>
<td headers="share_decile" class="gt_row gt_right">1.0000000</td>
<td headers="share_rest" class="gt_row gt_right">0.00000000</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">15</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">19</td>
<td headers="prop_vote" class="gt_row gt_right">0.1666667</td>
<td headers="cum.n" class="gt_row gt_right">596</td>
<td headers="prop" class="gt_row gt_right">0.02592087</td>
<td headers="rangeleft" class="gt_row gt_right">0.78717599</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.81309686</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.552238806</td>
<td headers="share_decile" class="gt_row gt_right">0.4947368</td>
<td headers="share_rest" class="gt_row gt_right">0.50526316</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">16</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">26</td>
<td headers="prop_vote" class="gt_row gt_right">0.1870504</td>
<td headers="cum.n" class="gt_row gt_right">622</td>
<td headers="prop" class="gt_row gt_right">0.03547067</td>
<td headers="rangeleft" class="gt_row gt_right">0.81309686</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.84856753</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.631840796</td>
<td headers="share_decile" class="gt_row gt_right">1.0000000</td>
<td headers="share_rest" class="gt_row gt_right">0.00000000</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">17</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">35</td>
<td headers="prop_vote" class="gt_row gt_right">0.1699029</td>
<td headers="cum.n" class="gt_row gt_right">657</td>
<td headers="prop" class="gt_row gt_right">0.04774898</td>
<td headers="rangeleft" class="gt_row gt_right">0.84856753</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.89631651</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.716417910</td>
<td headers="share_decile" class="gt_row gt_right">1.0000000</td>
<td headers="share_rest" class="gt_row gt_right">0.00000000</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">18</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">23</td>
<td headers="prop_vote" class="gt_row gt_right">0.2169811</td>
<td headers="cum.n" class="gt_row gt_right">680</td>
<td headers="prop" class="gt_row gt_right">0.03137790</td>
<td headers="rangeleft" class="gt_row gt_right">0.89631651</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.92769441</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.805970149</td>
<td headers="share_decile" class="gt_row gt_right">0.1173913</td>
<td headers="share_rest" class="gt_row gt_right">0.88260870</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">19</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">32</td>
<td headers="prop_vote" class="gt_row gt_right">0.1828571</td>
<td headers="cum.n" class="gt_row gt_right">712</td>
<td headers="prop" class="gt_row gt_right">0.04365621</td>
<td headers="rangeleft" class="gt_row gt_right">0.92769441</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.97135061</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.900497512</td>
<td headers="share_decile" class="gt_row gt_right">1.0000000</td>
<td headers="share_rest" class="gt_row gt_right">0.00000000</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">20</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">21</td>
<td headers="prop_vote" class="gt_row gt_right">0.1265060</td>
<td headers="cum.n" class="gt_row gt_right">733</td>
<td headers="prop" class="gt_row gt_right">0.02864939</td>
<td headers="rangeleft" class="gt_row gt_right">0.97135061</td>
<td headers="cumrelfreqN" class="gt_row gt_right">1.00000000</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">1.000000000</td>
<td headers="share_decile" class="gt_row gt_right">1.0000000</td>
<td headers="share_rest" class="gt_row gt_right">0.00000000</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>There can be mistakes, but the results seem to make sense</p>
<p>Since I do not want to ever do this computation again (😅), I put all of this into a function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">weight_share <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x){</span>
<span id="cb18-2">  weight <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(x))</span>
<span id="cb18-3">  </span>
<span id="cb18-4">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(x)) {</span>
<span id="cb18-5">   weight[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(x[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> x[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb18-6">                  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(x[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> x[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">punif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> x[i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> x[i]),</span>
<span id="cb18-7">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(x[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> x[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">punif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> x[i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> x[i]),</span>
<span id="cb18-8">                                <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(x[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> x[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">punif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> x[i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> x[i]),</span>
<span id="cb18-9">                                       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(x[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> x[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">punif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> x[i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> x[i]), </span>
<span id="cb18-10">                                              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(x[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> x[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">punif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> x[i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> x[i]), </span>
<span id="cb18-11">                                                     <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(x[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> x[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">punif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> x[i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> x[i]),</span>
<span id="cb18-12">                                                            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(x[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> x[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">punif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> x[i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> x[i]),</span>
<span id="cb18-13">                                                                   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(x[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> x[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">punif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> x[i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> x[i]),</span>
<span id="cb18-14">                                                                                                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(x[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> x[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">punif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> x[i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> x[i]), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))))))))))</span>
<span id="cb18-15">  }</span>
<span id="cb18-16">  weight <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(weight <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, weight)</span>
<span id="cb18-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(weight)</span>
<span id="cb18-18">}</span></code></pre></div>
</div>
<p>Let’s check if the function works</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">weight_share</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1.0000000 0.3625000 1.0000000 0.6457143 1.0000000 0.1680851 0.7772727
 [8] 0.8943662 1.0000000 0.9085714 1.0000000 0.7178571 1.0000000 0.4947368
[15] 1.0000000 1.0000000 0.1173913 1.0000000 1.0000000</code></pre>
</div>
</div>
<p>We are almost done, there are only the weighted averages for each decile left to calculate. One further step is to compute dummy variables to show to which decile income brackets belong to. This will produce a table close to the one from the technical note.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">table.income <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb21-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rangeleft <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rangeleft <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb21-3">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rangeleft <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># the %[]% is an within bracket operator from the Desctools package. for example, x %[]% c(a, b) checks whether x belong to the interval [a, b] with a&lt;b </span></span>
<span id="cb21-4">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d3 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rangeleft <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb21-5">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d4 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rangeleft <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb21-6">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d5 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rangeleft <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb21-7">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d6 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rangeleft <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb21-8">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d7 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rangeleft <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb21-9">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d8 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rangeleft <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb21-10">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d9 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rangeleft <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb21-11">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d10 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rangeleft <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cumrelfreqN <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> table.income</span>
<span id="cb21-12"></span>
<span id="cb21-13">table.income <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>()</span></code></pre></div>
<div class="cell-output-display">

<div id="zuiuypctus" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#zuiuypctus) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#zuiuypctus) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#zuiuypctus) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#zuiuypctus) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#zuiuypctus) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#zuiuypctus) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#zuiuypctus) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#zuiuypctus) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#zuiuypctus) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#zuiuypctus) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#zuiuypctus) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#zuiuypctus) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#zuiuypctus) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#zuiuypctus) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#zuiuypctus) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#zuiuypctus) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#zuiuypctus) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#zuiuypctus) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#zuiuypctus) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#zuiuypctus) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#zuiuypctus) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#zuiuypctus) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#zuiuypctus) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#zuiuypctus) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#zuiuypctus) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#zuiuypctus) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#zuiuypctus) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#zuiuypctus) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#zuiuypctus) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#zuiuypctus) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#zuiuypctus) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#zuiuypctus) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#zuiuypctus) .gt_left {
  text-align: left;
}

:where(#zuiuypctus) .gt_center {
  text-align: center;
}

:where(#zuiuypctus) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#zuiuypctus) .gt_font_normal {
  font-weight: normal;
}

:where(#zuiuypctus) .gt_font_bold {
  font-weight: bold;
}

:where(#zuiuypctus) .gt_font_italic {
  font-style: italic;
}

:where(#zuiuypctus) .gt_super {
  font-size: 65%;
}

:where(#zuiuypctus) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#zuiuypctus) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#zuiuypctus) .gt_indent_1 {
  text-indent: 5px;
}

:where(#zuiuypctus) .gt_indent_2 {
  text-indent: 10px;
}

:where(#zuiuypctus) .gt_indent_3 {
  text-indent: 15px;
}

:where(#zuiuypctus) .gt_indent_4 {
  text-indent: 20px;
}

:where(#zuiuypctus) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="inc">inc</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="votendp">votendp</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="prop_vote">prop_vote</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cum.n">cum.n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="prop">prop</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rangeleft">rangeleft</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cumrelfreqN">cumrelfreqN</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cumrelfreqInc">cumrelfreqInc</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="share_decile">share_decile</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="share_rest">share_rest</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="d1">d1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="d2">d2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="d3">d3</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="d4">d4</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="d5">d5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="d6">d6</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="d7">d7</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="d8">d8</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="d9">d9</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="d10">d10</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="inc" class="gt_row gt_right">1</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">53</td>
<td headers="prop_vote" class="gt_row gt_right">0.3173653</td>
<td headers="cum.n" class="gt_row gt_right">53</td>
<td headers="prop" class="gt_row gt_right">0.07230559</td>
<td headers="rangeleft" class="gt_row gt_right">0.00000000</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.07230559</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.004975124</td>
<td headers="share_decile" class="gt_row gt_right">1.0000000</td>
<td headers="share_rest" class="gt_row gt_right">0.00000000</td>
<td headers="d1" class="gt_row gt_right">1</td>
<td headers="d2" class="gt_row gt_right">0</td>
<td headers="d3" class="gt_row gt_right">0</td>
<td headers="d4" class="gt_row gt_right">0</td>
<td headers="d5" class="gt_row gt_right">0</td>
<td headers="d6" class="gt_row gt_right">0</td>
<td headers="d7" class="gt_row gt_right">0</td>
<td headers="d8" class="gt_row gt_right">0</td>
<td headers="d9" class="gt_row gt_right">0</td>
<td headers="d10" class="gt_row gt_right">0</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">2</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">56</td>
<td headers="prop_vote" class="gt_row gt_right">0.2580645</td>
<td headers="cum.n" class="gt_row gt_right">109</td>
<td headers="prop" class="gt_row gt_right">0.07639836</td>
<td headers="rangeleft" class="gt_row gt_right">0.07230559</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.14870396</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.014925373</td>
<td headers="share_decile" class="gt_row gt_right">0.3625000</td>
<td headers="share_rest" class="gt_row gt_right">0.63750000</td>
<td headers="d1" class="gt_row gt_right">1</td>
<td headers="d2" class="gt_row gt_right">1</td>
<td headers="d3" class="gt_row gt_right">0</td>
<td headers="d4" class="gt_row gt_right">0</td>
<td headers="d5" class="gt_row gt_right">0</td>
<td headers="d6" class="gt_row gt_right">0</td>
<td headers="d7" class="gt_row gt_right">0</td>
<td headers="d8" class="gt_row gt_right">0</td>
<td headers="d9" class="gt_row gt_right">0</td>
<td headers="d10" class="gt_row gt_right">0</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">3</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">15</td>
<td headers="prop_vote" class="gt_row gt_right">0.2343750</td>
<td headers="cum.n" class="gt_row gt_right">124</td>
<td headers="prop" class="gt_row gt_right">0.02046385</td>
<td headers="rangeleft" class="gt_row gt_right">0.14870396</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.16916780</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.029850746</td>
<td headers="share_decile" class="gt_row gt_right">1.0000000</td>
<td headers="share_rest" class="gt_row gt_right">0.00000000</td>
<td headers="d1" class="gt_row gt_right">0</td>
<td headers="d2" class="gt_row gt_right">1</td>
<td headers="d3" class="gt_row gt_right">0</td>
<td headers="d4" class="gt_row gt_right">0</td>
<td headers="d5" class="gt_row gt_right">0</td>
<td headers="d6" class="gt_row gt_right">0</td>
<td headers="d7" class="gt_row gt_right">0</td>
<td headers="d8" class="gt_row gt_right">0</td>
<td headers="d9" class="gt_row gt_right">0</td>
<td headers="d10" class="gt_row gt_right">0</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">4</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">35</td>
<td headers="prop_vote" class="gt_row gt_right">0.2134146</td>
<td headers="cum.n" class="gt_row gt_right">159</td>
<td headers="prop" class="gt_row gt_right">0.04774898</td>
<td headers="rangeleft" class="gt_row gt_right">0.16916780</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.21691678</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.049751244</td>
<td headers="share_decile" class="gt_row gt_right">0.6457143</td>
<td headers="share_rest" class="gt_row gt_right">0.35428571</td>
<td headers="d1" class="gt_row gt_right">0</td>
<td headers="d2" class="gt_row gt_right">1</td>
<td headers="d3" class="gt_row gt_right">1</td>
<td headers="d4" class="gt_row gt_right">0</td>
<td headers="d5" class="gt_row gt_right">0</td>
<td headers="d6" class="gt_row gt_right">0</td>
<td headers="d7" class="gt_row gt_right">0</td>
<td headers="d8" class="gt_row gt_right">0</td>
<td headers="d9" class="gt_row gt_right">0</td>
<td headers="d10" class="gt_row gt_right">0</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">5</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">53</td>
<td headers="prop_vote" class="gt_row gt_right">0.3291925</td>
<td headers="cum.n" class="gt_row gt_right">212</td>
<td headers="prop" class="gt_row gt_right">0.07230559</td>
<td headers="rangeleft" class="gt_row gt_right">0.21691678</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.28922237</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.074626866</td>
<td headers="share_decile" class="gt_row gt_right">1.0000000</td>
<td headers="share_rest" class="gt_row gt_right">0.00000000</td>
<td headers="d1" class="gt_row gt_right">0</td>
<td headers="d2" class="gt_row gt_right">0</td>
<td headers="d3" class="gt_row gt_right">1</td>
<td headers="d4" class="gt_row gt_right">0</td>
<td headers="d5" class="gt_row gt_right">0</td>
<td headers="d6" class="gt_row gt_right">0</td>
<td headers="d7" class="gt_row gt_right">0</td>
<td headers="d8" class="gt_row gt_right">0</td>
<td headers="d9" class="gt_row gt_right">0</td>
<td headers="d10" class="gt_row gt_right">0</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">6</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">47</td>
<td headers="prop_vote" class="gt_row gt_right">0.2955975</td>
<td headers="cum.n" class="gt_row gt_right">259</td>
<td headers="prop" class="gt_row gt_right">0.06412005</td>
<td headers="rangeleft" class="gt_row gt_right">0.28922237</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.35334243</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.104477612</td>
<td headers="share_decile" class="gt_row gt_right">0.1680851</td>
<td headers="share_rest" class="gt_row gt_right">0.83191489</td>
<td headers="d1" class="gt_row gt_right">0</td>
<td headers="d2" class="gt_row gt_right">0</td>
<td headers="d3" class="gt_row gt_right">1</td>
<td headers="d4" class="gt_row gt_right">1</td>
<td headers="d5" class="gt_row gt_right">0</td>
<td headers="d6" class="gt_row gt_right">0</td>
<td headers="d7" class="gt_row gt_right">0</td>
<td headers="d8" class="gt_row gt_right">0</td>
<td headers="d9" class="gt_row gt_right">0</td>
<td headers="d10" class="gt_row gt_right">0</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">7</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">44</td>
<td headers="prop_vote" class="gt_row gt_right">0.2784810</td>
<td headers="cum.n" class="gt_row gt_right">303</td>
<td headers="prop" class="gt_row gt_right">0.06002729</td>
<td headers="rangeleft" class="gt_row gt_right">0.35334243</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.41336971</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.139303483</td>
<td headers="share_decile" class="gt_row gt_right">0.7772727</td>
<td headers="share_rest" class="gt_row gt_right">0.22272727</td>
<td headers="d1" class="gt_row gt_right">0</td>
<td headers="d2" class="gt_row gt_right">0</td>
<td headers="d3" class="gt_row gt_right">0</td>
<td headers="d4" class="gt_row gt_right">1</td>
<td headers="d5" class="gt_row gt_right">1</td>
<td headers="d6" class="gt_row gt_right">0</td>
<td headers="d7" class="gt_row gt_right">0</td>
<td headers="d8" class="gt_row gt_right">0</td>
<td headers="d9" class="gt_row gt_right">0</td>
<td headers="d10" class="gt_row gt_right">0</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">8</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">71</td>
<td headers="prop_vote" class="gt_row gt_right">0.2253968</td>
<td headers="cum.n" class="gt_row gt_right">374</td>
<td headers="prop" class="gt_row gt_right">0.09686221</td>
<td headers="rangeleft" class="gt_row gt_right">0.41336971</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.51023192</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.179104478</td>
<td headers="share_decile" class="gt_row gt_right">0.8943662</td>
<td headers="share_rest" class="gt_row gt_right">0.10563380</td>
<td headers="d1" class="gt_row gt_right">0</td>
<td headers="d2" class="gt_row gt_right">0</td>
<td headers="d3" class="gt_row gt_right">0</td>
<td headers="d4" class="gt_row gt_right">0</td>
<td headers="d5" class="gt_row gt_right">1</td>
<td headers="d6" class="gt_row gt_right">1</td>
<td headers="d7" class="gt_row gt_right">0</td>
<td headers="d8" class="gt_row gt_right">0</td>
<td headers="d9" class="gt_row gt_right">0</td>
<td headers="d10" class="gt_row gt_right">0</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">10</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">34</td>
<td headers="prop_vote" class="gt_row gt_right">0.1954023</td>
<td headers="cum.n" class="gt_row gt_right">408</td>
<td headers="prop" class="gt_row gt_right">0.04638472</td>
<td headers="rangeleft" class="gt_row gt_right">0.51023192</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.55661664</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.228855721</td>
<td headers="share_decile" class="gt_row gt_right">1.0000000</td>
<td headers="share_rest" class="gt_row gt_right">0.00000000</td>
<td headers="d1" class="gt_row gt_right">0</td>
<td headers="d2" class="gt_row gt_right">0</td>
<td headers="d3" class="gt_row gt_right">0</td>
<td headers="d4" class="gt_row gt_right">0</td>
<td headers="d5" class="gt_row gt_right">0</td>
<td headers="d6" class="gt_row gt_right">1</td>
<td headers="d7" class="gt_row gt_right">0</td>
<td headers="d8" class="gt_row gt_right">0</td>
<td headers="d9" class="gt_row gt_right">0</td>
<td headers="d10" class="gt_row gt_right">0</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">11</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">35</td>
<td headers="prop_vote" class="gt_row gt_right">0.2348993</td>
<td headers="cum.n" class="gt_row gt_right">443</td>
<td headers="prop" class="gt_row gt_right">0.04774898</td>
<td headers="rangeleft" class="gt_row gt_right">0.55661664</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.60436562</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.283582090</td>
<td headers="share_decile" class="gt_row gt_right">0.9085714</td>
<td headers="share_rest" class="gt_row gt_right">0.09142857</td>
<td headers="d1" class="gt_row gt_right">0</td>
<td headers="d2" class="gt_row gt_right">0</td>
<td headers="d3" class="gt_row gt_right">0</td>
<td headers="d4" class="gt_row gt_right">0</td>
<td headers="d5" class="gt_row gt_right">0</td>
<td headers="d6" class="gt_row gt_right">1</td>
<td headers="d7" class="gt_row gt_right">1</td>
<td headers="d8" class="gt_row gt_right">0</td>
<td headers="d9" class="gt_row gt_right">0</td>
<td headers="d10" class="gt_row gt_right">0</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">12</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">50</td>
<td headers="prop_vote" class="gt_row gt_right">0.2450980</td>
<td headers="cum.n" class="gt_row gt_right">493</td>
<td headers="prop" class="gt_row gt_right">0.06821282</td>
<td headers="rangeleft" class="gt_row gt_right">0.60436562</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.67257844</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.343283582</td>
<td headers="share_decile" class="gt_row gt_right">1.0000000</td>
<td headers="share_rest" class="gt_row gt_right">0.00000000</td>
<td headers="d1" class="gt_row gt_right">0</td>
<td headers="d2" class="gt_row gt_right">0</td>
<td headers="d3" class="gt_row gt_right">0</td>
<td headers="d4" class="gt_row gt_right">0</td>
<td headers="d5" class="gt_row gt_right">0</td>
<td headers="d6" class="gt_row gt_right">0</td>
<td headers="d7" class="gt_row gt_right">1</td>
<td headers="d8" class="gt_row gt_right">0</td>
<td headers="d9" class="gt_row gt_right">0</td>
<td headers="d10" class="gt_row gt_right">0</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">13</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">28</td>
<td headers="prop_vote" class="gt_row gt_right">0.2105263</td>
<td headers="cum.n" class="gt_row gt_right">521</td>
<td headers="prop" class="gt_row gt_right">0.03819918</td>
<td headers="rangeleft" class="gt_row gt_right">0.67257844</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.71077763</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.407960199</td>
<td headers="share_decile" class="gt_row gt_right">0.7178571</td>
<td headers="share_rest" class="gt_row gt_right">0.28214286</td>
<td headers="d1" class="gt_row gt_right">0</td>
<td headers="d2" class="gt_row gt_right">0</td>
<td headers="d3" class="gt_row gt_right">0</td>
<td headers="d4" class="gt_row gt_right">0</td>
<td headers="d5" class="gt_row gt_right">0</td>
<td headers="d6" class="gt_row gt_right">0</td>
<td headers="d7" class="gt_row gt_right">1</td>
<td headers="d8" class="gt_row gt_right">1</td>
<td headers="d9" class="gt_row gt_right">0</td>
<td headers="d10" class="gt_row gt_right">0</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">14</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">56</td>
<td headers="prop_vote" class="gt_row gt_right">0.2121212</td>
<td headers="cum.n" class="gt_row gt_right">577</td>
<td headers="prop" class="gt_row gt_right">0.07639836</td>
<td headers="rangeleft" class="gt_row gt_right">0.71077763</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.78717599</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.477611940</td>
<td headers="share_decile" class="gt_row gt_right">1.0000000</td>
<td headers="share_rest" class="gt_row gt_right">0.00000000</td>
<td headers="d1" class="gt_row gt_right">0</td>
<td headers="d2" class="gt_row gt_right">0</td>
<td headers="d3" class="gt_row gt_right">0</td>
<td headers="d4" class="gt_row gt_right">0</td>
<td headers="d5" class="gt_row gt_right">0</td>
<td headers="d6" class="gt_row gt_right">0</td>
<td headers="d7" class="gt_row gt_right">0</td>
<td headers="d8" class="gt_row gt_right">1</td>
<td headers="d9" class="gt_row gt_right">0</td>
<td headers="d10" class="gt_row gt_right">0</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">15</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">19</td>
<td headers="prop_vote" class="gt_row gt_right">0.1666667</td>
<td headers="cum.n" class="gt_row gt_right">596</td>
<td headers="prop" class="gt_row gt_right">0.02592087</td>
<td headers="rangeleft" class="gt_row gt_right">0.78717599</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.81309686</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.552238806</td>
<td headers="share_decile" class="gt_row gt_right">0.4947368</td>
<td headers="share_rest" class="gt_row gt_right">0.50526316</td>
<td headers="d1" class="gt_row gt_right">0</td>
<td headers="d2" class="gt_row gt_right">0</td>
<td headers="d3" class="gt_row gt_right">0</td>
<td headers="d4" class="gt_row gt_right">0</td>
<td headers="d5" class="gt_row gt_right">0</td>
<td headers="d6" class="gt_row gt_right">0</td>
<td headers="d7" class="gt_row gt_right">0</td>
<td headers="d8" class="gt_row gt_right">1</td>
<td headers="d9" class="gt_row gt_right">1</td>
<td headers="d10" class="gt_row gt_right">0</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">16</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">26</td>
<td headers="prop_vote" class="gt_row gt_right">0.1870504</td>
<td headers="cum.n" class="gt_row gt_right">622</td>
<td headers="prop" class="gt_row gt_right">0.03547067</td>
<td headers="rangeleft" class="gt_row gt_right">0.81309686</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.84856753</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.631840796</td>
<td headers="share_decile" class="gt_row gt_right">1.0000000</td>
<td headers="share_rest" class="gt_row gt_right">0.00000000</td>
<td headers="d1" class="gt_row gt_right">0</td>
<td headers="d2" class="gt_row gt_right">0</td>
<td headers="d3" class="gt_row gt_right">0</td>
<td headers="d4" class="gt_row gt_right">0</td>
<td headers="d5" class="gt_row gt_right">0</td>
<td headers="d6" class="gt_row gt_right">0</td>
<td headers="d7" class="gt_row gt_right">0</td>
<td headers="d8" class="gt_row gt_right">0</td>
<td headers="d9" class="gt_row gt_right">1</td>
<td headers="d10" class="gt_row gt_right">0</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">17</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">35</td>
<td headers="prop_vote" class="gt_row gt_right">0.1699029</td>
<td headers="cum.n" class="gt_row gt_right">657</td>
<td headers="prop" class="gt_row gt_right">0.04774898</td>
<td headers="rangeleft" class="gt_row gt_right">0.84856753</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.89631651</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.716417910</td>
<td headers="share_decile" class="gt_row gt_right">1.0000000</td>
<td headers="share_rest" class="gt_row gt_right">0.00000000</td>
<td headers="d1" class="gt_row gt_right">0</td>
<td headers="d2" class="gt_row gt_right">0</td>
<td headers="d3" class="gt_row gt_right">0</td>
<td headers="d4" class="gt_row gt_right">0</td>
<td headers="d5" class="gt_row gt_right">0</td>
<td headers="d6" class="gt_row gt_right">0</td>
<td headers="d7" class="gt_row gt_right">0</td>
<td headers="d8" class="gt_row gt_right">0</td>
<td headers="d9" class="gt_row gt_right">1</td>
<td headers="d10" class="gt_row gt_right">0</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">18</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">23</td>
<td headers="prop_vote" class="gt_row gt_right">0.2169811</td>
<td headers="cum.n" class="gt_row gt_right">680</td>
<td headers="prop" class="gt_row gt_right">0.03137790</td>
<td headers="rangeleft" class="gt_row gt_right">0.89631651</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.92769441</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.805970149</td>
<td headers="share_decile" class="gt_row gt_right">0.1173913</td>
<td headers="share_rest" class="gt_row gt_right">0.88260870</td>
<td headers="d1" class="gt_row gt_right">0</td>
<td headers="d2" class="gt_row gt_right">0</td>
<td headers="d3" class="gt_row gt_right">0</td>
<td headers="d4" class="gt_row gt_right">0</td>
<td headers="d5" class="gt_row gt_right">0</td>
<td headers="d6" class="gt_row gt_right">0</td>
<td headers="d7" class="gt_row gt_right">0</td>
<td headers="d8" class="gt_row gt_right">0</td>
<td headers="d9" class="gt_row gt_right">1</td>
<td headers="d10" class="gt_row gt_right">1</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">19</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">32</td>
<td headers="prop_vote" class="gt_row gt_right">0.1828571</td>
<td headers="cum.n" class="gt_row gt_right">712</td>
<td headers="prop" class="gt_row gt_right">0.04365621</td>
<td headers="rangeleft" class="gt_row gt_right">0.92769441</td>
<td headers="cumrelfreqN" class="gt_row gt_right">0.97135061</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">0.900497512</td>
<td headers="share_decile" class="gt_row gt_right">1.0000000</td>
<td headers="share_rest" class="gt_row gt_right">0.00000000</td>
<td headers="d1" class="gt_row gt_right">0</td>
<td headers="d2" class="gt_row gt_right">0</td>
<td headers="d3" class="gt_row gt_right">0</td>
<td headers="d4" class="gt_row gt_right">0</td>
<td headers="d5" class="gt_row gt_right">0</td>
<td headers="d6" class="gt_row gt_right">0</td>
<td headers="d7" class="gt_row gt_right">0</td>
<td headers="d8" class="gt_row gt_right">0</td>
<td headers="d9" class="gt_row gt_right">0</td>
<td headers="d10" class="gt_row gt_right">1</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">20</td>
<td headers="votendp" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">21</td>
<td headers="prop_vote" class="gt_row gt_right">0.1265060</td>
<td headers="cum.n" class="gt_row gt_right">733</td>
<td headers="prop" class="gt_row gt_right">0.02864939</td>
<td headers="rangeleft" class="gt_row gt_right">0.97135061</td>
<td headers="cumrelfreqN" class="gt_row gt_right">1.00000000</td>
<td headers="cumrelfreqInc" class="gt_row gt_right">1.000000000</td>
<td headers="share_decile" class="gt_row gt_right">1.0000000</td>
<td headers="share_rest" class="gt_row gt_right">0.00000000</td>
<td headers="d1" class="gt_row gt_right">0</td>
<td headers="d2" class="gt_row gt_right">0</td>
<td headers="d3" class="gt_row gt_right">0</td>
<td headers="d4" class="gt_row gt_right">0</td>
<td headers="d5" class="gt_row gt_right">0</td>
<td headers="d6" class="gt_row gt_right">0</td>
<td headers="d7" class="gt_row gt_right">0</td>
<td headers="d8" class="gt_row gt_right">0</td>
<td headers="d9" class="gt_row gt_right">0</td>
<td headers="d10" class="gt_row gt_right">1</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Tu put the code above into a function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">decile_dummies <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(data, rangeleft, rangeright){</span>
<span id="cb22-2"></span>
<span id="cb22-3">data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb22-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>({{rangeleft}} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> {{rangeleft}} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb22-5">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>({{rangeleft}} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> {{rangeright}} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#%[]% is an within bracket operator from the Desctools package. for example, x %[]% c(a, b) checks whether x belong to the interval [a, b] with a&lt;b </span></span>
<span id="cb22-6">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d3 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>({{rangeleft}} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> {{rangeright}} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb22-7">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d4 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>({{rangeleft}} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> {{rangeright}} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb22-8">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d5 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>({{rangeleft}} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> {{rangeright}} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb22-9">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d6 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>({{rangeleft}} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> {{rangeright}} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb22-10">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d7 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>({{rangeleft}} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> {{rangeright}} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb22-11">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d8 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>({{rangeleft}} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> {{rangeright}} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb22-12">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d9 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>({{rangeleft}} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> {{rangeright}} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb22-13">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d10 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>({{rangeleft}} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> {{rangeright}} <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%[]%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb22-14">  </span>
<span id="cb22-15">}</span></code></pre></div>
</div>
<p>This compute the proportion of the first decile directly from the table above:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">weighted.mean</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prop_vote[table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>d1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>share_decile[table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>d1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># d1</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.301588</code></pre>
</div>
</div>
<p>Let’s try to compute the 3 first decile in a way that can then be put into a for loop or even into a function later</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for d_i</span></span>
<span id="cb25-2"></span>
<span id="cb25-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">weighted.mean</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prop_vote[table.income[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb25-4">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>share_decile[table.income[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#d1: take columns 11 (D1) and the values of prop vote and share decile for which D11 == 1</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.301588</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">weighted.mean</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prop_vote[table.income[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb27-2">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>share_rest[table.income[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> table.income[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb27-3">                    table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>share_decile[table.income[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> table.income[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#d2</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2350616</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">weighted.mean</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prop_vote[table.income[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb29-2">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>share_rest[table.income[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14-1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> table.income[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#d3</span></span>
<span id="cb29-3">                    table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>share_decile[table.income[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14-1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> table.income[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2985395</code></pre>
</div>
</div>
<p>Let’s try the for loop</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1">decile_vec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb31-2">decile <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>()</span>
<span id="cb31-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#11:20 are the decile dummies columns in the dataset</span></span>
<span id="cb31-4">decile_vec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">capture.output</span>(<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>) {</span>
<span id="cb31-5"></span>
<span id="cb31-6">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>){</span>
<span id="cb31-7">    </span>
<span id="cb31-8">  decile <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">weighted.mean</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prop_vote[table.income[,i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb31-9">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>share_decile[table.income[,i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])))</span>
<span id="cb31-10">  }<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>{</span>
<span id="cb31-11">    </span>
<span id="cb31-12">   decile <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">weighted.mean</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prop_vote[table.income[,i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb31-13">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>share_rest[table.income[,i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> table.income[, i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], </span>
<span id="cb31-14">                    table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>share_decile[table.income[i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> table.income[,i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])))</span>
<span id="cb31-15">  }</span>
<span id="cb31-16"> </span>
<span id="cb31-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(decile,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb31-18">})</span>
<span id="cb31-19"></span>
<span id="cb31-20">decile_vec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(decile_vec)</span>
<span id="cb31-21">decile <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decile =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb31-22">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> decile_vec)</span>
<span id="cb31-23">decile</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   decile      prop
1       1 0.3015880
2       2 0.2350616
3       3 0.2985395
4       4 0.2873299
5       5 0.2359808
6       6 0.2147917
7       7 0.2308659
8       8 0.1992121
9       9 0.1779249
10     10 0.1737567</code></pre>
</div>
</div>
<p>This seems to work, the 3 first values are the same as the ones computed above</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1">decile <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb33-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb33-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(decile), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> prop)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb33-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb33-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/Techinal notes of political cleavages and inequality/technical-note-piketty-2021_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This graph is very close to the one from the techninal note (figure one, right-sided graph)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jeylal.github.io/myblog/posts/Techinal notes of political cleavages and inequality/graph1.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>For now, let’s put the for loop into a function: this function would require the decile dummies columns, the columns for the proportion, the column for decile share and the column for the rest’s share:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1">decile <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(data, columns, prop, share_decile, share_rest){</span>
<span id="cb34-2">  </span>
<span id="cb34-3">  decile_vec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb34-4">decile <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>()</span>
<span id="cb34-5"></span>
<span id="cb34-6">decile_vec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">capture.output</span>(<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(columns)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(columns)) {</span>
<span id="cb34-7"></span>
<span id="cb34-8">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(columns)){</span>
<span id="cb34-9">    </span>
<span id="cb34-10">  decile <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">weighted.mean</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(prop[data[,i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb34-11">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(share_decile[data[,i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])))</span>
<span id="cb34-12">  }<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>{</span>
<span id="cb34-13">    </span>
<span id="cb34-14">   decile <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">weighted.mean</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(prop[data[,i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb34-15">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(share_rest[data[,i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> data[, i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], </span>
<span id="cb34-16">                    share_decile[data[i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> data[,i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])))</span>
<span id="cb34-17">  }</span>
<span id="cb34-18"> </span>
<span id="cb34-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(decile,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb34-20">})</span>
<span id="cb34-21"></span>
<span id="cb34-22">decile_vec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(decile_vec)</span>
<span id="cb34-23">decile <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decile =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb34-24">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> decile_vec)</span>
<span id="cb34-25">decile</span>
<span id="cb34-26">}</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">decile</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> table.income, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prop_vote, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">share_decile =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>share_decile, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">share_rest =</span> table.income<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>share_rest)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   decile      prop
1       1 0.3015880
2       2 0.2350616
3       3 0.2985395
4       4 0.2873299
5       5 0.2359808
6       6 0.2147917
7       7 0.2308659
8       8 0.1992121
9       9 0.1779249
10     10 0.1737567</code></pre>
</div>
</div>
<p>The function seems to work, but requires a specific dataframe (formatted as table.income).</p>
</section>
</section>
<section id="sidenote-fitting-a-pareto-line-to-income-brackets" class="level2">
<h2 class="anchored" data-anchor-id="sidenote-fitting-a-pareto-line-to-income-brackets">Sidenote: fitting a Pareto line to income brackets</h2>
<p>Finally, one can also try to fit a “Pareto line” to the income bracket data. Vilfredo Pareto (1848-1923) is well-known for being one of the first economist to have computed inequality indices (his famous alpha coefficient) directly from personal income distribution data. His relationship <img src="https://latex.codecogs.com/png.latex?log(N)%20=%20A-%5Calpha%20log(x)">, with N the number of people earning more than income level x, is a famous relationship and almost every course on income inequality measurement starts with it.</p>
<p>First, a table need to be constructed from the data, we count the number of observation per income bracket and compute the inverse of the cumulative relative frequencies, which is the same as N is Pareto’s equation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1">ca2015 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb37-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(inc) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb37-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(n),</span>
<span id="cb37-4">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cumrelfreq =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(prop),</span>
<span id="cb37-5">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inverse_rcdf =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rev</span>(cumrelfreq)) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> paretotable</span>
<span id="cb37-6"></span>
<span id="cb37-7">paretotable <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb37-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>()</span></code></pre></div>
<div class="cell-output-display">

<div id="qzqpzkisjv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#qzqpzkisjv) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#qzqpzkisjv) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#qzqpzkisjv) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#qzqpzkisjv) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#qzqpzkisjv) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#qzqpzkisjv) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#qzqpzkisjv) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#qzqpzkisjv) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#qzqpzkisjv) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#qzqpzkisjv) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#qzqpzkisjv) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#qzqpzkisjv) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#qzqpzkisjv) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#qzqpzkisjv) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#qzqpzkisjv) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#qzqpzkisjv) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#qzqpzkisjv) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#qzqpzkisjv) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#qzqpzkisjv) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#qzqpzkisjv) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#qzqpzkisjv) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#qzqpzkisjv) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#qzqpzkisjv) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#qzqpzkisjv) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#qzqpzkisjv) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#qzqpzkisjv) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#qzqpzkisjv) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#qzqpzkisjv) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#qzqpzkisjv) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#qzqpzkisjv) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#qzqpzkisjv) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#qzqpzkisjv) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#qzqpzkisjv) .gt_left {
  text-align: left;
}

:where(#qzqpzkisjv) .gt_center {
  text-align: center;
}

:where(#qzqpzkisjv) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#qzqpzkisjv) .gt_font_normal {
  font-weight: normal;
}

:where(#qzqpzkisjv) .gt_font_bold {
  font-weight: bold;
}

:where(#qzqpzkisjv) .gt_font_italic {
  font-style: italic;
}

:where(#qzqpzkisjv) .gt_super {
  font-size: 65%;
}

:where(#qzqpzkisjv) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#qzqpzkisjv) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#qzqpzkisjv) .gt_indent_1 {
  text-indent: 5px;
}

:where(#qzqpzkisjv) .gt_indent_2 {
  text-indent: 10px;
}

:where(#qzqpzkisjv) .gt_indent_3 {
  text-indent: 15px;
}

:where(#qzqpzkisjv) .gt_indent_4 {
  text-indent: 20px;
}

:where(#qzqpzkisjv) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="inc">inc</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="prop">prop</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cumrelfreq">cumrelfreq</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="inverse_rcdf">inverse_rcdf</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="inc" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">211</td>
<td headers="prop" class="gt_row gt_right">0.04687847</td>
<td headers="cumrelfreq" class="gt_row gt_right">0.04687847</td>
<td headers="inverse_rcdf" class="gt_row gt_right">1.00000000</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">2</td>
<td headers="n" class="gt_row gt_right">327</td>
<td headers="prop" class="gt_row gt_right">0.07265052</td>
<td headers="cumrelfreq" class="gt_row gt_right">0.11952899</td>
<td headers="inverse_rcdf" class="gt_row gt_right">0.87136192</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">3</td>
<td headers="n" class="gt_row gt_right">79</td>
<td headers="prop" class="gt_row gt_right">0.01755166</td>
<td headers="cumrelfreq" class="gt_row gt_right">0.13708065</td>
<td headers="inverse_rcdf" class="gt_row gt_right">0.82914908</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">4</td>
<td headers="n" class="gt_row gt_right">210</td>
<td headers="prop" class="gt_row gt_right">0.04665630</td>
<td headers="cumrelfreq" class="gt_row gt_right">0.18373695</td>
<td headers="inverse_rcdf" class="gt_row gt_right">0.78626972</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">5</td>
<td headers="n" class="gt_row gt_right">199</td>
<td headers="prop" class="gt_row gt_right">0.04421240</td>
<td headers="cumrelfreq" class="gt_row gt_right">0.22794934</td>
<td headers="inverse_rcdf" class="gt_row gt_right">0.75960898</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">6</td>
<td headers="n" class="gt_row gt_right">184</td>
<td headers="prop" class="gt_row gt_right">0.04087980</td>
<td headers="cumrelfreq" class="gt_row gt_right">0.26882915</td>
<td headers="inverse_rcdf" class="gt_row gt_right">0.70451011</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">7</td>
<td headers="n" class="gt_row gt_right">188</td>
<td headers="prop" class="gt_row gt_right">0.04176850</td>
<td headers="cumrelfreq" class="gt_row gt_right">0.31059764</td>
<td headers="inverse_rcdf" class="gt_row gt_right">0.66985114</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">8</td>
<td headers="n" class="gt_row gt_right">421</td>
<td headers="prop" class="gt_row gt_right">0.09353477</td>
<td headers="cumrelfreq" class="gt_row gt_right">0.40413242</td>
<td headers="inverse_rcdf" class="gt_row gt_right">0.64185737</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">10</td>
<td headers="n" class="gt_row gt_right">205</td>
<td headers="prop" class="gt_row gt_right">0.04554543</td>
<td headers="cumrelfreq" class="gt_row gt_right">0.44967785</td>
<td headers="inverse_rcdf" class="gt_row gt_right">0.57209509</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">11</td>
<td headers="n" class="gt_row gt_right">166</td>
<td headers="prop" class="gt_row gt_right">0.03688069</td>
<td headers="cumrelfreq" class="gt_row gt_right">0.48655854</td>
<td headers="inverse_rcdf" class="gt_row gt_right">0.53921351</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">12</td>
<td headers="n" class="gt_row gt_right">237</td>
<td headers="prop" class="gt_row gt_right">0.05265497</td>
<td headers="cumrelfreq" class="gt_row gt_right">0.53921351</td>
<td headers="inverse_rcdf" class="gt_row gt_right">0.48655854</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">13</td>
<td headers="n" class="gt_row gt_right">148</td>
<td headers="prop" class="gt_row gt_right">0.03288158</td>
<td headers="cumrelfreq" class="gt_row gt_right">0.57209509</td>
<td headers="inverse_rcdf" class="gt_row gt_right">0.44967785</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">14</td>
<td headers="n" class="gt_row gt_right">314</td>
<td headers="prop" class="gt_row gt_right">0.06976228</td>
<td headers="cumrelfreq" class="gt_row gt_right">0.64185737</td>
<td headers="inverse_rcdf" class="gt_row gt_right">0.40413242</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">15</td>
<td headers="n" class="gt_row gt_right">126</td>
<td headers="prop" class="gt_row gt_right">0.02799378</td>
<td headers="cumrelfreq" class="gt_row gt_right">0.66985114</td>
<td headers="inverse_rcdf" class="gt_row gt_right">0.31059764</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">16</td>
<td headers="n" class="gt_row gt_right">156</td>
<td headers="prop" class="gt_row gt_right">0.03465896</td>
<td headers="cumrelfreq" class="gt_row gt_right">0.70451011</td>
<td headers="inverse_rcdf" class="gt_row gt_right">0.26882915</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">17</td>
<td headers="n" class="gt_row gt_right">248</td>
<td headers="prop" class="gt_row gt_right">0.05509887</td>
<td headers="cumrelfreq" class="gt_row gt_right">0.75960898</td>
<td headers="inverse_rcdf" class="gt_row gt_right">0.22794934</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">18</td>
<td headers="n" class="gt_row gt_right">120</td>
<td headers="prop" class="gt_row gt_right">0.02666074</td>
<td headers="cumrelfreq" class="gt_row gt_right">0.78626972</td>
<td headers="inverse_rcdf" class="gt_row gt_right">0.18373695</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">19</td>
<td headers="n" class="gt_row gt_right">193</td>
<td headers="prop" class="gt_row gt_right">0.04287936</td>
<td headers="cumrelfreq" class="gt_row gt_right">0.82914908</td>
<td headers="inverse_rcdf" class="gt_row gt_right">0.13708065</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">20</td>
<td headers="n" class="gt_row gt_right">190</td>
<td headers="prop" class="gt_row gt_right">0.04221284</td>
<td headers="cumrelfreq" class="gt_row gt_right">0.87136192</td>
<td headers="inverse_rcdf" class="gt_row gt_right">0.11952899</td></tr>
    <tr><td headers="inc" class="gt_row gt_right">NA</td>
<td headers="n" class="gt_row gt_right">579</td>
<td headers="prop" class="gt_row gt_right">0.12863808</td>
<td headers="cumrelfreq" class="gt_row gt_right">1.00000000</td>
<td headers="inverse_rcdf" class="gt_row gt_right">0.04687847</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Finally, one can plot the log of the inverse of the relative cumulative distribution function against the log of the income groups:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1">paretotable <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb38-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb38-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(inc), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rev</span>(cumrelfreq)))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb38-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb38-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb38-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://jeylal.github.io/myblog/posts/Techinal notes of political cleavages and inequality/technical-note-piketty-2021_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see that the line does not fit the data very well. As explained by <a href="https://glineq.blogspot.com/2015/02/what-remains-of-pareto.html?m=1">Milanovic</a>, the Pareto line fits well only for the top of income distribution. In fact, the data on personal income distribution that Pareto had only collected income data of the very rich. If he had data covering more than the top 1 percent, he would have probably made similar graphs as here and as in Milanovic’s blog post.</p>


</section>

 ]]></description>
  <category>Political Economy</category>
  <category>Stats</category>
  <category>Coding</category>
  <guid>https://jeylal.github.io/myblog/posts/Techinal notes of political cleavages and inequality/technical note piketty 2021.html</guid>
  <pubDate>Sun, 16 Apr 2023 22:00:00 GMT</pubDate>
  <media:content url="https://jeylal.github.io/myblog/posts/Techinal notes of political cleavages and inequality/graph1.png" medium="image" type="image/png" height="81" width="144"/>
</item>
<item>
  <title>Sugar, Cochineal and power</title>
  <link>https://jeylal.github.io/myblog/posts/Sugar, Cochineal and Power/sugar cochineal power.html</link>
  <description><![CDATA[ 




<section id="comments-on-sidney-mintzs-sweetness-and-power-and-carlos-marichals-mexican-cochineal-and-the-european-demand-for-american-dyes-1550-1850" class="level2">
<h2 class="anchored" data-anchor-id="comments-on-sidney-mintzs-sweetness-and-power-and-carlos-marichals-mexican-cochineal-and-the-european-demand-for-american-dyes-1550-1850">Comments on Sidney Mintz’s “Sweetness and Power” and Carlos Marichal’s “Mexican Cochineal and the European Demand for American Dyes, 1550-1850”</h2>
<p>“The wealth of societies in which the capitalist mode of production prevails appears as an ‘immense collection of commodities’ […] Our investigation therefore begins with the analysis of the commodity” <span class="citation" data-cites="marx_capital_1990">(Marx 1990, 124)</span>. So is the incipit of one of the most famous and important books in political economy. If Marx saw in the commodity the most crucial and elementary unit of abstraction in the capitalist mode of production, so much that he spent the first and most tedious pages of his magnus opus dedicated to its analysis and decortication, the commodity per se, that is, as a focus of historical and economic analysis, is rather rare in economics and economic history. For instance, mainstream economics reduces commodities to any objects or services bringing utility to consumers, abstracting from its historical and political dimensions.</p>
<p>Nonetheless, the two texts I will review in this critical summary are attempts to fill this gap and put the commodity back into the heart of not only economics, but also of social and historical analysis. These two texts share indeed a common characteristic: they both focus on a single commodity. Mintz’ book chapter Power (from Sweetness and Power, The Place of Sugar in Modern History <span class="citation" data-cites="mintz_power_1985">(1985)</span>) focuses on sugar from an anthropological perspective whereas Marichal’s book chapter Mexican Cochineal and the European Demand for American Dyes, 1550-1850 <span class="citation" data-cites="marichal_mexican_2006">(2006)</span> concentrates on cochineal from an economic history point of view. Another peculiar common characteristic of the two papers is that sugar and cochineal, a dyestuff product which is used for its crimson color, are both important inputs for a great number of final products: they are both illustrative examples of intermediary goods constituting a great part of global value chains.</p>
<p>In this critical summary, I will first summarize those two texts by outlining their main hypotheses and arguments in a comparative approach. I will then make some critical remarks and comments on what I believe are the positive aspects and chief contributions as well as the flaws and weaknesses of those two papers.</p>
<section id="tracing-back-sugar-and-cochineal-the-role-of-demand" class="level3">
<h3 class="anchored" data-anchor-id="tracing-back-sugar-and-cochineal-the-role-of-demand">Tracing back sugar and cochineal: the role of demand</h3>
<p>Marichal’s analysis of the rise and decline of cochineal production and trade rests upon three main hypotheses. The first one is that the prosperity of cochineal production and trade in Oaxaca, the main farming region of cochineal in Mexico, from the 16th century on was demand led. He advances two reasons for this strong demand, mostly driven by the upper classes of Europe, namely the Church, the nobility, and other elites. One reason is cultural and symbolic: cochineals produce a particularly magnificent crimson color that the nobility and the church associated with symbols of prestige and power. The other reason is physical: cochineal has physical properties which make it materially more advantageous compared to its competitors (kermes for example). This strong demand thus made cochineal highly profitable. Trade, production, and prices thus boomed from the 16th until the late 18th century which marked the start of a long run decline. Mintz’ analysis of how sugar became such an essential and highly demanded commodity is more nuanced. In fact, Mintz’s text is an attempt to answer the following question: how and why did sugar become one of the most widespread and consumed commodities in British society? An obvious and straightforward answer would be, as Marichal argues in the cochineal’s case, that humans are naturally inclined to accept sugar in their consumption habits because of its physical properties. As an anthropologist, Mintz knows that there is nothing natural in the growth of sugar demand. More elaborated answers would be for instance that sugar’s consumption habits spread from the upper classes to the lower classes through imitation (what Mintz calls “intensification”), or the constant tendency of sugar prices to fall. None of these answers are convincing enough for Mintz, whose argument is that the structural transformations of the working conditions and schedules of the British workers, during a transition process from an agricultural economy to an industrial one from circa the 16th century to the 19th century, were the real reason behind sugar’s tremendous prosperity as an essential commodity with strong meaning and signification for its consumers. Mintz explores the dual “meaning” of sugar. On the one hand, sugar replaced honey as a signification of sweetness, happiness, endearment, and tenderness (the “inside meaning” of sugar in anthropological terms) for the common British people. On the other hand, sugar became a symbol of power and prosperity for the imperialistic British ruling classes which had an interest in sugar production and trading made possible by the exploitation of African slaves in the Caribbean plantations. This represents the “outside meaning” of sugar.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.worldhistory.org/article/1795/life-on-a-colonial-sugar-plantation/"><img src="https://jeylal.github.io/myblog/posts/Sugar, Cochineal and Power/colonialsugarmanufacturing.jpg" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">Colonial sugar cane manufacturing</figcaption><p></p>
</figure>
</div>
</section>
<section id="making-sugar-and-cochineal-available-imperialism-colonization-and-slavery" class="level3">
<h3 class="anchored" data-anchor-id="making-sugar-and-cochineal-available-imperialism-colonization-and-slavery">Making sugar and cochineal available: imperialism, colonization and slavery</h3>
<p>Secondly, Marichal argues that the stability and success of cochineal’s mode of production were the results of the repartimiento system. The latter was the product of active Spanish colonial policy and merchants’ activity: local Oaxaca bureaucrats obtained funds from Mexican merchants and lent those funds to indigenous cochineal farmers. Indigenous farmers had then to produce cochineals and pay back the functionaries in kind. Marichal argues that the end of the repartimiento system was one of the main reasons for the decline of cochineal production after the late 18th century, which as further exacerbated by the invention of synthetic dyes during the second industrial revolution during the 19th century. This is the third and last hypothesis of Marichal. For Mintz, the availability of sugar was also the product of deliberate British imperialistic policy and is linked to the “outside meaning” explained above. However, the anthropologist argues that sugar demand itself was a product of British government policy: demand on the side of the British masses had to be planned, constructed and stimulated as well. The introduction of rum in the British army, of sugar in almshouses and the abolition of tariffs and duties are example of this active policy so that both “outside” and “inside” meanings of sugar could become unified. Critics and comments</p>
<p>These two texts are both instructive and captivating. They offer an enlightening history of sugar and cochineal, giving a lot of data and information on the economic history, modes of production and demand formation processes of those two commodities. The heuristic approach of taking a commodity as a unit of analysis is certainly the most interesting aspect of the two papers.</p>
<p>For instance, by focusing on cochineal production in Oaxaca, Marichal deconstructs some prevalent commonplaces of Spanish colonial history and mercantilist policy. One learns that Spaniards were not only interested in silver and gold, which is a widespread cliché in economic history , and that they in fact also sought to capture and exploit other profitable businesses as the market for dyes. The description of the repartimiento system and of its functional role in the stability of cochineal production are convincing and show to what extent Spanish colonization, traditionally considered as mercantilist, was capitalist regarding some sectors (here cochineal production and exchange). However, his argument has some blind spots. First, he totally neglects the importance of class struggle within the repartimiento system and seems to consider the Mexican Revolution of 1820 only as an exogenous shock to the system, without considering the possibility that the fall of the repartimiento system could have been the result of its own contradictions and could have been (this is only a hypothetical possibility) somehow linked to internal class struggle, social movements and uprisings or even the Mexican Revolution. Second, the history of cochineal production and use in Latin America prior to colonialism and how it became monopolized by the Spaniards are overlooked. Finally, it would have been interesting to grant some attention to the resilience of cochineal production despite its decline after the second industrial revolution, since the product is still used today and somehow managed to escape its demise to some extent.</p>
<p>Mintz, however, offers an even more insightful analysis and it is not by chance that the book from which this chapter is taken from has become a classic, giving rise to an entire new field in anthropology, namely the anthropology of food. The argument is explained through a wide variety of anthropological concepts (intensification, extensification, outside and inside meanings…) which are interesting when applied to an economic subject such as the sugar commodity. The most powerful aspect of this text is its confrontation to some classical evidence that are omnipresent and taken for granted in economics and economic history: the naturality of sugar demand which is generally considered as given and self-evident, the important role given to price fluctuation and even to free choice and individual agency. The role of prices, meanings, demand, individual choices and liberty are carefully examined and put into question.</p>
<p>Unfortunately, Mintz does not support his own thesis. He even admits at the end that his hypothesis, the success of sugar in British society as a result of structural changes in schedule, working conditions and daily life of the British workers, is “difficult or impossible to prove” (p.&nbsp;186) and he regresses his argument stating that the nature of sugar must also have played a role in its success. Such contradictions are present throughout the text and tend to make difficult any attempt to clearly grasp Mintz’ arguments and positions. Another example of such contradictions is the distinctive place of sugar between “intensification” (explained above) and “extensification”, when meanings and habits are indigenous to a specific group or class and spread without imitation. Mintz states that sugar was particular in its high degree of extensification among the British masses and that the latter developed meanings towards sugar independently from the upper classes. However, Mintz does not develop further this interesting idea and his description of sugar’s meanings through literature is not sufficient and convincing enough to explain what sugar meant to the working class.</p>
</section>
</section>
<section id="summing-up" class="level2">
<h2 class="anchored" data-anchor-id="summing-up">Summing up</h2>
<p>To sum up, Marichal’s book chapter on the cochineal is part of a wider project destined to put commodities back into the heart of economics and economic history. The author has three main hypothesis covering cochineal’s economic history. First, the tremendous growth in production and trade of this commodity was led by the demand of European upper classes. Second, the stability of the production process in Oaxaca was based on the repartimiento system. Finally, the decline of cochineal production and trade was the consequence of the second industrial revolution thanks to the invention of synthetic dies. Whereas cochineal is nowadays more of a relic from the past despite some relative resilience that should deserve some further attention (cochineal’s carminic acid is still used in some final products like syrup for example), sugar represents today the paroxysm of consumption under capitalism and is perhaps the most emblematic and embodiment of the commodity, as a crucial input in value chains as well as a final product. Mintz’ Sweetness and Power has since become a classic in anthropology, laying the foundation of a new field focused around the anthropology of food. I tried through this critic to show that Mintz’ argument is more than just a link between British demand for sugar and the exploitation of African slaves in the Caribbean plantations. Mintz’ analysis provides deeper investigations of the role of meanings attributed to sugar as well as for the role of both demand and supply, the political and power interests in the rise of one of nowadays’ most consumed, omnipresent, and controversial commodity.</p>
</section>
<section id="references" class="level2">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-marichal_mexican_2006" class="csl-entry">
Marichal, Carlos. 2006. <span>“Mexican Cochineal and the European Demand for American Dyes, 1550-1850.”</span> In <em>From Silver to Cocaine : Latin American Commodity Chains and the Building of the World Economy, 1500-2000</em>. Duke University Press.
</div>
<div id="ref-marx_capital_1990" class="csl-entry">
Marx, Karl. 1990. <em>Capital: A Critic of Political Economy Volume 1</em>. Penguin Classics.
</div>
<div id="ref-mintz_power_1985" class="csl-entry">
Mintz, Sidney. 1985. <span>“Power.”</span> In <em>Sweetness and Power: The Place of Sugar in Modern History</em>, 151–86. Viking.
</div>
</div></section></div> ]]></description>
  <category>Economic History</category>
  <guid>https://jeylal.github.io/myblog/posts/Sugar, Cochineal and Power/sugar cochineal power.html</guid>
  <pubDate>Fri, 09 Dec 2022 23:00:00 GMT</pubDate>
  <media:content url="https://jeylal.github.io/myblog/posts/Sugar, Cochineal and Power/colonialsugarmanufacturing.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Crises &amp; cycles</title>
  <link>https://jeylal.github.io/myblog/posts/About cycles and crises/cycles_crises.html</link>
  <description><![CDATA[ 




<section id="crises-cycles" class="level1">
<h1>Crises &amp; cycles</h1>
<p>One of the most striking phenomena in capitalist mode of production is certainly the recurring and systematic outbreak of financial and economic crises. Since the emergence of capitalism as a mode production in England during the 18th century and its progressive spread in Europe in the 19th and then in the world in the 20th and 21th centuries, the economy of capitalist countries must endure what economists call “business cycles”, that is to say, cyclical appearances of economic booms in production, employment and prices and busts (decline in production, employment and prices).</p>
<p>However, the acknowledgement of business cycles as such took a long and tedious path. The first main broad examination of economic crisis can be found at the beginning of the 19th century during the famous “General Glut Controversy” which involved famous economists such as Say, Ricardo and Malthus. Say, for example, argued that long-term deep economic crisis could not occur because of what will be afterwards called “Say’s law”, that is, the fact that there can be no overall overproduction crisis since production creates its own demand. It creates its own demand mainly because it generates products which can be directly exchanged for other ones. For example, If I produce coffee beans and sell it, all the value I got through selling will be in return my demand for other commodities by the same amount of value. Marx, who can be considered as a pioneer in crisis and business cycles theory, made his critic of Say’s law a point of departure of his bold thoughts on crisis.</p>
<section id="marxists-theories-of-crisis" class="level2">
<h2 class="anchored" data-anchor-id="marxists-theories-of-crisis">Marxists theories of crisis</h2>
<p>As <a href="https://github.com/Jeylal/myblog/raw/master/posts/About%20cycles%20and%20crises/Foley_ch.9.pdf">Foley’ Understanding Capital (chapter 9)</a> argues, there is no precise, consistent and modelled theory of crisis in Marx’ writings. In fact, he had diverse and dispersed analysis of different types of economic crisis that Marxists reconstructed and developed afterwards. Nonetheless, Marx’ main point on crisis is the following paradox he underlined: the capitalist system is characterized by an abundance of products (use values) due to tremendous developed productive forces and, at the same time, unfulfilled desires on the part of the working class. According to Marx, the main reason lies in the fact that production is carried under capitalism not to fulfill needs (produce use-value to satisfy needs and desires), but to accumulate profits (or, in Marxist terms, surplus value). Marxists reconstructed then three main theories of crisis: disproportionality crisis, underconsumption crisis and crisis due to the falling rate of profit.</p>
<p>Firstly, in Capital Volume 2, Marx sets up a model of capital circulation through two department: department I (production of means of production) and II (production of means of consumption). For those two sectors to have balanced growth, there should be a balanced investment level between the two, such that there can be no overproduction in one department and/or not a lack of production in the other. The problem is that it is rarely the case, since capitalist allocate their capital not in order to balance the two department, but to accumulate surplus value. This type of crisis is called “disproportionality crisis”.</p>
<p>Secondly, the underconsumption theory underlines the striking feature of the inability, under capitalism, to sell all the produced commodities. Since workers only receive a part of the value they produce in the form of wages, aggregate demand has a tendency to be always lower than the supply. Hence, their purchasing power will always be lower than the value of the produced commodities which need to be absorbed. This leaves an excess supply in the market and crisis follows. Foley argues that this version of the underconsumption theory is simplistic, because that part of the value that the worker does not get goes as income to the capitalist, who can also support additional demand for output (through consumption, or through investment, a point whom which Marx was aware of). At this precise point, Rosa Luxemburg had an important and rather unorthodox analysis. She argued that capitalist economy is structurally incapable of generating enough aggregate demand. Her argument is that even if capitalists have enough money and the willingness to invest (which would normally support aggregate demand), they cannot invest ad infinitum. In effect, the purpose of investment is in fine also to produce consumption goods (it is also its justification), one cannot invest only to accumulate means of production per se. Foley underlines the fact that this analysis by Luxemburg is strikingly un-Marxist, since Marx himself argued that the ultimate goal of capitalist production is accumulation of surplus value.</p>
<p>Thirdly Foley explains two versions of the falling rate of profit theory, the first being the “profit squeeze” theory and the second the tendency of falling profit rate: 1) The expansion phase of the business cycle leads to higher employment, the workers’ bargaining power rises and thus wages rise. That leads to a fall of the profit rate and this leads to a crisis since capitalists do not invest further until production and employment fall enough to decrease workers’ bargaining power so that wages decrease and profit rate can go up. 2) Pressured by competition and the search for profit to innovate, the capitalists tend to replace more and more labor by capital, that is, mainly machinery and equipment goods. In Marxist terms, there is a rise of the organic composition of capital (c/v with c=constant capital: machinery, equipment; and v the variable capital: wages) which leads to a fall of the profit rate (defined as p=s/(c+v) = (s/v)/(c/v+1) with s the surplus value).</p>
</section>
<section id="from-crises-to-business-cycles" class="level2">
<h2 class="anchored" data-anchor-id="from-crises-to-business-cycles">From crises to Business cycles</h2>
<p>Apart from Marx and Marxists scholars, another trend emerged in the end of the 19th and in the first half the of 20th century: economists who became increasingly interested in the measurement and analysis of business cycles. The biggest impetus in that matter can surely be accredited to Wesley Clair Mitchell (1874-1948) who was the first director of the National Bureau of Economic Research (founded in 1920) and conducted tremendous research on the measurement and analysis of business cycles. Influenced by Thorstein Veblen and his critic of neoclassical economics, Mitchell sought a new way of conducting economic analysis and research, mainly through historical and empirical data analysis. He was convinced that his empirical and inductive approach (constructing new theories from empirical evidence) would make older economic theories obsolete: “quantitative analysis” would produce more robust economic reasonings than “qualitative analysis”, that is, neoclassical deductive approach. Conclusions Mitchell drew from his work are remarkably similar to Marx’: business cycles are chiefly driven by the incessant pursuit for profit. Assuredly, Mitchell’s work paved the way to a golden age of statistical and quantitative analysis of business cycles in the 1920s, so much that even economists hitherto not interested in that domain sought to bring their own contribution to business cycle analysis. A striking example is surely Irving Fisher (1867-1947) and his debt-deflation theory. Fisher, who recognized that he was a newcomer on the subject, made a distinction between “forced cycles”, cycles determined and driven by external factors (Fisher gives the example of the sun spot theory which sought to explain economic cycles through astronomical cycles) and “free cycles”, namely, cycles whose prime movers are not external, but inherent and intrinsic to the cycle. It is to this latter case, the free cycles, that Fisher wants to explain taking what he calls a “economic science” point of departure as opposed to economic history which only describe business cycles. Fisher wants to identify relations and tendencies that drive the cycles. His main idea is that the main two factors are (1) over-indebtedness and (2) deflation, the former being more important than the latter. The state of over-indebtedness leads to worries on the part of either debtors and/or creditors. As debtors try to sell their assets to pay back their debts, the quantity of money in circulation and the velocity of money decline (agents consume less to save). This leads to a fall in price level and a paradoxical situation where the more economic agents try to get rid of their debts, the more its value in real terms rise: “the more the debtors pay, the more they owe” (<a href="https://github.com/Jeylal/myblog/raw/master/posts/About%20cycles%20and%20crises/Fisher_Debt_Deflation.pdf">Fisher</a> 1933: 54). The fall in general price level leads to a fall of profit rate and hence to a decline of production and employment. This leads to general pessimism, loss of confidence and hoarding, the value of money rises even more, prices decline further and the real interest rate rises. Fisher argues it would be insane not to intervene through economic policy and that the economy should not be left to natural market forces: reflation policy becomes necessary. However, it would not be sufficient, since the main problem of the tendency towards over-indebtedness remains. This leads Fisher to explore some of the reasons which drive the economy towards this state of over-borrowing and over-indebtedness. He argues, finally, that the mains factors are the new investments opportunities associated with great profit expectations (because it will encourage agents to borrow to invest). Those new investments opportunities are, in return, created by new inventions and technological breakthrough and progress.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://centennial.babson.edu/past/roger-babson/"><img src="https://jeylal.github.io/myblog/posts/About cycles and crises/babsonchart.jpg" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">Babson presenting one of his famous babsoncharts on business cycles</figcaption><p></p>
</figure>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>To sum up, analysis of business cycles began first with inquiries and reflections around market gluts and economic crises. As we saw, Marx and Marxists scholars can be considered as pioneers in the analysis of crises and business cycles. Outside Marxism, it was W.C. Mitchell who gave the greater impetus into business cycles analysis. As stated above, Mitchell and Marx analysis of business cycles as profit driven are similar. Nonetheless, I think Marx’ investigation goes one step further, as he also sought to explain the origins of profit through exploitation and the extraction of surplus value. Notwithstanding, Mitchell’s contribution improved greatly the quantitative measurement and analysis of business cycles in such a way that it even drew a mainstream neoclassical economist such as Irving Fisher to elaborate a bold economic theory regarding business cycles. However, if Fisher’s debt-deflation theory provides insights into the economic mechanisms of economic crises and cycles, it is limited by the fact that it neglects the political economy/ political aspects which have an important role in business cycles (one could also argue that Mitchell also omits this fact, as many business cycles economists did). In conclusion, I would like to acknowledge the important works of Kalecki, who, in that matter, successfully incorporated a political economy dimension into business cycle analysis, an analysis I find particularly valuable (this theory is briefly explained in Foley’s book chapter). In his political business cycle theory, Kalecki argues that cycles are characterized by shifting class alliances between the working class, the business class and the rentiers: during a crisis, the business class pressures the state to revive the economy, aligning thus its class interests with those of the working class. As production and employment rise thanks to state intervention, the business side becomes progressively more reluctant to it, because it loses bargaining power (jobs are secured and workers do not fear unemployment and sacks). As employment and inflation rise, the capitalists have incentive to pressure the state to conduct more orthodox economic policy: this puts an end to the expansion phase of the political business cycle until the economy slumbers once again in a crisis in which state intervention is once again required and so on and so forth. Foley argues that Kalecki’s political business cycle model is a recent underconsumptionist theory, because it stresses the incapacity/unwillingness of a capitalist-dominated society to tolerate a high level of aggregate demand for too long.</p>


</section>
</section>

 ]]></description>
  <category>Political Economy</category>
  <category>Economic History</category>
  <guid>https://jeylal.github.io/myblog/posts/About cycles and crises/cycles_crises.html</guid>
  <pubDate>Wed, 30 Nov 2022 23:00:00 GMT</pubDate>
  <media:content url="https://jeylal.github.io/myblog/posts/About cycles and crises/crises_cycles.JPG" medium="image"/>
</item>
<item>
  <title>How to do maps with R studio</title>
  <link>https://jeylal.github.io/myblog/posts/Some data analysis and how to do a map with r/how to do maps with r studio.html</link>
  <description><![CDATA[ 




<p>What follows is a short demonstration on how to do choropleth map in R studio and was part of a bonus task of a practical of one of my master’s courses on applied methods with R. I tried to do some maps and the result was good despite the fact that It can take a long time to figure out how to do. This post is thus for anyone who wants to see how maps can be done on R studio without wasting too much time.</p>
<section id="description-of-some-variables-of-the-dataset" class="level2">
<h2 class="anchored" data-anchor-id="description-of-some-variables-of-the-dataset">Description of some variables of the dataset</h2>
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 21%">
<col style="width: 57%">
</colgroup>
<thead>
<tr class="header">
<th>Variable name</th>
<th>Short description</th>
<th>Information</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ccode</td>
<td>Country code</td>
<td>Country code with the ISO-3166-1 standard</td>
</tr>
<tr class="even">
<td>cname</td>
<td>Country name</td>
<td>Country name</td>
</tr>
<tr class="odd">
<td>year</td>
<td>Year</td>
<td></td>
</tr>
<tr class="even">
<td>ht_region</td>
<td>Region of the Country</td>
<td>Tenfold politico-geographic classification of world region from 1 to 10</td>
</tr>
<tr class="odd">
<td>wdi_area</td>
<td>Land area (sq.km)</td>
<td>Country’s total area excluding area under inland water bodies, exclusive economic zones and claims to continental shelf</td>
</tr>
<tr class="even">
<td>wdi_pop</td>
<td>Total population</td>
<td>All residents regardless of legal status or citizenship (midyear estimates)</td>
</tr>
<tr class="odd">
<td>wdi_popden</td>
<td>Population density</td>
<td>People per sq. km of land area. Midyear population divided by land area in square kilometers</td>
</tr>
<tr class="even">
<td>br_dem</td>
<td>Is the country a democracy</td>
<td>Dummy variable indicator of democracy based on minimalist definition (if there is free and fair election, peaceful turnover of officers)</td>
</tr>
<tr class="odd">
<td>br_elect</td>
<td>Typology of political institutions</td>
<td>Alternative democracy indicator capturing degree of multi-party competition.</td>
</tr>
<tr class="even">
<td>chga_hinst</td>
<td>Regime Institutions</td>
<td>Six-fold classification of political regimes</td>
</tr>
<tr class="odd">
<td>ht_regtype</td>
<td>Regime Type</td>
<td>Qualitative variable representing the political regime of each country based on 26 levels</td>
</tr>
<tr class="even">
<td>p_polity2</td>
<td>Revised Combined Polity Score</td>
<td>Ordinal variable: range from -10 (strongly autocratic) to +10 (strongly democratic)</td>
</tr>
<tr class="odd">
<td>wdi_gnicon2010</td>
<td>GNI (constant 2010 US dollar)</td>
<td>Gross national income: sum of value added by all resident producers plus any product taxes less subsidies</td>
</tr>
<tr class="even">
<td>wdi_gnicapcon2010</td>
<td>GNI per capital (constant 2010 US dollar)</td>
<td>GNI divided by midyear population</td>
</tr>
<tr class="odd">
<td>wdi_gdpcapcon2010</td>
<td>GDP per capita (constant 2010 US dollar)</td>
<td>Gross domestic product divided by midyear population. GDP is the sum of gross value added by residents producers plus product taxes minus subsidies</td>
</tr>
<tr class="even">
<td>wdi_lifexp</td>
<td>Life expectancy at birth, total (years)</td>
<td>Number of years a newborn infant would live if prevailing patterns of mortality at the time of its birth were to stay the same throughout its life</td>
</tr>
<tr class="odd">
<td>wdi_litrad</td>
<td>Literacy rate, adult total (% of people ages 15 and above)</td>
<td>Percentage of the population above 15 who can understand, read and write a short simple statement</td>
</tr>
<tr class="even">
<td>undp_hdi</td>
<td>Human Development Index</td>
<td>Summary measure of average achievement in health, knowledge and decent standards of living</td>
</tr>
<tr class="odd">
<td>wdi_expmil</td>
<td>Military expenditure (% of GDP)</td>
<td>All current and capital expenditures on the armed forces</td>
</tr>
<tr class="even">
<td>wdi_internet</td>
<td>Individuals using the Internet (% of population)</td>
<td>Internet users who have used Internet in the last 3 months</td>
</tr>
</tbody>
</table>
</section>
<section id="choropleth-maps" class="level1">
<h1>Choropleth maps</h1>
<p>Let’s try to do some maps to visualize some of the dataset variables</p>
<p>I first load the packages required to do maps on r.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rgdal)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(countrycode)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gganimate)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(lubridate)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(viridis)</span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rnaturalearth)</span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rnaturalearthdata)</span>
<span id="cb1-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(maps)</span>
<span id="cb1-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(maptools)</span>
<span id="cb1-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rgeos)</span>
<span id="cb1-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(biscale)</span>
<span id="cb1-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(cowplot)</span>
<span id="cb1-14"></span>
<span id="cb1-15">map <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readOGR</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"F:/myblog/posts/Some data analysis and how to do a map with r/world map"</span>)<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Note: the shapefile for the world map was downloaded in the naturalearth website: https://www.naturalearthdata.com/downloads/</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OGR data source with driver: ESRI Shapefile 
Source: "F:\myblog\posts\Some data analysis and how to do a map with r\world map", layer: "ne_50m_admin_0_countries"
with 242 features
It has 168 fields
Integer64 fields read as strings:  NE_ID </code></pre>
</div>
</div>
<p>To plot maps, a shapefile is required. I downloaded mine from <a href="https://www.naturalearthdata.com/downloads/">Natural earth</a>.</p>
<p>I then have to “fortify” the map data to make it tidyverse compatible</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">map_fortify <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fortify</span>(map, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">region =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SOVEREIGNT"</span>)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(map_fortify<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>id)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "Afghanistan"                      "Albania"                         
  [3] "Algeria"                          "Andorra"                         
  [5] "Angola"                           "Antarctica"                      
  [7] "Antigua and Barbuda"              "Argentina"                       
  [9] "Armenia"                          "Australia"                       
 [11] "Austria"                          "Azerbaijan"                      
 [13] "Bahrain"                          "Bangladesh"                      
 [15] "Barbados"                         "Belarus"                         
 [17] "Belgium"                          "Belize"                          
 [19] "Benin"                            "Bhutan"                          
 [21] "Bolivia"                          "Bosnia and Herzegovina"          
 [23] "Botswana"                         "Brazil"                          
 [25] "Brunei"                           "Bulgaria"                        
 [27] "Burkina Faso"                     "Burundi"                         
 [29] "Cabo Verde"                       "Cambodia"                        
 [31] "Cameroon"                         "Canada"                          
 [33] "Central African Republic"         "Chad"                            
 [35] "Chile"                            "China"                           
 [37] "Colombia"                         "Comoros"                         
 [39] "Costa Rica"                       "Croatia"                         
 [41] "Cuba"                             "Cyprus"                          
 [43] "Czechia"                          "Democratic Republic of the Congo"
 [45] "Denmark"                          "Djibouti"                        
 [47] "Dominica"                         "Dominican Republic"              
 [49] "East Timor"                       "Ecuador"                         
 [51] "Egypt"                            "El Salvador"                     
 [53] "Equatorial Guinea"                "Eritrea"                         
 [55] "Estonia"                          "eSwatini"                        
 [57] "Ethiopia"                         "Federated States of Micronesia"  
 [59] "Fiji"                             "Finland"                         
 [61] "France"                           "Gabon"                           
 [63] "Gambia"                           "Georgia"                         
 [65] "Germany"                          "Ghana"                           
 [67] "Greece"                           "Grenada"                         
 [69] "Guatemala"                        "Guinea"                          
 [71] "Guinea-Bissau"                    "Guyana"                          
 [73] "Haiti"                            "Honduras"                        
 [75] "Hungary"                          "Iceland"                         
 [77] "India"                            "Indonesia"                       
 [79] "Iran"                             "Iraq"                            
 [81] "Ireland"                          "Israel"                          
 [83] "Italy"                            "Ivory Coast"                     
 [85] "Jamaica"                          "Japan"                           
 [87] "Jordan"                           "Kashmir"                         
 [89] "Kazakhstan"                       "Kenya"                           
 [91] "Kiribati"                         "Kosovo"                          
 [93] "Kuwait"                           "Kyrgyzstan"                      
 [95] "Laos"                             "Latvia"                          
 [97] "Lebanon"                          "Lesotho"                         
 [99] "Liberia"                          "Libya"                           
[101] "Liechtenstein"                    "Lithuania"                       
[103] "Luxembourg"                       "Madagascar"                      
[105] "Malawi"                           "Malaysia"                        
[107] "Maldives"                         "Mali"                            
[109] "Malta"                            "Marshall Islands"                
[111] "Mauritania"                       "Mauritius"                       
[113] "Mexico"                           "Moldova"                         
[115] "Monaco"                           "Mongolia"                        
[117] "Montenegro"                       "Morocco"                         
[119] "Mozambique"                       "Myanmar"                         
[121] "Namibia"                          "Nauru"                           
[123] "Nepal"                            "Netherlands"                     
[125] "New Zealand"                      "Nicaragua"                       
[127] "Niger"                            "Nigeria"                         
[129] "North Korea"                      "North Macedonia"                 
[131] "Northern Cyprus"                  "Norway"                          
[133] "Oman"                             "Pakistan"                        
[135] "Palau"                            "Panama"                          
[137] "Papua New Guinea"                 "Paraguay"                        
[139] "Peru"                             "Philippines"                     
[141] "Poland"                           "Portugal"                        
[143] "Qatar"                            "Republic of Serbia"              
[145] "Republic of the Congo"            "Romania"                         
[147] "Russia"                           "Rwanda"                          
[149] "Saint Kitts and Nevis"            "Saint Lucia"                     
[151] "Saint Vincent and the Grenadines" "Samoa"                           
[153] "San Marino"                       "São Tomé and Principe"           
[155] "Saudi Arabia"                     "Senegal"                         
[157] "Seychelles"                       "Sierra Leone"                    
[159] "Singapore"                        "Slovakia"                        
[161] "Slovenia"                         "Solomon Islands"                 
[163] "Somalia"                          "Somaliland"                      
[165] "South Africa"                     "South Korea"                     
[167] "South Sudan"                      "Spain"                           
[169] "Sri Lanka"                        "Sudan"                           
[171] "Suriname"                         "Sweden"                          
[173] "Switzerland"                      "Syria"                           
[175] "Taiwan"                           "Tajikistan"                      
[177] "Thailand"                         "The Bahamas"                     
[179] "Togo"                             "Tonga"                           
[181] "Trinidad and Tobago"              "Tunisia"                         
[183] "Turkey"                           "Turkmenistan"                    
[185] "Tuvalu"                           "Uganda"                          
[187] "Ukraine"                          "United Arab Emirates"            
[189] "United Kingdom"                   "United Republic of Tanzania"     
[191] "United States of America"         "Uruguay"                         
[193] "Uzbekistan"                       "Vanuatu"                         
[195] "Vatican"                          "Venezuela"                       
[197] "Vietnam"                          "Western Sahara"                  
[199] "Yemen"                            "Zambia"                          
[201] "Zimbabwe"                        </code></pre>
</div>
</div>
<p>The biggest problem to plot a map will be the names of all the countries in the two datasets because I have to successfully join the dataset to the map-dataset, I have to recode the name in one dataset. The package countrycode will do most of the work, but some countries still need to be recoded.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">data_qog<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cname <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">countryname</span>(data_qog<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cname, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destination =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cldr.short.en"</span>)</span>
<span id="cb5-2">data_qog<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cname[data_qog<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cname <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"US"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"United States of America"</span></span>
<span id="cb5-3">data_qog<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cname[data_qog<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cname <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UK"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"United Kingdom"</span></span>
<span id="cb5-4">data_qog<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cname[data_qog<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cname <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Congo - Kinshasa"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Democratic Republic of the Congo"</span></span>
<span id="cb5-5">data_qog<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cname[data_qog<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cname <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Côte d’Ivoire"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ivory Coast"</span></span>
<span id="cb5-6">data_qog<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cname[data_qog<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cname <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tanzania"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"United Republic of Tanzania"</span></span></code></pre></div>
</div>
<p>I join the datasets by the country names:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">map_join <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> map_fortify <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(data_qog, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cname"</span>))</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in left_join(., data_qog, by = c(id = "cname")): Detected an unexpected many-to-many relationship between `x` and `y`.
ℹ Row 1 of `x` matches multiple rows in `y`.
ℹ Row 1 of `y` matches multiple rows in `x`.
ℹ If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
</div>
<p>Are military expenditure geographically related to the probability of a country to be autocratic? I will explore with two maps the relation between p_polity and wdi_expmil. I expect countries with high military expenditure to be more autocratic.</p>
<p>I then plot the first map with the variable p_polity2:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">map_join <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2015</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> long, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> lat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> group, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(p_polity2), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">I</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_ordinal</span>(</span>
<span id="cb8-8">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guide =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guide_legend</span>(</span>
<span id="cb8-9">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"horizontal"</span>,</span>
<span id="cb8-10">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'top'</span>,</span>
<span id="cb8-11">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title.hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb8-12">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb8-13">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb8-14">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">byrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb8-15">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reverse =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb8-16">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span></span>
<span id="cb8-17">          ),</span>
<span id="cb8-18">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">option =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"magma"</span>,</span>
<span id="cb8-19">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"p_polity2 index"</span></span>
<span id="cb8-20">      )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb8-22">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb8-23">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb8-24">        )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Revised combined polity score across countries (2015)"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> map_plot</span>
<span id="cb8-28"></span>
<span id="cb8-29">map_plot</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jeylal.github.io/myblog/posts/Some data analysis and how to do a map with r/how-to-do-maps-with-r-studio_files/figure-html/BT 5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The more democratic countries in 2015 are concentrated in western Europe, America, East and East/South East Asia (Indonesia, Japan, South Korea), South Pacific and India and Mongolia. The autocratic countries tend to be in Africa, Middle East, some in east Europe and South Asia.</p>
<p>I now plot the second map military expenditure wdi_expmil:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">map_join <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2015</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> long, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> lat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> group, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> wdi_expmil, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">I</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_viridis</span>(</span>
<span id="cb9-10">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">option =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"magma"</span>,</span>
<span id="cb9-11">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb9-12">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Military expenditure (% of GDP)"</span></span>
<span id="cb9-13">      )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb9-15">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb9-16">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb9-17">        )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Military expenditure in 2015"</span>,</span>
<span id="cb9-19">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"All current and capital expenditures on the armed forces"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jeylal.github.io/myblog/posts/Some data analysis and how to do a map with r/how-to-do-maps-with-r-studio_files/figure-html/BT 6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Seeing the latter map on military expenditure, I would conclude that there is no clear inverse correlation between degree of democracy and military expenditure: there are countries which are strongly democratic which have relatively high military expenditure such as the US. A lot of African countries are autocratic, but do not have a really high military expenditure except for Algeria and South Sudan. The only region for which there is a correlation between autocracy and military expenditure seems to be Middle East, with Saudi Arabia being the best illustration.</p>


</section>

 ]]></description>
  <category>Stats</category>
  <category>Coding</category>
  <guid>https://jeylal.github.io/myblog/posts/Some data analysis and how to do a map with r/how to do maps with r studio.html</guid>
  <pubDate>Mon, 31 Oct 2022 23:00:00 GMT</pubDate>
  <media:content url="https://jeylal.github.io/myblog/posts/Some data analysis and how to do a map with r/map.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>Inikori about Slavery and the Industrial Revolution</title>
  <link>https://jeylal.github.io/myblog/posts/Inikori about Slavery and the Industrial Revolution/Inikori.html</link>
  <description><![CDATA[ 




<section id="book-review-africans-and-the-industrial-revolution-in-england-a-study-in-international-trade-and-economic-development.-by-joseph-e.-inikori.-cambridge-cambridge-university-press-2002.-576-p." class="level1">
<h1>Book Review Africans and the Industrial Revolution in England: A Study in International Trade and Economic Development. By JOSEPH E. INIKORI. Cambridge: Cambridge University Press, 2002. 576 p.</h1>
<p>Africans and the Industrial Revolution in England written and published in 2002 by Joseph Inikori is certainly one of the major contributions on the role of Africans and international trade in England’s industrialization and long run economic development. Joseph Inikori is an Anglo-Nigerian historian currently professor in the university of Rochester and conducting research in Atlantic World Economic History. He has published several articles on Atlantic slave trade and its impact on England economic development, the culmination of his work and research being Africans and the Industrial Revolution in England which received the Association of African Studies Best Book Prize in 2003, one year after publication. This illustrates the importance of Inikori’s book for African scholars and researchers who are eager to demonstrate the historical importance of Africa and slavery of Africans in the rise of Western Europe (but mostly here England) modernity, economic supremacy and development.</p>
<p>The present book has hence established itself as a reference and magnus opus on the causal links between African slavery and the Industrial Revolution in England in the 18th century. It is interesting to note that there are only few economic history books which stress with so much focus and insistence on this causal link between African slaves, Atlantic trade and Industrial Revolution. As Inikori argues in his book, the only major contribution on that matter before him was Eric Williams’ Capitalism and Slavery (1944) which explained that slave trade and production directly contributed to the Industrial Revolution thanks to huge amounts of profits made by British merchants and slavers who then re-invested in the productive sectors which were the basis of the Industrial Revolution. In other words, the accumulation of capital made through African slavery allowed for England’s industrial financial investment at the dawn of the Industrial Revolution. However, Williams’ profit-based argument was heavily criticized, the main critics being about the final use of those slavery-based profits (were they really invested in the Industrial Revolution?); the fact that Britain industrialization required no so much profits and that the funds mainly came from England’s own domestic resources. Inikori is aware of those matters and argues that Williams’ thesis is not so well suited anymore to explain England’s industrialization. He also tries to explain Williams’ focus on profits because of the influence of Keynesianism (in which profits play a great role for investments and growth and Williams wrote and published in the Keynesian Era) but adds that Keynesian theory is valid for already well-developed economies and not so much for pre-industrial England (p.&nbsp;5-6).</p>
<p>One could thus consider Inikori’s book as an attempt to go beyond Williams’ argument and “modernize” the explanations of the links between African slavery, Atlantic commerce and England’s development. To reach this goal, Inikori is heavily influenced by development economics’ conceptual framework. He draws inspirations and insights from prominent development economists such as Albert Otto Hirschman (1915-2012) and Hollis Chenery (1918-1994). The main contribution Inikori draws from development economics is the famous industrialization through import substitution model (ISI), for he argues that Industrial Revolution in England was “the first successful case of import substitution industrialization” (p.10). But what are the links between ISI, African slavery, Atlantic international trade and the Industrial Revolution? Inikori has to prove two mechanisms to support his thesis on the causal links between enslavement and exploitation of Africans, the rise of Atlantic commerce and the Industrial Revolution in England. The first mechanism is the causal link between Atlantic commerce and England’s Industrial Revolution (the former causing the latter). The second is the fact that growing Atlantic international trade and commerce were based on African slave labor in the Americas. We will see that the second mechanism is rather obvious and easily proved and that the first one is the main contentious part of the argument.</p>
<p>Inikori argues that during the Middle Ages onwards (roughly 1086-1660 which is the focus of chapter 2) England developed progressively, from 1086 to 1300 and then from 1475 to 1660, an economy specialized in woolen textile industry and that this industry was mostly export led. This specialization in woolen textile manufactures was England’s first successful ISI accomplished in the 16th century and, along with steady improvements in agriculture, made South England relatively rich. Thus, from 1086 to 1660 England moved from agricultural subsistence production to production for market exchange (p.43). However, market demand reached a limit and England could develop its industry further only through new expanding market demand. Inikori makes an important difference between two types of ISIs: both consist in an economy initially producing primary goods for export which then tries to substitute its imports by import-replacing manufactures thanks to state policies (fist for consumer goods, then for intermediate and capital goods). The distinction between the two models is that the first rely exclusively on internal autonomous forces and the second starts to open at some point to international trade and manufactured exports take a central place. All of Inikori’s argument is to show that England’s success corresponds to the second model (p.&nbsp;150).</p>
<p>New markets for British products were thus found thanks to Atlantic trade and commerce (America’s and Africa’s market demand) which were based on Africans slave labor. After constructing an impressive navy and establishing military dominance in Atlantic Sea in the late 16th century (for example after defeating the Invincible Armada in 1588) and therefore acquiring colonies in America, England obtained access to huge market outlets. However, Inikori does not elaborate further on England’s military dominance of Atlantic Sea and this decisive factor lacks an explanation in the author’s work: why was England in the end militarily superior to the Spanish or the Dutch? The book does not provide a precise answer and Inikori only focuses on shipping in chapter 6 to argue that England’s growing shipping industry was stimulated by rising demand for ships due to overseas trade.</p>
<p>Regardless, it was the access to new markets in Africa and in America’s colonies which enabled England to further its industrialization through import substitution strategies. Imports of cotton textile from India, for instance, gave impetus to local English entrepreneurs to try to venture into cotton textile manufacturing. Protectionist policies, access to outlets in British American colonies and Africa and raw cotton provided by American colonies where production in plantations were based on Africans slaves labor permitted England to successfully achieve import substitution in the cotton industry which is recognized as one of the most crucial sectors of the Industrial Revolution. The reader could be surprised of the relatively few pages focusing on cotton industry in chapter 9 (about 20 pages: pp.427-451) since the Industrial Revolution mostly began with the cotton industry and its technological improvements, but Inikori is right when he argues that this industry developed under the impetus of access to overseas African and American markets and based on raw cotton provided by slave labor in British American colonies. Nonetheless, I think we could also consider the possibility of counterfactual although it may sound speculative: could have England developed its revolutionary cotton industry without African slave labor? This question is a matter of substitutability degree of labor and imports: one could argue that the specialization of Egypt in raw cotton production in the middle of the 19th shows that imports of raw cotton was perhaps more flexible than what Inikori seems to consider.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://en.wikipedia.org/wiki/Atlantic_slave_trade#/media/File:Slaves_resting_by_Rugendas_01.jpg"><img src="https://jeylal.github.io/myblog/posts/Inikori about Slavery and the Industrial Revolution/slavery.jpg" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">Recently bought slaves in Brazil on their way to the farms of the landowners who bought them c.&nbsp;1830 (credit: wikipedia)</figcaption><p></p>
</figure>
</div>
<p>Regardless, Inikori’s methodological work is impressive: it offers vast amounts of quantitative data in table form as well as qualitative data through archival researches of a great varieties of historical reports and records. His quantitative and qualitative archival research and evidence allow the author to provide critical reviews of the existing literature on the subject and even to re-evaluate some estimations for example in chapter 5 in which he discusses the measurement of the importance of slave trading between 1600-1850. However, Inikori’s data analysis seems sometimes futile and can blur his main argument as well as confusing and overwhelming the reader. For instance, the author spends pages of digression discussing in vain population and GDP estimates of Domesday England in chapter 2 or Africa and America population estimates before Atlantic trade’s emergence in chapter 4.</p>
<p>Perhaps the book’s boldest argument and examination to prove the link between Atlantic trade and England’s Industrial Revolution lies in its regional analysis of pre-industrial England. In fact, the regions which started the Industrial Revolution: Lancashire, Yorkshire and the West Midlands (but mostly Lancashire), were the poorest regions of England at the time with relatively low population, low wages and poor overall wealth. As soon as those regions connected to overseas markets, industry, wages and population grew. Inikori carefully shows that population growth was autonomous in those regions (no migration from agriculturally productive and wealthy South regions), that industry growth was not led by internal demand since there was no national market yet until railroads construction in the 19th century and finally that technological innovations took place in those regions and were thus stimulated by high overseas demand. The only reason left to explain North West England industrial growth is thus the access to overseas markets in America and Africa. This is the central argument of the book and I think the most important, since proving that Atlantic trade was based on Africans’ slave labor is rather indisputable, obvious and largely admitted in the literature.</p>
<p>In the end, Africans and the Industrial Revolution in England definitely shows that African slave labor significantly contributed to England’s Industrial Revolution. Notwithstanding, its precise form of contribution, whether it was the decisive and unique causal factor or a factor among many remains a contentious matter. Inikori seems to consider that it was the decisive and unique factor, taking thus, in my opinion, an excessive straightforward position. Economic history phenomenon can rarely be explained through unique factors and when one focuses too much on one possible factor, other important causes can easily be overlooked. Other research exploring the role of colonization of America by England in the Industrial Revolution without taking such exaggerated straightforward perspective can be found for example in Pomeranz’ Great Divergence (2000) which combines multiple factors such as access to overseas markets and lands through colonization of North America (joining thus partly Inikori’s argument) and access to coal to explain England’s Industrial Revolution and which is, I think, a good complement to Inikori’s work. I also believe that Inikori attributes excessive importance on Atlantic trade, discounting the important role of trade with India and China which were also crucial (as we saw, cotton textiles imported by the English East India Company which stimulated ISI strategy in this sector came from India and another example is China’s demand for silver which made America’s silver mines profitable for decades).</p>


</section>

 ]]></description>
  <category>Economic History</category>
  <guid>https://jeylal.github.io/myblog/posts/Inikori about Slavery and the Industrial Revolution/Inikori.html</guid>
  <pubDate>Tue, 04 Oct 2022 22:00:00 GMT</pubDate>
  <media:content url="https://jeylal.github.io/myblog/posts/Inikori about Slavery and the Industrial Revolution/inikori.JPG" medium="image"/>
</item>
</channel>
</rss>
