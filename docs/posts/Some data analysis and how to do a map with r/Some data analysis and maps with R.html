<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Celâl Güney - Some Data Aanalysis and Maps with R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Celâl Güney</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Jeylal/myblog/raw/master/Cel%C3%A2l%20G%C3%BCney%20cv%20english.pdf">
 <span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Some Data Aanalysis and Maps with R</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>What follows is a data analysis that I made for one of my master’s courses on applied methods with R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmosaic)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"F:/myblog/posts/Some data analysis and how to do a map with r"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>data_qog <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"2022-10-31-T412006-assignment2-data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="description-of-some-variables-of-the-dataset" class="level2">
<h2 class="anchored" data-anchor-id="description-of-some-variables-of-the-dataset">Description of some variables of the dataset</h2>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Variable name</th>
<th>Short description</th>
<th>Information</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ccode</td>
<td>Country code</td>
<td>Country code with the ISO-3166-1 standard</td>
</tr>
<tr class="even">
<td>cname</td>
<td>Country name</td>
<td>Country name</td>
</tr>
<tr class="odd">
<td>year</td>
<td>Year</td>
<td></td>
</tr>
<tr class="even">
<td>ht_region</td>
<td>Region of the Country</td>
<td>Tenfold politico-geographic classification of world region from 1 to 10</td>
</tr>
<tr class="odd">
<td>wdi_area</td>
<td>Land area (sq.km)</td>
<td>Country’s total area excluding area under inland water bodies, exclusive economic zones and claims to continental shelf</td>
</tr>
<tr class="even">
<td>wdi_pop</td>
<td>Total population</td>
<td>All residents regardless of legal status or citizenship (midyear estimates)</td>
</tr>
<tr class="odd">
<td>wdi_popden</td>
<td>Population density</td>
<td>People per sq. km of land area. Midyear population divided by land area in square kilometers</td>
</tr>
<tr class="even">
<td>br_dem</td>
<td>Is the country a democracy</td>
<td>Dummy variable indicator of democracy based on minimalist definition (if there is free and fair election, peaceful turnover of officers)</td>
</tr>
<tr class="odd">
<td>br_elect</td>
<td>Typology of political institutions</td>
<td>Alternative democracy indicator capturing degree of multi-party competition.</td>
</tr>
<tr class="even">
<td>chga_hinst</td>
<td>Regime Institutions</td>
<td>Six-fold classification of political regimes</td>
</tr>
<tr class="odd">
<td>ht_regtype</td>
<td>Regime Type</td>
<td>Qualitative variable representing the political regime of each country based on 26 levels</td>
</tr>
<tr class="even">
<td>p_polity2</td>
<td>Revised Combined Polity Score</td>
<td>Ordinal variable: range from -10 (strongly autocratic) to +10 (strongly democratic)</td>
</tr>
<tr class="odd">
<td>wdi_gnicon2010</td>
<td>GNI (constant 2010 US dollar)</td>
<td>Gross national income: sum of value added by all resident producers plus any product taxes less subsidies</td>
</tr>
<tr class="even">
<td>wdi_gnicapcon2010</td>
<td>GNI per capital (constant 2010 US dollar)</td>
<td>GNI divided by midyear population</td>
</tr>
<tr class="odd">
<td>wdi_gdpcapcon2010</td>
<td>GDP per capita (constant 2010 US dollar)</td>
<td>Gross domestic product divided by midyear population. GDP is the sum of gross value added by residents producers plus product taxes minus subsidies</td>
</tr>
<tr class="even">
<td>wdi_lifexp</td>
<td>Life expectancy at birth, total (years)</td>
<td>Number of years a newborn infant would live if prevailing patterns of mortality at the time of its birth were to stay the same throughout its life</td>
</tr>
<tr class="odd">
<td>wdi_litrad</td>
<td>Literacy rate, adult total (% of people ages 15 and above)</td>
<td>Percentage of the population above 15 who can understand, read and write a short simple statement</td>
</tr>
<tr class="even">
<td>undp_hdi</td>
<td>Human Development Index</td>
<td>Summary measure of average achievement in health, knowledge and decent standards of living</td>
</tr>
<tr class="odd">
<td>wdi_expmil</td>
<td>Military expenditure (% of GDP)</td>
<td>All current and capital expenditures on the armed forces</td>
</tr>
<tr class="even">
<td>wdi_internet</td>
<td>Individuals using the Internet (% of population)</td>
<td>Internet users who have used Internet in the last 3 months</td>
</tr>
</tbody>
</table>
</section>
<section id="data-transformations" class="level1">
<h1>Data transformations</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(data_qog<span class="sc">$</span>ht_region)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.numeric</span>(data_qog<span class="sc">$</span>ht_region)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>Variable ht_region is stored as a numerical variable. This does not make sense, because the variable is a geographical classification of world region from 1 to 10 each number representing a region, it should hence be stored as a nominal/factor variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data_qog<span class="sc">$</span>ht_region <span class="ot">&lt;-</span>  <span class="fu">factor</span>(data_qog<span class="sc">$</span>ht_region, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(data_qog<span class="sc">$</span>ht_region)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 8    1    &lt;NA&gt; 3    5    4    10   2    9    7    6   
Levels: 1 2 3 4 5 6 7 8 9 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_qog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 20
  ccode cname        year ht_region wdi_area wdi_pop wdi_popden br_dem br_elect
  &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;fct&gt;        &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
1     4 Afghanistan  1960 8               NA 8996967       NA        0        2
2     4 Afghanistan  1961 8           652860 9169406       14.0      0        2
3     4 Afghanistan  1962 8           652860 9351442       14.3      0        2
4     4 Afghanistan  1963 8           652860 9543200       14.6      0        2
5     4 Afghanistan  1964 8           652860 9744772       14.9      0        2
6     4 Afghanistan  1965 8           652860 9956318       15.3      0        2
# ℹ 11 more variables: chga_hinst &lt;dbl&gt;, ht_regtype &lt;dbl&gt;, p_polity2 &lt;dbl&gt;,
#   wdi_gnicon2010 &lt;dbl&gt;, wdi_gnicapcon2010 &lt;dbl&gt;, wdi_gdpcapcon2010 &lt;dbl&gt;,
#   wdi_lifexp &lt;dbl&gt;, wdi_litrad &lt;dbl&gt;, undp_hdi &lt;dbl&gt;, wdi_expmil &lt;dbl&gt;,
#   wdi_internet &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data_cntr_reg <span class="ot">&lt;-</span> data_qog <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2015</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cname, ht_region)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_cntr_reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  cname               ht_region
  &lt;chr&gt;               &lt;fct&gt;    
1 Afghanistan         8        
2 Albania             1        
3 Algeria             3        
4 Andorra             5        
5 Angola              4        
6 Antigua and Barbuda 10       </code></pre>
</div>
</div>
<section id="recoding-the-regions" class="level2">
<h2 class="anchored" data-anchor-id="recoding-the-regions">Recoding the regions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>data_cntr_reg <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">my_region =</span> <span class="fu">ifelse</span>(ht_region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">10</span>), <span class="st">"Americas"</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ifelse</span>(cname <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Canada"</span>, <span class="st">"United States of America (the)"</span>), <span class="st">"Americas"</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(ht_region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>) <span class="sc">|</span> cname <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Tajikistan"</span>, <span class="st">"Turkmenistan"</span>, <span class="st">"Uzbekistan"</span>, <span class="st">"Kazakhstan"</span>, <span class="st">"Kyrgyzstan"</span>), <span class="st">"Asia"</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ifelse</span>(ht_region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>), <span class="st">"Europe"</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">ifelse</span>(ht_region <span class="sc">==</span> <span class="dv">3</span> <span class="sc">|</span> cname <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Turkey"</span>, <span class="st">"Israel"</span>, <span class="st">"Cyprus"</span>), <span class="st">"North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)"</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">ifelse</span>(ht_region <span class="sc">==</span> <span class="dv">4</span>, <span class="st">"Sub-Saharan Africa"</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>                                                   <span class="fu">ifelse</span>(ht_region <span class="sc">==</span> <span class="dv">9</span> <span class="sc">|</span> cname <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Australia"</span>, <span class="st">"New-Zealand"</span>), <span class="st">"The Pacific (including Australia &amp; New-Zealand"</span>, <span class="dv">0</span>)))))))</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="ot">-&gt;</span> data_cntr_reg</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>data_cntr_reg <span class="sc">%&gt;%</span> </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ht_region, cname) <span class="sc">%&gt;%</span> </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Countries and their region"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Countries and their region</caption>
<colgroup>
<col style="width: 44%">
<col style="width: 7%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">cname</th>
<th style="text-align: left;">ht_region</th>
<th style="text-align: left;">my_region</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Albania</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Armenia</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Azerbaijan</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Belarus</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bosnia and Herzegovina</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bulgaria</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Croatia</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Czechia</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Czechoslovakia</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Estonia</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Georgia</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hungary</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kazakhstan</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kyrgyzstan</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Latvia</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lithuania</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Moldova (the Republic of)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Montenegro</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">North Macedonia</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Romania</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Russian Federation (the)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Serbia</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Serbia and Montenegro</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Slovakia</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Slovenia</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tajikistan</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Turkmenistan</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">USSR</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ukraine</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Uzbekistan</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Argentina</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bolivia (Plurinational State of)</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brazil</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Chile</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="even">
<td style="text-align: left;">Colombia</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Costa Rica</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cuba</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dominican Republic (the)</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ecuador</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="odd">
<td style="text-align: left;">El Salvador</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="even">
<td style="text-align: left;">Guatemala</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Haiti</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="even">
<td style="text-align: left;">Honduras</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mexico</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nicaragua</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Panama</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="even">
<td style="text-align: left;">Paraguay</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Peru</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="even">
<td style="text-align: left;">Uruguay</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Venezuela (Bolivarian Republic of)</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="even">
<td style="text-align: left;">Algeria</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bahrain</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cyprus</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Egypt</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Iran (Islamic Republic of)</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Iraq</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Israel</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jordan</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kuwait</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lebanon</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Libya</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Morocco</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oman</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Qatar</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Saudi Arabia</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Syrian Arab Republic (the)</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tunisia</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Turkey</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)</td>
</tr>
<tr class="even">
<td style="text-align: left;">United Arab Emirates (the)</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Yemen</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Angola</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Benin</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Botswana</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Burkina Faso</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Burundi</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cabo Verde</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cameroon</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Central African Republic (the)</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Chad</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Comoros (the)</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Congo (the Democratic Republic of the)</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Congo (the)</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Côte d’Ivoire</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Djibouti</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Equatorial Guinea</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Eritrea</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Eswatini</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ethiopia</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gabon</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gambia (the)</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ghana</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Guinea</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Guinea-Bissau</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kenya</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lesotho</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Liberia</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Madagascar</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Malawi</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mali</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mauritania</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mauritius</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mozambique</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Namibia</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Niger (the)</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nigeria</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rwanda</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sao Tome and Principe</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Senegal</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Seychelles</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sierra Leone</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Somalia</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">South Africa</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">South Sudan</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sudan (the)</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tanzania, the United Republic of</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Togo</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Uganda</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zambia</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zimbabwe</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Andorra</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Australia</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Austria</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Canada</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="even">
<td style="text-align: left;">Denmark</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Finland</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">France</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Greece</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Iceland</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ireland</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Liechtenstein</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Luxembourg</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Malta</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Monaco</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Netherlands (the)</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">New Zealand</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Norway</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Portugal</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">San Marino</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Spain</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sweden</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Switzerland</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="even">
<td style="text-align: left;">United Kingdom of Great Britain and Northern Ireland (the)</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Europe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">United States of America (the)</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="even">
<td style="text-align: left;">China</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Japan</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Korea (the Democratic People’s Republic of)</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Korea (the Republic of)</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mongolia</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Taiwan (Province of China)</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brunei Darussalam</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cambodia</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Indonesia</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lao People’s Democratic Republic (the)</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Malaysia</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Myanmar</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Philippines (the)</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Singapore</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Thailand</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Timor-Leste</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Viet Nam</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bangladesh</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bhutan</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="even">
<td style="text-align: left;">India</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Maldives</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nepal</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pakistan</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sri Lanka</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tibet</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">Asia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fiji</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">The Pacific (including Australia &amp; New-Zealand</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kiribati</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">The Pacific (including Australia &amp; New-Zealand</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marshall Islands</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">The Pacific (including Australia &amp; New-Zealand</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Micronesia (Federated States of)</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">The Pacific (including Australia &amp; New-Zealand</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nauru</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">The Pacific (including Australia &amp; New-Zealand</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Palau</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">The Pacific (including Australia &amp; New-Zealand</td>
</tr>
<tr class="even">
<td style="text-align: left;">Papua New Guinea</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">The Pacific (including Australia &amp; New-Zealand</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Samoa</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">The Pacific (including Australia &amp; New-Zealand</td>
</tr>
<tr class="even">
<td style="text-align: left;">Solomon Islands</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">The Pacific (including Australia &amp; New-Zealand</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tonga</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">The Pacific (including Australia &amp; New-Zealand</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tuvalu</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">The Pacific (including Australia &amp; New-Zealand</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Vanuatu</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">The Pacific (including Australia &amp; New-Zealand</td>
</tr>
<tr class="even">
<td style="text-align: left;">Antigua and Barbuda</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bahamas (the)</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="even">
<td style="text-align: left;">Barbados</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Belize</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dominica</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Grenada</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="even">
<td style="text-align: left;">Guyana</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jamaica</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="even">
<td style="text-align: left;">Saint Kitts and Nevis</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Saint Lucia</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="even">
<td style="text-align: left;">Saint Vincent and the Grenadines</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Suriname</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">Americas</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trinidad and Tobago</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">Americas</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>data_qog <span class="ot">&lt;-</span> data_qog <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">my_region =</span> <span class="fu">ifelse</span>(ht_region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">10</span>), <span class="st">"Americas"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ifelse</span>(cname <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Canada"</span>, <span class="st">"United States of America (the)"</span>), <span class="st">"Americas"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">ifelse</span>(ht_region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>) <span class="sc">|</span> cname <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Tajikistan"</span>, <span class="st">"Turkmenistan"</span>, <span class="st">"Uzbekistan"</span>, <span class="st">"Kazakhstan"</span>, <span class="st">"Kyrgyzstan"</span>), <span class="st">"Asia"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ifelse</span>(ht_region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>), <span class="st">"Europe"</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">ifelse</span>(ht_region <span class="sc">==</span> <span class="dv">3</span> <span class="sc">|</span> cname <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Turkey"</span>, <span class="st">"Israel"</span>, <span class="st">"Cyprus"</span>), <span class="st">"North Africa &amp; Middle East (including Israel, Turkey &amp; Cyprus)"</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">ifelse</span>(ht_region <span class="sc">==</span> <span class="dv">4</span>, <span class="st">"Sub-Saharan Africa"</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                                                   <span class="fu">ifelse</span>(ht_region <span class="sc">==</span> <span class="dv">9</span> <span class="sc">|</span> cname <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Australia"</span>, <span class="st">"New-Zealand"</span>), <span class="st">"The Pacific (including Australia &amp; New-Zealand"</span>, <span class="dv">0</span>)))))))</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>my_gnicapcon2010 <span class="ot">&lt;-</span> data_qog <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cname, wdi_pop, wdi_gnicon2010, wdi_gnicapcon2010) <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">my_gnicapcon =</span> wdi_gnicon2010<span class="sc">/</span>wdi_pop)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(my_gnicapcon2010)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  cname       wdi_pop wdi_gnicon2010 wdi_gnicapcon2010 my_gnicapcon
  &lt;chr&gt;         &lt;dbl&gt;          &lt;dbl&gt;             &lt;dbl&gt;        &lt;dbl&gt;
1 Afghanistan 8996967             NA                NA           NA
2 Afghanistan 9169406             NA                NA           NA
3 Afghanistan 9351442             NA                NA           NA
4 Afghanistan 9543200             NA                NA           NA
5 Afghanistan 9744772             NA                NA           NA
6 Afghanistan 9956318             NA                NA           NA</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>data_gnipc <span class="ot">&lt;-</span> my_gnicapcon2010 <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">check =</span> <span class="fu">ifelse</span>(my_gnicapcon <span class="sc">==</span> wdi_gnicapcon2010, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_gnipc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  cname       wdi_pop wdi_gnicon2010 wdi_gnicapcon2010 my_gnicapcon check
  &lt;chr&gt;         &lt;dbl&gt;          &lt;dbl&gt;             &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;
1 Afghanistan 8996967             NA                NA           NA    NA
2 Afghanistan 9169406             NA                NA           NA    NA
3 Afghanistan 9351442             NA                NA           NA    NA
4 Afghanistan 9543200             NA                NA           NA    NA
5 Afghanistan 9744772             NA                NA           NA    NA
6 Afghanistan 9956318             NA                NA           NA    NA</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>data_gnipc <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(check) <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"check = 0: observations with same values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>check = 0: observations with same values</caption>
<thead>
<tr class="header">
<th style="text-align: right;">check</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">0.0180158</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5117</td>
<td style="text-align: right;">0.4209444</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">6820</td>
<td style="text-align: right;">0.5610398</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>It does not look like, when check is equal to one, that the values are different. The reason is perhaps because of how the values are rounded: observations with check = 0 have the same rounding and observations with check = 1 are rounded differently.</p>
<p>Let’s adjust the check by rounding all observations to the third decimal:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>data_gnipc <span class="ot">&lt;-</span> data_gnipc <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">check2 =</span> <span class="fu">ifelse</span>(<span class="fu">round</span>(my_gnicapcon, <span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">==</span> <span class="fu">round</span>(wdi_gnicapcon2010, <span class="at">digits =</span> <span class="dv">3</span>), <span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I now check doing a table:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>data_gnipc <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(check2) <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"check2 = 0: observations with same values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>check2 = 0: observations with same values</caption>
<thead>
<tr class="header">
<th style="text-align: right;">check2</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">5155</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">181</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">6820</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="describing-variation" class="level1">
<h1>Describing variation</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>data_qog <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(wdi_internet, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">median =</span> <span class="fu">median</span>(wdi_internet, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(wdi_internet, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">min =</span> <span class="fu">min</span>(wdi_internet, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(wdi_internet, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">IQR =</span> <span class="fu">IQR</span>(wdi_internet, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"descriptive statistics for wdi_internet"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>descriptive statistics for wdi_internet</caption>
<thead>
<tr class="header">
<th style="text-align: right;">mean</th>
<th style="text-align: right;">median</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">IQR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">21.75882</td>
<td style="text-align: right;">5.793264</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">28.65702</td>
<td style="text-align: right;">37.86554</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the plot for wdi_internet NAs </span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>data_qog <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(<span class="at">Na =</span> (<span class="fu">is.na</span>(wdi_internet))) <span class="sc">%&gt;%</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage_NA =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Na <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> Percentage_NA))<span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Percentage of NAs of WDI_internet by years"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Some-data-analysis-and-maps-with-R_files/figure-html/question 17-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Best coverage for the wdi_internet variable</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>data_qog <span class="sc">%&gt;%</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(<span class="at">Na =</span> (<span class="fu">is.na</span>(wdi_internet))) <span class="sc">%&gt;%</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage_NA =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="ot">-&gt;</span> na_analysis_internet</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>na_analysis_internet <span class="sc">%&gt;%</span> </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Na <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">best_coverage =</span> <span class="fu">min</span>(Percentage_NA),</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">best_coverage_year =</span> year[<span class="fu">which</span>(Percentage_NA <span class="sc">==</span> <span class="fu">min</span>(Percentage_NA))]) <span class="sc">%&gt;%</span> </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">best_coverage</th>
<th style="text-align: right;">best_coverage_year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.040404</td>
<td style="text-align: right;">2007</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>data_qog <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y =</span> wdi_internet)<span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>)<span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of individuals using the Internet (% of population) - wdi_internet"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Some-data-analysis-and-maps-with-R_files/figure-html/question 18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>data_qog <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y =</span> my_region, <span class="at">x =</span> wdi_internet)<span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>)<span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplots of Individuals using the Internet (% of population) by regions in 2007"</span>)<span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"wdi internet"</span>)<span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Some-data-analysis-and-maps-with-R_files/figure-html/question 18.1-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<section id="analysis-of-variable-life-expectancy-across-countries-and-time-wdi_lifexp" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-variable-life-expectancy-across-countries-and-time-wdi_lifexp">Analysis of variable life expectancy across countries and time (wdi_lifexp)</h2>
<p>We want: mean, median, range, variance, sd, IQR and percentage of NA for all dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>data_qog <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_life_exp =</span> <span class="fu">mean</span>(wdi_lifexp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_life_exp =</span> <span class="fu">median</span>(wdi_lifexp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">variance_life_exp =</span> <span class="fu">sd</span>(wdi_lifexp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">standard_deviation_life_exp =</span> <span class="fu">sd</span>(wdi_lifexp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">IQR_life_exp =</span> <span class="fu">IQR</span>(wdi_lifexp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_life_exp =</span> <span class="fu">min</span>(wdi_lifexp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_life_exp =</span> <span class="fu">max</span>(wdi_lifexp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Descriptive statistics of wdi_lifexp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Descriptive statistics of wdi_lifexp</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 24%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">mean_life_exp</th>
<th style="text-align: right;">median_life_exp</th>
<th style="text-align: right;">variance_life_exp</th>
<th style="text-align: right;">standard_deviation_life_exp</th>
<th style="text-align: right;">IQR_life_exp</th>
<th style="text-align: right;">min_life_exp</th>
<th style="text-align: right;">max_life_exp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">64.31728</td>
<td style="text-align: right;">67.4765</td>
<td style="text-align: right;">130.9105</td>
<td style="text-align: right;">11.44161</td>
<td style="text-align: right;">17.30323</td>
<td style="text-align: right;">18.907</td>
<td style="text-align: right;">85.41707</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="percentage-of-nas" class="level3">
<h3 class="anchored" data-anchor-id="percentage-of-nas">Percentage of NAs</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data_qog <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(wdi_lifexp) <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(<span class="fu">is.na</span>(wdi_lifexp)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage_NAs =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"NAs of wdi_lifexp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>NAs of wdi_lifexp</caption>
<thead>
<tr class="header">
<th style="text-align: left;">is.na(wdi_lifexp)</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">percentage_NAs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">9460</td>
<td style="text-align: right;">0.7782165</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">2696</td>
<td style="text-align: right;">0.2217835</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>data_qog <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">average_wdi_lifexp =</span> <span class="fu">mean</span>(wdi_lifexp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="ot">-&gt;</span> Q20_tibble</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Q20_tibble)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
   year average_wdi_lifexp
  &lt;dbl&gt;              &lt;dbl&gt;
1  1960               55.4
2  1961               53.7
3  1962               54.1
4  1963               54.3
5  1964               54.6
6  1965               54.8</code></pre>
</div>
</div>
</section>
<section id="plotting-average-wdi_lifexp-with-year" class="level3">
<h3 class="anchored" data-anchor-id="plotting-average-wdi_lifexp-with-year">Plotting average wdi_lifexp with year</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>data_qog <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">average_wdi_lifexp =</span> <span class="fu">mean</span>(wdi_lifexp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> average_wdi_lifexp)<span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average life expectancy at birth"</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Average number of years a newborn infant would live if prevailing patterns of mortality at the time of its birth were to stay the same throughout its life"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Some-data-analysis-and-maps-with-R_files/figure-html/question 20.2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>data_qog <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(my_region, year) <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">average_lifexp =</span> <span class="fu">mean</span>(wdi_lifexp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="ot">-&gt;</span> Q21_tibble</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>data_qog <span class="sc">%&gt;%</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(my_region, year) <span class="sc">%&gt;%</span> </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">average_lifexp =</span> <span class="fu">mean</span>(wdi_lifexp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> average_lifexp, <span class="at">color =</span> my_region, <span class="at">shape =</span> my_region)<span class="sc">+</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average life expectancy at birth"</span>,</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Average number of years a newborn infant would live if prevailing patterns of mortality at the time of its birth were to stay the same throughout its life"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Some-data-analysis-and-maps-with-R_files/figure-html/question 21-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>data_qog <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> wdi_gdpcapcon2010, <span class="at">y =</span> wdi_lifexp)<span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Life expectancy and GDP per capita across countries and time"</span>)<span class="sc">+</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"GDP per capita"</span>)<span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Life expectancy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Some-data-analysis-and-maps-with-R_files/figure-html/question 22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There seems to be a positive correlation between GDP per cap and life expectancy.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>data_qog <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> wdi_gdpcapcon2010, <span class="at">y =</span> wdi_lifexp, <span class="at">color =</span> my_region)<span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)<span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Life expectancy and GDP per capital across countries and time"</span>)<span class="sc">+</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">"GDP per capita"</span>)<span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Life expectancy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Some-data-analysis-and-maps-with-R_files/figure-html/question 23.1-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Region with low GDP per cap and low life expectancy tends to be Sub-Saharan Africa</li>
<li>Regions with high GDP per cap and high life expectancy tend to be Europe and America</li>
<li>Regions for which life expectancy tend to be relatively lower than their GDP per cap is North Africa &amp; Middle East and some countries of Sub-Saharan Africa</li>
</ul>
<p>North Africa and Middle East is an interesting case whose observations stand out in the graph above. Around 50000 gdp per cap, life expectancy seems to even decrease with gdp per cap. Thus, I am going to include several variable to see any pattern.</p>
<p>I reproduce the graph by adding two variables: br_dem and wdi_expmil, my guess is that countries which are democratic and with few military expenditures are expected to have high GDP PC and high life expectancy (for example because less money in invested in the military and more in health care) and conversely. I expect the countries which had a declining trend in the previous graph to have relatively high military expenditure. I also add lines aesthetics to distinguish countries within the regions.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>data_qog <span class="sc">%&gt;%</span>  </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> wdi_gdpcapcon2010, <span class="at">y =</span> wdi_lifexp, <span class="at">color =</span> my_region, <span class="at">shape =</span> <span class="fu">factor</span>(br_dem), <span class="at">size =</span> wdi_expmil)<span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> wdi_gdpcapcon2010, <span class="at">y =</span> wdi_lifexp, <span class="at">fill =</span> cname, <span class="at">color =</span> my_region), <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.9</span>)<span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)<span class="sc">+</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">name =</span> <span class="st">"Military expenditure % of GDP"</span>,</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>))<span class="sc">+</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_discrete</span>(<span class="at">name =</span> <span class="st">"Is country democratic"</span>)<span class="sc">+</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Life expectancy and GDP per capital across countries and time"</span>)<span class="sc">+</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"GDP per capita"</span>)<span class="sc">+</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Life expectancy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Some-data-analysis-and-maps-with-R_files/figure-html/question 23.2-1.png" class="img-fluid figure-img" width="1728"></p>
</figure>
</div>
</div>
</div>
<p>I can see now that European countries tend to have relatively low military expenditure, have a posititve correlation between life expectancy and GDP per capita and tend to be democratic. Sub-Saharan Africa countries tend to have increasing life expectancy over the years, but no important GDP per capita growth. For Asia, There is also a positive correlation between life expectancy and gdp per cap, except for one country. The difference with Europe is that some Asian countries are not democratic (circle = non democratic). North Africa and Middle East is the most intriguing case, with a non democratic country with very high military expenditure and high fluctuation of life expectancy and another non democratic country with negative correlation between life expectancy and GDP per cap.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(data_qog<span class="sc">$</span>br_dem)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(data_qog<span class="sc">$</span>p_polity2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(data_qog<span class="sc">$</span>p_polity2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -10  10</code></pre>
</div>
</div>
<p>br_dem (is the country a democracy) is stored as a double, it is however a dummy variable (nominal variable) taking value 0 is country is not democratic and 1 if country is a democracy. Thus, it does not make sense to compute its mean, I should make a table with the frequencies or relative frequencies or do a barplot.</p>
<p>p_polity2 is also stored as a double. It also does not make sense because p_polity2 (revised combined polity score) is an ordinal variable ranging from -10 (strongly autocratic) to +10 (strongly democratic). To give information about this variable, I would do a table and a barplot (sorted according to the range).</p>
<p>I first transform those two variables into factors</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>data_qog<span class="sc">$</span>br_dem <span class="ot">&lt;-</span> <span class="fu">factor</span>(data_qog<span class="sc">$</span>br_dem, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not democratic"</span>, <span class="st">"democratic"</span>))</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>data_qog<span class="sc">$</span>p_polity2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(data_qog<span class="sc">$</span>p_polity2, <span class="at">levels =</span> (<span class="sc">-</span><span class="dv">10</span><span class="sc">:</span><span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I then do some univariate and bivariate analysis of the variables through tables and a cross table</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>data_qog <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(p_polity2) <span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Is the country democratic"</span>, <span class="at">align =</span> <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Is the country democratic</caption>
<thead>
<tr class="header">
<th style="text-align: center;">p_polity2</th>
<th style="text-align: center;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">-10</td>
<td style="text-align: center;">287</td>
</tr>
<tr class="even">
<td style="text-align: center;">-9</td>
<td style="text-align: center;">606</td>
</tr>
<tr class="odd">
<td style="text-align: center;">-8</td>
<td style="text-align: center;">328</td>
</tr>
<tr class="even">
<td style="text-align: center;">-7</td>
<td style="text-align: center;">1311</td>
</tr>
<tr class="odd">
<td style="text-align: center;">-6</td>
<td style="text-align: center;">419</td>
</tr>
<tr class="even">
<td style="text-align: center;">-5</td>
<td style="text-align: center;">190</td>
</tr>
<tr class="odd">
<td style="text-align: center;">-4</td>
<td style="text-align: center;">231</td>
</tr>
<tr class="even">
<td style="text-align: center;">-3</td>
<td style="text-align: center;">240</td>
</tr>
<tr class="odd">
<td style="text-align: center;">-2</td>
<td style="text-align: center;">148</td>
</tr>
<tr class="even">
<td style="text-align: center;">-1</td>
<td style="text-align: center;">177</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">224</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">114</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">95</td>
</tr>
<tr class="even">
<td style="text-align: center;">3</td>
<td style="text-align: center;">123</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">252</td>
</tr>
<tr class="even">
<td style="text-align: center;">5</td>
<td style="text-align: center;">334</td>
</tr>
<tr class="odd">
<td style="text-align: center;">6</td>
<td style="text-align: center;">469</td>
</tr>
<tr class="even">
<td style="text-align: center;">7</td>
<td style="text-align: center;">386</td>
</tr>
<tr class="odd">
<td style="text-align: center;">8</td>
<td style="text-align: center;">593</td>
</tr>
<tr class="even">
<td style="text-align: center;">9</td>
<td style="text-align: center;">516</td>
</tr>
<tr class="odd">
<td style="text-align: center;">10</td>
<td style="text-align: center;">1577</td>
</tr>
<tr class="even">
<td style="text-align: center;">NA</td>
<td style="text-align: center;">3536</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>data_qog <span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(br_dem) <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Is the country democratic"</span>, <span class="at">align =</span> <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Is the country democratic</caption>
<thead>
<tr class="header">
<th style="text-align: center;">br_dem</th>
<th style="text-align: center;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Not democratic</td>
<td style="text-align: center;">5140</td>
</tr>
<tr class="even">
<td style="text-align: center;">democratic</td>
<td style="text-align: center;">4915</td>
</tr>
<tr class="odd">
<td style="text-align: center;">NA</td>
<td style="text-align: center;">2101</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">table</span>(data_qog<span class="sc">$</span>p_polity2, data_qog<span class="sc">$</span>br_dem), <span class="at">caption =</span> <span class="st">"Revised combined polity score according to democracy or not"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Revised combined polity score according to democracy or not</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Not democratic</th>
<th style="text-align: right;">democratic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">-10</td>
<td style="text-align: right;">287</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">-9</td>
<td style="text-align: right;">577</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">-8</td>
<td style="text-align: right;">311</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">-7</td>
<td style="text-align: right;">1206</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">-6</td>
<td style="text-align: right;">406</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">-5</td>
<td style="text-align: right;">155</td>
<td style="text-align: right;">20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">-4</td>
<td style="text-align: right;">229</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">-3</td>
<td style="text-align: right;">209</td>
<td style="text-align: right;">26</td>
</tr>
<tr class="odd">
<td style="text-align: left;">-2</td>
<td style="text-align: right;">145</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">-1</td>
<td style="text-align: right;">164</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">208</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">91</td>
<td style="text-align: right;">23</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">77</td>
<td style="text-align: right;">46</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">127</td>
<td style="text-align: right;">125</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">233</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: right;">139</td>
<td style="text-align: right;">327</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">339</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">545</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">473</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1569</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>I choose then to do a mosaic plot of p_polity according to br_dem to represent the association of the two variable visually</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>data_qog <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">product</span>(br_dem, p_polity2), <span class="at">fill =</span> br_dem), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>, <span class="at">name =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Revised Combined Polity Score: from -10 (strongly authocratic) to 10 (strongly democratic)"</span>)<span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Revised Combined Polity Score and democracy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Some-data-analysis-and-maps-with-R_files/figure-html/question 25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>I can see that as the Revised Combined Polity Score index on the x axis increases, countries tend to be democratic. The value 4 of Revised Combined Polity Score index seems to be the turning point: before this value, there are more non democratic countries, after the value (4), most of the countries are democratic. However, there still are not democratic countries that have high revised combined polity score, which implies that there is some “disagreement” between the two variable and their definition of what a democracy is (at least for some countries).</p>
<p>Another possiblity is to do a stacked or dodge barplot of p_polity and br_dem</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>data_qog <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> p_polity2, <span class="at">y =</span> (..count..)<span class="sc">/</span><span class="fu">sum</span>(..count..), <span class="at">fill =</span> br_dem)<span class="sc">+</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>)<span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>, <span class="at">name =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Revised Combined Polity Score from -10 (strongly authocratic) to 10 (strongly democratic)"</span>)<span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Some-data-analysis-and-maps-with-R_files/figure-html/question 25.2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>data_qog <span class="sc">%&gt;%</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> p_polity2, <span class="at">y =</span> (..count..)<span class="sc">/</span><span class="fu">sum</span>(..count..), <span class="at">fill =</span> br_dem)<span class="sc">+</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()<span class="sc">+</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>, <span class="at">name =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Revised Combined Polity Score from -10 (strongly authocratic) to 10 (strongly democratic)"</span>)<span class="sc">+</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Some-data-analysis-and-maps-with-R_files/figure-html/question 25.2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>My analysis is here the same as the previous graph.</p>
</section>
</section>
</section>
<section id="chloropleth-maps" class="level1">
<h1>Chloropleth maps</h1>
<p>Let’s try to do some maps to visualize some of the dataset variables</p>
<p>I first load the packages required to do maps on r</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgdal)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(countrycode)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearth)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearthdata)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maps)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maptools)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgeos)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(biscale)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>map <span class="ot">&lt;-</span> <span class="fu">readOGR</span>(<span class="st">"F:/myblog/posts/Some data analysis and how to do a map with r/world map"</span>)<span class="co">#Note: the shapefile for the world map was downloaded in the naturalearth website: https://www.naturalearthdata.com/downloads/</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OGR data source with driver: ESRI Shapefile 
Source: "F:\myblog\posts\Some data analysis and how to do a map with r\world map", layer: "ne_50m_admin_0_countries"
with 242 features
It has 168 fields
Integer64 fields read as strings:  NE_ID </code></pre>
</div>
</div>
<p>I then have to “fortify” the map data to make it tidyverse compatible</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>map_fortify <span class="ot">&lt;-</span> <span class="fu">fortify</span>(map, <span class="at">region =</span> <span class="st">"SOVEREIGNT"</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(map_fortify<span class="sc">$</span>id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "Afghanistan"                      "Albania"                         
  [3] "Algeria"                          "Andorra"                         
  [5] "Angola"                           "Antarctica"                      
  [7] "Antigua and Barbuda"              "Argentina"                       
  [9] "Armenia"                          "Australia"                       
 [11] "Austria"                          "Azerbaijan"                      
 [13] "Bahrain"                          "Bangladesh"                      
 [15] "Barbados"                         "Belarus"                         
 [17] "Belgium"                          "Belize"                          
 [19] "Benin"                            "Bhutan"                          
 [21] "Bolivia"                          "Bosnia and Herzegovina"          
 [23] "Botswana"                         "Brazil"                          
 [25] "Brunei"                           "Bulgaria"                        
 [27] "Burkina Faso"                     "Burundi"                         
 [29] "Cabo Verde"                       "Cambodia"                        
 [31] "Cameroon"                         "Canada"                          
 [33] "Central African Republic"         "Chad"                            
 [35] "Chile"                            "China"                           
 [37] "Colombia"                         "Comoros"                         
 [39] "Costa Rica"                       "Croatia"                         
 [41] "Cuba"                             "Cyprus"                          
 [43] "Czechia"                          "Democratic Republic of the Congo"
 [45] "Denmark"                          "Djibouti"                        
 [47] "Dominica"                         "Dominican Republic"              
 [49] "East Timor"                       "Ecuador"                         
 [51] "Egypt"                            "El Salvador"                     
 [53] "Equatorial Guinea"                "Eritrea"                         
 [55] "Estonia"                          "eSwatini"                        
 [57] "Ethiopia"                         "Federated States of Micronesia"  
 [59] "Fiji"                             "Finland"                         
 [61] "France"                           "Gabon"                           
 [63] "Gambia"                           "Georgia"                         
 [65] "Germany"                          "Ghana"                           
 [67] "Greece"                           "Grenada"                         
 [69] "Guatemala"                        "Guinea"                          
 [71] "Guinea-Bissau"                    "Guyana"                          
 [73] "Haiti"                            "Honduras"                        
 [75] "Hungary"                          "Iceland"                         
 [77] "India"                            "Indonesia"                       
 [79] "Iran"                             "Iraq"                            
 [81] "Ireland"                          "Israel"                          
 [83] "Italy"                            "Ivory Coast"                     
 [85] "Jamaica"                          "Japan"                           
 [87] "Jordan"                           "Kashmir"                         
 [89] "Kazakhstan"                       "Kenya"                           
 [91] "Kiribati"                         "Kosovo"                          
 [93] "Kuwait"                           "Kyrgyzstan"                      
 [95] "Laos"                             "Latvia"                          
 [97] "Lebanon"                          "Lesotho"                         
 [99] "Liberia"                          "Libya"                           
[101] "Liechtenstein"                    "Lithuania"                       
[103] "Luxembourg"                       "Madagascar"                      
[105] "Malawi"                           "Malaysia"                        
[107] "Maldives"                         "Mali"                            
[109] "Malta"                            "Marshall Islands"                
[111] "Mauritania"                       "Mauritius"                       
[113] "Mexico"                           "Moldova"                         
[115] "Monaco"                           "Mongolia"                        
[117] "Montenegro"                       "Morocco"                         
[119] "Mozambique"                       "Myanmar"                         
[121] "Namibia"                          "Nauru"                           
[123] "Nepal"                            "Netherlands"                     
[125] "New Zealand"                      "Nicaragua"                       
[127] "Niger"                            "Nigeria"                         
[129] "North Korea"                      "North Macedonia"                 
[131] "Northern Cyprus"                  "Norway"                          
[133] "Oman"                             "Pakistan"                        
[135] "Palau"                            "Panama"                          
[137] "Papua New Guinea"                 "Paraguay"                        
[139] "Peru"                             "Philippines"                     
[141] "Poland"                           "Portugal"                        
[143] "Qatar"                            "Republic of Serbia"              
[145] "Republic of the Congo"            "Romania"                         
[147] "Russia"                           "Rwanda"                          
[149] "Saint Kitts and Nevis"            "Saint Lucia"                     
[151] "Saint Vincent and the Grenadines" "Samoa"                           
[153] "San Marino"                       "São Tomé and Principe"           
[155] "Saudi Arabia"                     "Senegal"                         
[157] "Seychelles"                       "Sierra Leone"                    
[159] "Singapore"                        "Slovakia"                        
[161] "Slovenia"                         "Solomon Islands"                 
[163] "Somalia"                          "Somaliland"                      
[165] "South Africa"                     "South Korea"                     
[167] "South Sudan"                      "Spain"                           
[169] "Sri Lanka"                        "Sudan"                           
[171] "Suriname"                         "Sweden"                          
[173] "Switzerland"                      "Syria"                           
[175] "Taiwan"                           "Tajikistan"                      
[177] "Thailand"                         "The Bahamas"                     
[179] "Togo"                             "Tonga"                           
[181] "Trinidad and Tobago"              "Tunisia"                         
[183] "Turkey"                           "Turkmenistan"                    
[185] "Tuvalu"                           "Uganda"                          
[187] "Ukraine"                          "United Arab Emirates"            
[189] "United Kingdom"                   "United Republic of Tanzania"     
[191] "United States of America"         "Uruguay"                         
[193] "Uzbekistan"                       "Vanuatu"                         
[195] "Vatican"                          "Venezuela"                       
[197] "Vietnam"                          "Western Sahara"                  
[199] "Yemen"                            "Zambia"                          
[201] "Zimbabwe"                        </code></pre>
</div>
</div>
<p>The biggest problem to plot a map will be the names of all the countries in the two datasets because I have to successfully join the dataset to the map-dataset, I have to recode the name in one dataset. The package countrycode will do most of the work, but some countries still need to be recoded.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>data_qog<span class="sc">$</span>cname <span class="ot">&lt;-</span> <span class="fu">countryname</span>(data_qog<span class="sc">$</span>cname, <span class="at">destination =</span> <span class="st">"cldr.short.en"</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>data_qog<span class="sc">$</span>cname[data_qog<span class="sc">$</span>cname <span class="sc">==</span> <span class="st">"US"</span>] <span class="ot">&lt;-</span> <span class="st">"United States of America"</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>data_qog<span class="sc">$</span>cname[data_qog<span class="sc">$</span>cname <span class="sc">==</span> <span class="st">"UK"</span>] <span class="ot">&lt;-</span> <span class="st">"United Kingdom"</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>data_qog<span class="sc">$</span>cname[data_qog<span class="sc">$</span>cname <span class="sc">==</span> <span class="st">"Congo - Kinshasa"</span>] <span class="ot">&lt;-</span> <span class="st">"Democratic Republic of the Congo"</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>data_qog<span class="sc">$</span>cname[data_qog<span class="sc">$</span>cname <span class="sc">==</span> <span class="st">"Côte d’Ivoire"</span>] <span class="ot">&lt;-</span> <span class="st">"Ivory Coast"</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>data_qog<span class="sc">$</span>cname[data_qog<span class="sc">$</span>cname <span class="sc">==</span>  <span class="st">"Tanzania"</span>] <span class="ot">&lt;-</span> <span class="st">"United Republic of Tanzania"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I join the datasets by the country names:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>map_join <span class="ot">&lt;-</span> map_fortify <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data_qog, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"cname"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in left_join(., data_qog, by = c(id = "cname")): Detected an unexpected many-to-many relationship between `x` and `y`.
ℹ Row 1 of `x` matches multiple rows in `y`.
ℹ Row 1 of `y` matches multiple rows in `x`.
ℹ If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
</div>
<p>Are military expenditure geographically related to the probability of a country to be autocratic? I will explore with two maps the relation between p_polity and wdi_expmil. I expect countries with high military expenditure to be more autocratic.</p>
<p>I then plot the first map with the variable p_polity2:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>map_join <span class="sc">%&gt;%</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2015</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group, <span class="at">fill =</span> <span class="fu">factor</span>(p_polity2), <span class="at">color =</span> <span class="fu">I</span>(<span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>()<span class="sc">+</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_ordinal</span>(</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">guide =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">direction =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">title.position =</span> <span class="st">'top'</span>,</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">label.hjust =</span> <span class="dv">1</span>,</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">reverse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">label.position =</span> <span class="st">"bottom"</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>          ),</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">option =</span> <span class="st">"magma"</span>,</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">name =</span> <span class="st">"p_polity2 index"</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>      )<span class="sc">+</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>        )<span class="sc">+</span></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Revised combined polity score across countries (2015)"</span>)<span class="sc">+</span></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="ot">-&gt;</span> map_plot</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>map_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Some-data-analysis-and-maps-with-R_files/figure-html/BT 5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The more democratic countries in 2015 are concentrated in western Europe, America, East and East/South East Asia (Indonesia, Japan, South Korea), South Pacific and India and Mongolia. The autocratic countries tend to be in Africa, Middle East, some in east Europe and South Asia.</p>
<p>I now plot the second map military expenditure wdi_expmil:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>map_join <span class="sc">%&gt;%</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2015</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group, <span class="at">fill =</span> wdi_expmil, <span class="at">color =</span> <span class="fu">I</span>(<span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>()<span class="sc">+</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">option =</span> <span class="st">"magma"</span>,</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">name =</span> <span class="st">"Military expenditure (% of GDP)"</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>      )<span class="sc">+</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>        )<span class="sc">+</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Military expenditure in 2015"</span>,</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"All current and capital expenditures on the armed forces"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Some-data-analysis-and-maps-with-R_files/figure-html/BT 6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Seeing the latter map on military expenditure, I would conclude that there is no clear inverse correlation between degree of democracy and military expenditure: there are countries which are strongly democratic which have relatively high military expenditure such as the US. A lot of African countries are autocratic, but do not have a really high military expenditure except for Algeria and South Sudan. The only region for which there is a correlation between autocracy and military expenditure seems to be Middle East, with Saudi Arabia being the best illustration.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>